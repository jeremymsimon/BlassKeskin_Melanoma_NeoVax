[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Blass & Keskin (2025): Melanoma NeoVax analysis: Skin single-cell RNAseq",
    "section": "",
    "text": "Introduction\nThis is a book that contains all code to reproduce figures related to scRNAseq analysis of vaccine-site Skin biopsy data associated with Blass & Keskin, et al (2025)\nNote that while the code is identical, this book was rendered after final manuscript figures were generated and thus minor differences may arise, particularly for steps that are non-deterministic or rely on random number generators.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#enhanced-adjuvanticity-of-a-personal-neoantigen-vaccine-generates-potent-immunity-in-melanoma",
    "href": "index.html#enhanced-adjuvanticity-of-a-personal-neoantigen-vaccine-generates-potent-immunity-in-melanoma",
    "title": "Blass & Keskin (2025): Melanoma NeoVax analysis: Skin single-cell RNAseq",
    "section": "Enhanced adjuvanticity of a personal neoantigen vaccine generates potent immunity in melanoma",
    "text": "Enhanced adjuvanticity of a personal neoantigen vaccine generates potent immunity in melanoma\nEryn Blass, Derin B. Keskin, Chloe R. Tu, Cleo Forman, Allison Vanasse, Haley E. Sax, Bohoon Shim, Vipheaviny Chea, Nawoo Kim, Isabel Carulli, Jackson Southard, Haoxiang Lyu, Wesley Lu, Micah Rickles-Young, Alexander B. Afeyan, Oriol Olive, Ambica Mehndiratta, Haley Greenslade, Keerthi Shetty, Joanna Baginska, Ilana Gomez-Diaz, Allison Nau, Kathleen L. Pfaff, Andrew Gans, Elizabeth I Buchbinder, Tamara A. Sussman, Megan L Insco, Charles H. Yoon, Scott J. Rodig, Sachet A. Shukla, Shuqiang Li, Jon C. Aster, David A. Braun, Carrie Cibulskis, Nir Hacohen, Donna S. Neuberg, A Giobbie-Hurder, Kenneth J. Livak, Edward F. Fritsch, Giacomo Oliveira, Jeremy M. Simon, Catherine J. Wu, Patrick A. Ott\n\nAbstract\nPersonalized neoantigen-targeting vaccines have great promise, but current delivery strategies are suboptimal. Since antigen availability and effective T cell priming are critical for maximal immunogenicity, we tested a synthetic long peptide vaccine formulated with Montanide, poly-ICLC, and locally administered ipilimumab in addition to systemic nivolumab in 10 patients with melanoma. These personalized vaccines generated de novo ex vivo T cell responses against the majority of immunizing neoepitopes in all 9 fully vaccinated patients, and ex vivo CD8+ T cell responses in 6 of 9. Vaccination induced hundreds of circulating and intratumoral T cell receptor (TCR) clonotypes that were distinct from those arising after PD-1 inhibition. By linking the vaccine neoantigen specificity of T cell clonotypes with single cell phenotypes in tumors, we demonstrate remodeling of the intratumoral T cell repertoire following vaccination. These observations show that multi-pronged immune adjuvanticity can boost T cell responses to neoantigen-targeting vaccines",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html",
    "href": "Skin_scRNA_Part1.html",
    "title": "1  Skin: QC & Filtering",
    "section": "",
    "text": "1.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto)\nlibrary(glmGamPoi)\nlibrary(sctransform)\nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(miQC)   \nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#load-alevin-fry-output",
    "href": "Skin_scRNA_Part1.html#load-alevin-fry-output",
    "title": "1  Skin: QC & Filtering",
    "section": "1.2 Load alevin-fry output",
    "text": "1.2 Load alevin-fry output\nNote using U+S+A counts via snRNA\n\nP101_Skin_Post3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P101_Skin_Post3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 80763 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP101_Skin_Pre3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P101_Skin_Pre3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 76442 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP103_Skin_Post3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P103_Skin_Post3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 64399 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP103_Skin_Pre3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P103_Skin_Pre3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 59420 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP104_Skin_Post3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P104_Skin_Post3rd_2.5mgIpi_RNA_fixed020224_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 57061 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP104_Skin_Pre3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P104_Skin_Pre3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 63314 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP105_Skin_Post3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P105_Skin_Post3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 65472 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP105_Skin_Pre3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P105_Skin_Pre3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 70513 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP106_Skin_Post3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P106_Skin_Post3rd_2.5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 65665 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP106_Skin_Pre3rd_2.5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P106_Skin_Pre3rd_2.5mgIpi_RNA_fixed021324_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 65342 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP108_Skin_Post3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P108_Skin_Post3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 69381 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP108_Skin_Pre3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P108_Skin_Pre3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 69324 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP109_Skin_Post3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P109_Skin_Post3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 71971 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP109_Skin_Pre3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P109_Skin_Pre3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 75117 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP110_Skin_Post3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P110_Skin_Post3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 66843 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP110_Skin_Pre3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P110_Skin_Pre3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 45085 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP111_Skin_Post3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P111_Skin_Post3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 63149 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone\n\nP111_Skin_Pre3rd_5mgIpi_RNA &lt;- loadFry(fryDir = \"/jsimonlab/projects/Wu/Melanoma_scRNA_Eryn/alevinfry_072023/P111_Skin_Pre3rd_5mgIpi_RNA_alevin_quant_crlikeem/\", outputFormat = \"snRNA\")\n\nlocating quant file\n\n\nReading meta data\n\n\nUSA mode: TRUE\n\n\nProcessing 62703 genes and 67303 barcodes\n\n\nUsing pre-defined output format: snrna\n\n\nBuilding the 'counts' assay, which contains U S A\n\n\nConstructing output SingleCellExperiment object\n\n\nDone",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#convert-gene-ids-to-gene-symbols-collapse-transcripts-to-gene-symbols",
    "href": "Skin_scRNA_Part1.html#convert-gene-ids-to-gene-symbols-collapse-transcripts-to-gene-symbols",
    "title": "1  Skin: QC & Filtering",
    "section": "1.3 Convert gene IDs to gene symbols, collapse transcripts to gene symbols",
    "text": "1.3 Convert gene IDs to gene symbols, collapse transcripts to gene symbols\n\ntx2gene &lt;- read.table(\"/jsimonlab/genomes/hg38/gencode.v43.annotation_splici/gene_id_to_name.tsv\",header=F,sep=\"\\t\",col.names=c(\"tx\",\"gene\"))\n\n# Use rownames of first object to apply to all\nexp.txId &lt;- rownames(P101_Skin_Post3rd_2.5mgIpi_RNA)\nexp.geneId &lt;- as.vector(tx2gene$gene[match(exp.txId, tx2gene$tx)])\nexp.tx.grp &lt;- t(sparse.model.matrix(~ 0 + exp.geneId))\n\n\nP101_Skin_Post3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P101_Skin_Post3rd_2.5mgIpi_RNA)\nrownames(P101_Skin_Post3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P101_Skin_Post3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP101_Skin_Pre3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P101_Skin_Pre3rd_2.5mgIpi_RNA)\nrownames(P101_Skin_Pre3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P101_Skin_Pre3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP103_Skin_Post3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P103_Skin_Post3rd_2.5mgIpi_RNA)\nrownames(P103_Skin_Post3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P103_Skin_Post3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP103_Skin_Pre3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P103_Skin_Pre3rd_2.5mgIpi_RNA)\nrownames(P103_Skin_Pre3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P103_Skin_Pre3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP104_Skin_Post3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P104_Skin_Post3rd_2.5mgIpi_RNA)\nrownames(P104_Skin_Post3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P104_Skin_Post3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP104_Skin_Pre3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P104_Skin_Pre3rd_2.5mgIpi_RNA)\nrownames(P104_Skin_Pre3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P104_Skin_Pre3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP105_Skin_Post3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P105_Skin_Post3rd_2.5mgIpi_RNA)\nrownames(P105_Skin_Post3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P105_Skin_Post3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP105_Skin_Pre3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P105_Skin_Pre3rd_2.5mgIpi_RNA)\nrownames(P105_Skin_Pre3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P105_Skin_Pre3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP106_Skin_Post3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P106_Skin_Post3rd_2.5mgIpi_RNA)\nrownames(P106_Skin_Post3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P106_Skin_Post3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP106_Skin_Pre3rd_2.5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P106_Skin_Pre3rd_2.5mgIpi_RNA)\nrownames(P106_Skin_Pre3rd_2.5mgIpi_RNA.summarized) &lt;- rownames(P106_Skin_Pre3rd_2.5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP108_Skin_Post3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P108_Skin_Post3rd_5mgIpi_RNA)\nrownames(P108_Skin_Post3rd_5mgIpi_RNA.summarized) &lt;- rownames(P108_Skin_Post3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP108_Skin_Pre3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P108_Skin_Pre3rd_5mgIpi_RNA)\nrownames(P108_Skin_Pre3rd_5mgIpi_RNA.summarized) &lt;- rownames(P108_Skin_Pre3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP109_Skin_Post3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P109_Skin_Post3rd_5mgIpi_RNA)\nrownames(P109_Skin_Post3rd_5mgIpi_RNA.summarized) &lt;- rownames(P109_Skin_Post3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP109_Skin_Pre3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P109_Skin_Pre3rd_5mgIpi_RNA)\nrownames(P109_Skin_Pre3rd_5mgIpi_RNA.summarized) &lt;- rownames(P109_Skin_Pre3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP110_Skin_Post3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P110_Skin_Post3rd_5mgIpi_RNA)\nrownames(P110_Skin_Post3rd_5mgIpi_RNA.summarized) &lt;- rownames(P110_Skin_Post3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP110_Skin_Pre3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P110_Skin_Pre3rd_5mgIpi_RNA)\nrownames(P110_Skin_Pre3rd_5mgIpi_RNA.summarized) &lt;- rownames(P110_Skin_Pre3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP111_Skin_Post3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P111_Skin_Post3rd_5mgIpi_RNA)\nrownames(P111_Skin_Post3rd_5mgIpi_RNA.summarized) &lt;- rownames(P111_Skin_Post3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")\n\nP111_Skin_Pre3rd_5mgIpi_RNA.summarized &lt;- exp.tx.grp %*% counts(P111_Skin_Pre3rd_5mgIpi_RNA)\nrownames(P111_Skin_Pre3rd_5mgIpi_RNA.summarized) &lt;- rownames(P111_Skin_Pre3rd_5mgIpi_RNA.summarized) %&gt;% str_replace_all(\".+.geneId\",\"\")",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#create-seurat-objects",
    "href": "Skin_scRNA_Part1.html#create-seurat-objects",
    "title": "1  Skin: QC & Filtering",
    "section": "1.4 Create Seurat objects",
    "text": "1.4 Create Seurat objects\n\nP101_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P101_Skin_Post3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP101_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P101_Skin_Pre3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP103_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P103_Skin_Post3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP103_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P103_Skin_Pre3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP104_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P104_Skin_Post3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP104_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P104_Skin_Pre3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP105_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P105_Skin_Post3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP105_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P105_Skin_Pre3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP106_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P106_Skin_Post3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP106_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P106_Skin_Pre3rd_2.5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP108_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P108_Skin_Post3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP108_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P108_Skin_Pre3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP109_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P109_Skin_Post3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP109_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P109_Skin_Pre3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP110_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P110_Skin_Post3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP110_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P110_Skin_Pre3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP111_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P111_Skin_Post3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n\nP111_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- CreateSeuratObject(P111_Skin_Pre3rd_5mgIpi_RNA.summarized)\n\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#add-sample-name-prefix-to-cbs",
    "href": "Skin_scRNA_Part1.html#add-sample-name-prefix-to-cbs",
    "title": "1  Skin: QC & Filtering",
    "section": "1.5 Add sample name prefix to CBs",
    "text": "1.5 Add sample name prefix to CBs\n\nP101_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P101_Skin_Post3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P101_Skin_Post3rd_2.5mgIpi_RNA\")\nP101_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P101_Skin_Pre3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P101_Skin_Pre3rd_2.5mgIpi_RNA\")\nP103_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P103_Skin_Post3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P103_Skin_Post3rd_2.5mgIpi_RNA\")\nP103_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P103_Skin_Pre3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P103_Skin_Pre3rd_2.5mgIpi_RNA\")\nP104_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P104_Skin_Post3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P104_Skin_Post3rd_2.5mgIpi_RNA\")\nP104_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P104_Skin_Pre3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P104_Skin_Pre3rd_2.5mgIpi_RNA\")\nP105_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P105_Skin_Post3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P105_Skin_Post3rd_2.5mgIpi_RNA\")\nP105_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P105_Skin_Pre3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P105_Skin_Pre3rd_2.5mgIpi_RNA\")\nP106_Skin_Post3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P106_Skin_Post3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P106_Skin_Post3rd_2.5mgIpi_RNA\")\nP106_Skin_Pre3rd_2.5mgIpi_RNA.seurat &lt;- RenameCells(P106_Skin_Pre3rd_2.5mgIpi_RNA.seurat,add.cell.id = \"P106_Skin_Pre3rd_2.5mgIpi_RNA\")\nP108_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P108_Skin_Post3rd_5mgIpi_RNA.seurat,add.cell.id = \"P108_Skin_Post3rd_5mgIpi_RNA\")\nP108_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P108_Skin_Pre3rd_5mgIpi_RNA.seurat,add.cell.id = \"P108_Skin_Pre3rd_5mgIpi_RNA\")\nP109_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P109_Skin_Post3rd_5mgIpi_RNA.seurat,add.cell.id = \"P109_Skin_Post3rd_5mgIpi_RNA\")\nP109_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P109_Skin_Pre3rd_5mgIpi_RNA.seurat,add.cell.id = \"P109_Skin_Pre3rd_5mgIpi_RNA\")\nP110_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P110_Skin_Post3rd_5mgIpi_RNA.seurat,add.cell.id = \"P110_Skin_Post3rd_5mgIpi_RNA\")\nP110_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P110_Skin_Pre3rd_5mgIpi_RNA.seurat,add.cell.id = \"P110_Skin_Pre3rd_5mgIpi_RNA\")\nP111_Skin_Post3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P111_Skin_Post3rd_5mgIpi_RNA.seurat,add.cell.id = \"P111_Skin_Post3rd_5mgIpi_RNA\")\nP111_Skin_Pre3rd_5mgIpi_RNA.seurat &lt;- RenameCells(P111_Skin_Pre3rd_5mgIpi_RNA.seurat,add.cell.id = \"P111_Skin_Pre3rd_5mgIpi_RNA\")",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#merge-objects",
    "href": "Skin_scRNA_Part1.html#merge-objects",
    "title": "1  Skin: QC & Filtering",
    "section": "1.6 Merge objects",
    "text": "1.6 Merge objects\nP109_Skin_Post3rd was removed due to low viable cell count\n\nmerged.18279.skin &lt;- merge(x = P101_Skin_Pre3rd_2.5mgIpi_RNA.seurat, y=c(P101_Skin_Post3rd_2.5mgIpi_RNA.seurat, P103_Skin_Pre3rd_2.5mgIpi_RNA.seurat, P103_Skin_Post3rd_2.5mgIpi_RNA.seurat, P104_Skin_Post3rd_2.5mgIpi_RNA.seurat, P104_Skin_Pre3rd_2.5mgIpi_RNA.seurat, P105_Skin_Post3rd_2.5mgIpi_RNA.seurat, P105_Skin_Pre3rd_2.5mgIpi_RNA.seurat, P106_Skin_Pre3rd_2.5mgIpi_RNA.seurat, P106_Skin_Post3rd_2.5mgIpi_RNA.seurat, P108_Skin_Pre3rd_5mgIpi_RNA.seurat, P108_Skin_Post3rd_5mgIpi_RNA.seurat, P109_Skin_Pre3rd_5mgIpi_RNA.seurat, P110_Skin_Pre3rd_5mgIpi_RNA.seurat, P110_Skin_Post3rd_5mgIpi_RNA.seurat, P111_Skin_Pre3rd_5mgIpi_RNA.seurat, P111_Skin_Post3rd_5mgIpi_RNA.seurat))\ndim(merged.18279.skin)\n\n[1]   61217 1124593",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#qc-filter",
    "href": "Skin_scRNA_Part1.html#qc-filter",
    "title": "1  Skin: QC & Filtering",
    "section": "1.7 QC filter",
    "text": "1.7 QC filter\nUse relatively loose initial filters\n\nmerged.18279.skin &lt;- subset(merged.18279.skin, subset = nCount_RNA &gt; 500 & nFeature_RNA &gt; 250)\ndim(merged.18279.skin)\n\n[1] 61217 64133\n\nmerged.18279.skin &lt;- PercentageFeatureSet(merged.18279.skin, pattern = \"^MT-\", col.name = \"percent.mt\")\nmerged.18279.skin &lt;- RunMiQC(merged.18279.skin, \n                        percent.mt = \"percent.mt\", \n                        nFeature_RNA = \"nFeature_RNA\", \n                        posterior.cutoff = 0.6, \n                        model.slot = \"flexmix_model\")\n\nWarning: Adding a command log without an assay associated with it\n\nmerged.18279.skin &lt;- subset(merged.18279.skin, miQC.keep == \"keep\")\n\ndim(merged.18279.skin)\n\n[1] 61217 46891\n\ndata.frame(table(str_replace_all(colnames(merged.18279.skin),\"_RNA_.+\",\"\")))\n\n                         Var1 Freq\n1  P101_Skin_Post3rd_2.5mgIpi 2338\n2   P101_Skin_Pre3rd_2.5mgIpi  622\n3  P103_Skin_Post3rd_2.5mgIpi 5340\n4   P103_Skin_Pre3rd_2.5mgIpi 1214\n5  P104_Skin_Post3rd_2.5mgIpi 7396\n6   P104_Skin_Pre3rd_2.5mgIpi 4291\n7  P105_Skin_Post3rd_2.5mgIpi 4668\n8   P105_Skin_Pre3rd_2.5mgIpi 3341\n9  P106_Skin_Post3rd_2.5mgIpi 2214\n10  P106_Skin_Pre3rd_2.5mgIpi 2223\n11   P108_Skin_Post3rd_5mgIpi 3601\n12    P108_Skin_Pre3rd_5mgIpi 1277\n13    P109_Skin_Pre3rd_5mgIpi 2144\n14   P110_Skin_Post3rd_5mgIpi 1979\n15    P110_Skin_Pre3rd_5mgIpi 1593\n16   P111_Skin_Post3rd_5mgIpi 1949\n17    P111_Skin_Pre3rd_5mgIpi  701",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#add-meta-data",
    "href": "Skin_scRNA_Part1.html#add-meta-data",
    "title": "1  Skin: QC & Filtering",
    "section": "1.8 Add meta data",
    "text": "1.8 Add meta data\n\npatient &lt;- str_split_i(colnames(merged.18279.skin),\"_\",1)\nsite &lt;- str_split_i(colnames(merged.18279.skin),\"_\",2)\ntimepoint &lt;- str_split_i(colnames(merged.18279.skin),\"_\",3)\nIpiCohort &lt;- str_split_i(colnames(merged.18279.skin),\"_\",4)\nassay &lt;- str_split_i(colnames(merged.18279.skin),\"_\",5)\nbarcode &lt;- str_split_i(colnames(merged.18279.skin),\"_\",6)\nsample &lt;- paste0(patient,\"_\",site,\"_\",timepoint,\"_\",IpiCohort,\"_\",assay)\n\nmerged.18279.skin &lt;- AddMetaData(merged.18279.skin, patient, col.name=\"Patient\")\nmerged.18279.skin &lt;- AddMetaData(merged.18279.skin, site, col.name=\"Site\")\nmerged.18279.skin &lt;- AddMetaData(merged.18279.skin, timepoint, col.name=\"Timepoint\")\nmerged.18279.skin &lt;- AddMetaData(merged.18279.skin, IpiCohort, col.name=\"IpiCohort\")\nmerged.18279.skin &lt;- AddMetaData(merged.18279.skin, assay, col.name=\"Assay\")\nmerged.18279.skin &lt;- AddMetaData(merged.18279.skin, sample, col.name=\"Sample\")",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#join-then-re-split-rna-counts-layers-by-sample",
    "href": "Skin_scRNA_Part1.html#join-then-re-split-rna-counts-layers-by-sample",
    "title": "1  Skin: QC & Filtering",
    "section": "1.9 Join then re-split RNA counts layers by Sample",
    "text": "1.9 Join then re-split RNA counts layers by Sample\n\nmerged.18279.skin[['RNA']] &lt;- JoinLayers(merged.18279.skin[['RNA']])\nmerged.18279.skin[[\"RNA\"]] &lt;- split(merged.18279.skin[[\"RNA\"]], f = merged.18279.skin$Sample)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#save-merged-object",
    "href": "Skin_scRNA_Part1.html#save-merged-object",
    "title": "1  Skin: QC & Filtering",
    "section": "1.10 Save merged object",
    "text": "1.10 Save merged object\n\nsaveRDS(merged.18279.skin,\"Skin_scRNA_Part1.rds\")",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part1.html#get-session-info",
    "href": "Skin_scRNA_Part1.html#get-session-info",
    "title": "1  Skin: QC & Filtering",
    "section": "1.11 Get session info",
    "text": "1.11 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] cellXY_0.99.0               scDblFinder_1.14.0         \n [3] harmony_1.2.0               alevinQC_1.16.1            \n [5] vctrs_0.6.5                 patchwork_1.3.0            \n [7] scater_1.30.1               scuttle_1.12.0             \n [9] speckle_1.0.0               Matrix_1.6-4               \n[11] fishpond_2.6.2              readxl_1.4.3               \n[13] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[15] Biobase_2.62.0              GenomicRanges_1.54.1       \n[17] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[19] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[21] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[23] flexmix_2.3-19              lattice_0.22-6             \n[25] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[27] lubridate_1.9.3             forcats_1.0.0              \n[29] stringr_1.5.1               dplyr_1.1.4                \n[31] purrr_1.0.2                 readr_2.1.5                \n[33] tidyr_1.3.1                 tibble_3.2.1               \n[35] ggplot2_3.5.1               tidyverse_2.0.0            \n[37] Seurat_5.1.0                SeuratObject_5.0.2         \n[39] sp_2.1-4                    sctransform_0.4.1          \n[41] glmGamPoi_1.12.2            presto_1.0.0               \n[43] Rcpp_1.0.13-1               devtools_2.4.5             \n[45] usethis_3.0.0               data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] spatstat.data_3.1-4       ggridges_0.5.6           \n [23] pbapply_1.7-2             Rsamtools_2.18.0         \n [25] R.utils_2.12.3            parallelly_1.39.0        \n [27] sessioninfo_1.2.2         limma_3.58.1             \n [29] RSQLite_2.3.8             BiocIO_1.12.0            \n [31] generics_0.1.3            gtools_3.9.5             \n [33] ica_1.0-3                 spatstat.random_3.2-2    \n [35] ggbeeswarm_0.7.2          fansi_1.0.6              \n [37] abind_1.4-8               R.methodsS3_1.8.2        \n [39] lifecycle_1.0.4           yaml_2.3.10              \n [41] edgeR_4.0.16              SparseArray_1.2.2        \n [43] Rtsne_0.17                blob_1.2.4               \n [45] grid_4.3.2                dqrng_0.4.1              \n [47] promises_1.3.0            crayon_1.5.3             \n [49] shinydashboard_0.7.2      miniUI_0.1.1.1           \n [51] beachmat_2.18.1           cowplot_1.1.3            \n [53] KEGGREST_1.42.0           metapod_1.10.1           \n [55] pillar_1.9.0              knitr_1.45               \n [57] rjson_0.2.23              xgboost_1.7.8.1          \n [59] future.apply_1.11.3       codetools_0.2-20         \n [61] leiden_0.4.3.1            glue_1.8.0               \n [63] remotes_2.5.0             png_0.1-8                \n [65] spam_2.11-0               org.Mm.eg.db_3.18.0      \n [67] cellranger_1.1.0          gtable_0.3.6             \n [69] cachem_1.1.0              xfun_0.49                \n [71] S4Arrays_1.2.0            mime_0.12                \n [73] survival_3.7-0            bluster_1.12.0           \n [75] statmod_1.5.0             ellipsis_0.3.2           \n [77] fitdistrplus_1.2-1        ROCR_1.0-11              \n [79] nlme_3.1-166              bit64_4.5.2              \n [81] RcppAnnoy_0.0.22          irlba_2.3.5.1            \n [83] vipor_0.4.7               KernSmooth_2.23-24       \n [85] DBI_1.2.3                 colorspace_2.1-1         \n [87] nnet_7.3-19               tidyselect_1.2.1         \n [89] bit_4.5.0                 compiler_4.3.2           \n [91] BiocNeighbors_1.20.2      DelayedArray_0.28.0      \n [93] plotly_4.10.4             rtracklayer_1.62.0       \n [95] scales_1.3.0              lmtest_0.9-40            \n [97] digest_0.6.37             goftest_1.2-3            \n [99] spatstat.utils_3.1-1      rmarkdown_2.29           \n[101] XVector_0.42.0            htmltools_0.5.8.1        \n[103] pkgconfig_2.0.3           sparseMatrixStats_1.14.0 \n[105] fastmap_1.2.0             rlang_1.1.4              \n[107] htmlwidgets_1.6.4         shiny_1.9.1              \n[109] DelayedMatrixStats_1.24.0 farver_2.1.2             \n[111] zoo_1.8-12                jsonlite_1.8.9           \n[113] BiocParallel_1.36.0       R.oo_1.27.0              \n[115] BiocSingular_1.18.0       RCurl_1.98-1.16          \n[117] magrittr_2.0.3            modeltools_0.2-23        \n[119] GenomeInfoDbData_1.2.11   dotCall64_1.2            \n[121] munsell_0.5.1             viridis_0.6.5            \n[123] reticulate_1.35.0         stringi_1.8.4            \n[125] zlibbioc_1.48.2           MASS_7.3-60.0.1          \n[127] org.Hs.eg.db_3.18.0       plyr_1.8.9               \n[129] pkgbuild_1.4.5            ggstats_0.7.0            \n[131] parallel_4.3.2            listenv_0.9.1            \n[133] ggrepel_0.9.6             deldir_2.0-4             \n[135] Biostrings_2.70.3         splines_4.3.2            \n[137] tensor_1.5                hms_1.1.3                \n[139] locfit_1.5-9.10           igraph_2.1.1             \n[141] spatstat.geom_3.2-8       RcppHNSW_0.6.0           \n[143] reshape2_1.4.4            ScaledMatrix_1.10.0      \n[145] pkgload_1.4.0             XML_3.99-0.17            \n[147] evaluate_1.0.1            scran_1.30.2             \n[149] BiocManager_1.30.25       tzdb_0.4.0               \n[151] httpuv_1.6.15             RANN_2.6.2               \n[153] polyclip_1.10-7           future_1.34.0            \n[155] scattermore_1.2           rsvd_1.0.5               \n[157] xtable_1.8-4              restfulr_0.0.15          \n[159] svMisc_1.2.3              RSpectra_0.16-2          \n[161] later_1.3.2               viridisLite_0.4.2        \n[163] AnnotationDbi_1.64.1      GenomicAlignments_1.38.2 \n[165] memoise_2.0.1             beeswarm_0.4.0           \n[167] tximport_1.28.0           cluster_2.1.6            \n[169] timechange_0.3.0          globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Skin: QC & Filtering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html",
    "href": "Skin_scRNA_Part2.html",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "",
    "text": "2.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto)\nlibrary(BiocParallel)\nlibrary(glmGamPoi)\nlibrary(sctransform)\nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(miQC)\nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#load-previously-saved-object",
    "href": "Skin_scRNA_Part2.html#load-previously-saved-object",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.2 Load previously saved object",
    "text": "2.2 Load previously saved object\n\nmerged.18279.skin &lt;- readRDS(\"Skin_scRNA_Part1.rds\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#normalize-and-scale-data",
    "href": "Skin_scRNA_Part2.html#normalize-and-scale-data",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.3 Normalize and scale data",
    "text": "2.3 Normalize and scale data\nRegress out mitochondrial contribution\n\nmerged.18279.skin &lt;- NormalizeData(merged.18279.skin)\nmerged.18279.skin &lt;- FindVariableFeatures(merged.18279.skin, \n                                    assay=\"RNA\", \n                                    layer=\"data\", \n                                    selection.method = \"vst\", \n                                    nfeatures = 5000)\nmerged.18279.skin &lt;- ScaleData(merged.18279.skin, vars.to.regress = \"percent.mt\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#run-pca",
    "href": "Skin_scRNA_Part2.html#run-pca",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.4 Run PCA",
    "text": "2.4 Run PCA\n\nmerged.18279.skin &lt;- RunPCA(merged.18279.skin, npcs = 200, verbose = FALSE)\nElbowPlot(merged.18279.skin, ndims = 200, reduction = \"pca\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#plot-unintegrated-umap",
    "href": "Skin_scRNA_Part2.html#plot-unintegrated-umap",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.5 Plot unintegrated UMAP",
    "text": "2.5 Plot unintegrated UMAP\n\nmerged.18279.skin &lt;- RunUMAP(merged.18279.skin, \n                        reduction = \"pca\", \n                        dims = 1:50, \n                        reduction.name = \"umap.unintegrated\")\n\nWarning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session\n\n\n12:19:39 UMAP embedding parameters a = 0.9922 b = 1.112\n\n\n12:19:39 Read 46891 rows and found 50 numeric columns\n\n\n12:19:39 Using Annoy for neighbor search, n_neighbors = 30\n\n\n12:19:39 Building Annoy index with metric = cosine, n_trees = 50\n\n\n0%   10   20   30   40   50   60   70   80   90   100%\n\n\n[----|----|----|----|----|----|----|----|----|----|\n\n\n**************************************************|\n12:19:46 Writing NN index file to temp file /tmp/RtmpLWXF82/file2d64c0482d37f6\n12:19:46 Searching Annoy index using 1 thread, search_k = 3000\n12:20:03 Annoy recall = 100%\n12:20:04 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30\n12:20:07 Initializing from normalized Laplacian + noise (using RSpectra)\n12:20:10 Commencing optimization for 200 epochs, with 2042658 positive edges\n12:20:30 Optimization finished\n\nDimPlot(merged.18279.skin, reduction = \"umap.unintegrated\", group.by = c(\"Site\", \"Patient\", \"Timepoint\"))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#call-preliminary-clusters-for-the-purposes-of-doublet-discrimination",
    "href": "Skin_scRNA_Part2.html#call-preliminary-clusters-for-the-purposes-of-doublet-discrimination",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.6 Call preliminary clusters for the purposes of doublet discrimination",
    "text": "2.6 Call preliminary clusters for the purposes of doublet discrimination\n\nmerged.18279.skin &lt;- FindNeighbors(merged.18279.skin, dims = 1:50, reduction = \"pca\")\n\nComputing nearest neighbor graph\n\n\nComputing SNN\n\nmerged.18279.skin &lt;- FindClusters(merged.18279.skin, \n                             resolution = 0.4, \n                             algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 46891\nNumber of edges: 1576348\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.9313\nNumber of communities: 22\nElapsed time: 10 seconds\n\nDimPlot(merged.18279.skin, reduction = \"umap.unintegrated\", label = T)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#identify-and-remove-doublets",
    "href": "Skin_scRNA_Part2.html#identify-and-remove-doublets",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.7 Identify and remove doublets",
    "text": "2.7 Identify and remove doublets\nThis uses raw counts as input\n\n2.7.1 Combine RNA layers\n\nmerged.18279.skin[['RNA']] &lt;- JoinLayers(merged.18279.skin[['RNA']])\n\n\n\n2.7.2 Convert seurat to sce and check colData\n\nmerged.18279.skin.sce &lt;- as.SingleCellExperiment(merged.18279.skin, assay = \"RNA\")\nmerged.18279.skin.sce\n\nclass: SingleCellExperiment \ndim: 61217 46891 \nmetadata(0):\nassays(2): counts logcounts\nrownames(61217): 5-8S-rRNA 5S-rRNA ... ZZEF1 ZZZ3\nrowData names(0):\ncolnames(46891): P101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA\n  P101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC ...\n  P111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA\n  P111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT\ncolData names(15): orig.ident nCount_RNA ... seurat_clusters ident\nreducedDimNames(2): PCA UMAP.UNINTEGRATED\nmainExpName: RNA\naltExpNames(0):\n\ncolData(merged.18279.skin.sce)\n\nDataFrame with 46891 rows and 15 columns\n                                                  orig.ident nCount_RNA\n                                                 &lt;character&gt;  &lt;numeric&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA SeuratProject    26987.6\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC SeuratProject    26321.6\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT SeuratProject    29916.6\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC SeuratProject    28724.6\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT SeuratProject    25775.8\n...                                                      ...        ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA  SeuratProject        532\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT  SeuratProject        502\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC  SeuratProject        618\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA  SeuratProject        508\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT  SeuratProject        511\n                                               nFeature_RNA percent.mt\n                                                  &lt;integer&gt;  &lt;numeric&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA         5591    3.39147\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC         5500    3.17440\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT         6213    6.09781\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC         5440    4.31684\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT         4171    2.80602\n...                                                     ...        ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA           423   1.879699\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT           484   0.796813\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC           508   1.941748\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA           452   1.279528\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT           386   0.391389\n                                               miQC.probability   miQC.keep\n                                                      &lt;numeric&gt; &lt;character&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA        0.0454933        keep\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC        0.0462136        keep\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT        0.0893537        keep\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC        0.0520042        keep\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT        0.0498276        keep\n...                                                         ...         ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA         0.0148312        keep\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT         0.0225911        keep\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC         0.0154750        keep\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA         0.0180636        keep\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT         0.0260453        keep\n                                                   Patient        Site\n                                               &lt;character&gt; &lt;character&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA        P101        Skin\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC        P101        Skin\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT        P101        Skin\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC        P101        Skin\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT        P101        Skin\n...                                                    ...         ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA         P111        Skin\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT         P111        Skin\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC         P111        Skin\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA         P111        Skin\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT         P111        Skin\n                                                 Timepoint   IpiCohort\n                                               &lt;character&gt; &lt;character&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA      Pre3rd    2.5mgIpi\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC      Pre3rd    2.5mgIpi\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT      Pre3rd    2.5mgIpi\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC      Pre3rd    2.5mgIpi\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT      Pre3rd    2.5mgIpi\n...                                                    ...         ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA      Post3rd      5mgIpi\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT      Post3rd      5mgIpi\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC      Post3rd      5mgIpi\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA      Post3rd      5mgIpi\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT      Post3rd      5mgIpi\n                                                     Assay\n                                               &lt;character&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA         RNA\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC         RNA\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT         RNA\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC         RNA\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT         RNA\n...                                                    ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA          RNA\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT          RNA\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC          RNA\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA          RNA\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT          RNA\n                                                               Sample\n                                                          &lt;character&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA P101_Skin_Pre3rd_2.5..\nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC P101_Skin_Pre3rd_2.5..\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT P101_Skin_Pre3rd_2.5..\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC P101_Skin_Pre3rd_2.5..\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT P101_Skin_Pre3rd_2.5..\n...                                                               ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA  P111_Skin_Post3rd_5m..\nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT  P111_Skin_Post3rd_5m..\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC  P111_Skin_Post3rd_5m..\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA  P111_Skin_Post3rd_5m..\nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT  P111_Skin_Post3rd_5m..\n                                               RNA_snn_res.0.4 seurat_clusters\n                                                      &lt;factor&gt;        &lt;factor&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA              9               9 \nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC              13              13\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT              12              12\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC              1               1 \nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT              3               3 \n...                                                        ...             ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA               4               4 \nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT               11              11\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC               11              11\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA               4               4 \nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT               4               4 \n                                                  ident\n                                               &lt;factor&gt;\nP101_Skin_Pre3rd_2.5mgIpi_RNA_AAACCTGCACCATGTA       9 \nP101_Skin_Pre3rd_2.5mgIpi_RNA_CACATAGCAGGCTCAC       13\nP101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT       12\nP101_Skin_Pre3rd_2.5mgIpi_RNA_TTAGTTCAGCACCGTC       1 \nP101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT       3 \n...                                                 ...\nP111_Skin_Post3rd_5mgIpi_RNA_CAGGTGCGTCGCTTTA        4 \nP111_Skin_Post3rd_5mgIpi_RNA_GTCACGACACATTTCT        11\nP111_Skin_Post3rd_5mgIpi_RNA_GAGACCTAGGGTCTCC        11\nP111_Skin_Post3rd_5mgIpi_RNA_TGGCCACCAGGCTGAA        4 \nP111_Skin_Post3rd_5mgIpi_RNA_TGAGCCGAGACGCGTT        4 \n\n\n\n\n2.7.3 Run scDblFinder\nSet the dbr.sd very high to better allow thresholds to be set based on misclassification rates per sample\n\nmerged.18279.skin.sce &lt;- scDblFinder(merged.18279.skin.sce,\n                    samples = \"Sample\",\n                    dbr.sd = 1,\n                    clusters = \"seurat_clusters\",\n                    BPPARAM = MulticoreParam(4,RNGseed=123)\n                )\n\n\n\n2.7.4 Inspect results\n\n# Look at the classes\ntable(merged.18279.skin.sce$seurat_clusters, merged.18279.skin.sce$scDblFinder.class)\n\n    \n     singlet doublet\n  0     8034     407\n  1     5222    1273\n  2     6081     343\n  3     1539    1754\n  4     3039      16\n  5     2570     206\n  6     1923     152\n  7     1667     229\n  8     1762      97\n  9     1612     243\n  10    1548      97\n  11    1464      34\n  12    1197     149\n  13     549     295\n  14     572     148\n  15     518     177\n  16     511     109\n  17     294     158\n  18     286      72\n  19     183     113\n  20     141      46\n  21      60       1\n\ntable(merged.18279.skin.sce$Sample, merged.18279.skin.sce$scDblFinder.class)\n\n                                \n                                 singlet doublet\n  P101_Skin_Post3rd_2.5mgIpi_RNA    2005     333\n  P101_Skin_Pre3rd_2.5mgIpi_RNA      549      73\n  P103_Skin_Post3rd_2.5mgIpi_RNA    4675     665\n  P103_Skin_Pre3rd_2.5mgIpi_RNA     1053     161\n  P104_Skin_Post3rd_2.5mgIpi_RNA    6422     974\n  P104_Skin_Pre3rd_2.5mgIpi_RNA     3619     672\n  P105_Skin_Post3rd_2.5mgIpi_RNA    3996     672\n  P105_Skin_Pre3rd_2.5mgIpi_RNA     3017     324\n  P106_Skin_Post3rd_2.5mgIpi_RNA    1939     275\n  P106_Skin_Pre3rd_2.5mgIpi_RNA     2015     208\n  P108_Skin_Post3rd_5mgIpi_RNA      3108     493\n  P108_Skin_Pre3rd_5mgIpi_RNA       1148     129\n  P109_Skin_Pre3rd_5mgIpi_RNA       1870     274\n  P110_Skin_Post3rd_5mgIpi_RNA      1658     321\n  P110_Skin_Pre3rd_5mgIpi_RNA       1381     212\n  P111_Skin_Post3rd_5mgIpi_RNA      1724     225\n  P111_Skin_Pre3rd_5mgIpi_RNA        593     108\n\n# Look at the scores\nsummary(merged.18279.skin.sce$scDblFinder.score)\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n0.0001124 0.0241526 0.0837982 0.2201275 0.2663128 0.9999770 \n\n\n\n\n2.7.5 Save doublet classifications into main Seurat object\n\nmerged.18279.skin$doublet_classification &lt;- merged.18279.skin.sce$scDblFinder.class\n\n\n\n2.7.6 Count singlets and doublets\n\ntable(merged.18279.skin$doublet_classification)\n\n\nsinglet doublet \n  40772    6119 \n\ntable(merged.18279.skin$doublet_classification, merged.18279.skin$seurat_clusters)\n\n         \n             0    1    2    3    4    5    6    7    8    9   10   11   12   13\n  singlet 8034 5222 6081 1539 3039 2570 1923 1667 1762 1612 1548 1464 1197  549\n  doublet  407 1273  343 1754   16  206  152  229   97  243   97   34  149  295\n         \n            14   15   16   17   18   19   20   21\n  singlet  572  518  511  294  286  183  141   60\n  doublet  148  177  109  158   72  113   46    1\n\n\n\n\n2.7.7 Plot singlets/doublets in UMAP space\n\nDimPlot(merged.18279.skin,reduction = \"umap.unintegrated\", group.by = \"doublet_classification\")\n\n\n\n\n\n\n\n\n\n\n2.7.8 Subset object to remove doublets and count remaining cells\n\nmerged.18279.skin.singlets &lt;- subset(merged.18279.skin, doublet_classification %in% c(\"singlet\"))\ndim(merged.18279.skin.singlets)\n\n[1] 61217 40772\n\n# Count remaining cells per initial cluster\ntable(merged.18279.skin.singlets$seurat_clusters)\n\n\n   0    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 \n8034 5222 6081 1539 3039 2570 1923 1667 1762 1612 1548 1464 1197  549  572  518 \n  16   17   18   19   20   21 \n 511  294  286  183  141   60",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#remove-cells-with-very-high-ncount_rna-values-set-other-final-qc-filters",
    "href": "Skin_scRNA_Part2.html#remove-cells-with-very-high-ncount_rna-values-set-other-final-qc-filters",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.8 Remove cells with very high nCount_RNA values, set other final QC filters",
    "text": "2.8 Remove cells with very high nCount_RNA values, set other final QC filters\n\nmerged.18279.skin.singlets &lt;- subset(merged.18279.skin.singlets,\n                                subset = nCount_RNA &lt; 40000 & nCount_RNA &gt; 1500 & nFeature_RNA &gt; 750)\ndim(merged.18279.skin.singlets)\n\n[1] 61217 33401",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#re-compute-pca",
    "href": "Skin_scRNA_Part2.html#re-compute-pca",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.9 Re-compute PCA",
    "text": "2.9 Re-compute PCA\nRe-scale data now that it has been subset\n\nmerged.18279.skin.singlets[[\"RNA\"]] &lt;- split(merged.18279.skin.singlets[[\"RNA\"]], f = merged.18279.skin.singlets$Sample)\n\nmerged.18279.skin.singlets &lt;- FindVariableFeatures(merged.18279.skin.singlets, \n                                    assay = \"RNA\", \n                                    layer = \"data\", \n                                    selection.method = \"vst\", \n                                    nfeatures = 5000)\nmerged.18279.skin.singlets &lt;- ScaleData(merged.18279.skin.singlets, vars.to.regress = \"percent.mt\")\nmerged.18279.skin.singlets &lt;- RunPCA(merged.18279.skin.singlets, npcs = 200, verbose = FALSE)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#run-harmony-integration",
    "href": "Skin_scRNA_Part2.html#run-harmony-integration",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "2.10 Run Harmony integration",
    "text": "2.10 Run Harmony integration\n\nmerged.18279.skin.singlets &lt;- IntegrateLayers(merged.18279.skin.singlets, \n                                method = HarmonyIntegration, \n                                orig.reduction = \"pca\",\n                                new.reduction = \"integrated.harmony\"\n)\n\nWarning: HarmonyMatrix is deprecated and will be removed in the future from the\nAPI in the future\n\n\nWarning: Warning: The parameters do_pca and npcs are deprecated. They will be ignored for this function call and please remove parameters do_pca and npcs and pass to harmony cell_embeddings directly.\nThis warning is displayed once per session.\n\n\nWarning: Warning: The parameter tau is deprecated. It will be ignored for this function call and please remove parameter tau in future function calls. Advanced users can set value of parameter tau by using parameter .options and function harmony_options().\nThis warning is displayed once per session.\n\n\nWarning: Warning: The parameter block.size is deprecated. It will be ignored for this function call and please remove parameter block.size in future function calls. Advanced users can set value of parameter block.size by using parameter .options and function harmony_options().\nThis warning is displayed once per session.\n\n\nWarning: Warning: The parameter max.iter.harmony is replaced with parameter max_iter. It will be ignored for this function call and please use parameter max_iter in future function calls.\nThis warning is displayed once per session.\n\n\nWarning: Warning: The parameter max.iter.cluster is deprecated. It will be ignored for this function call and please remove parameter max.iter.cluster in future function calls. Advanced users can set value of parameter max.iter.cluster by using parameter .options and function harmony_options().\nThis warning is displayed once per session.\n\n\nWarning: Warning: The parameter epsilon.cluster is deprecated. It will be ignored for this function call and please remove parameter epsilon.cluster in future function calls. Advanced users can set value of parameter epsilon.cluster by using parameter .options and function harmony_options().\nThis warning is displayed once per session.\n\n\nWarning: Warning: The parameter epsilon.harmony is deprecated. It will be ignored for this function call and please remove parameter epsilon.harmony in future function calls. If users want to control if harmony would stop early or not, use parameter early_stop. Advanced users can set value of parameter epsilon.harmony by using parameter .options and function harmony_options().\nThis warning is displayed once per session.\n\n\nTransposing data matrix\n\n\nUsing automatic lambda estimation\n\n\nInitializing state using k-means centroids initialization\n\n\nHarmony 1/10\n\n\nHarmony 2/10\n\n\nHarmony 3/10\n\n\nHarmony converged after 3 iterations",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#plot-one-as-example",
    "href": "Skin_scRNA_Part2.html#plot-one-as-example",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "4.1 Plot one as example",
    "text": "4.1 Plot one as example\n\nDimPlot(merged.18279.skin.singlets,\n        reduction = \"umap.harmony\", \n        label = TRUE, \n        group.by = \"RNA_snn_res.1\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#plot-metadata-in-umap-space",
    "href": "Skin_scRNA_Part2.html#plot-metadata-in-umap-space",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "4.2 Plot metadata in UMAP space",
    "text": "4.2 Plot metadata in UMAP space\n\nDimPlot(merged.18279.skin.singlets,reduction = \"umap.harmony\", group.by = \"Patient\")\n\n\n\n\n\n\n\nDimPlot(merged.18279.skin.singlets,reduction = \"umap.harmony\", group.by = \"Site\")\n\n\n\n\n\n\n\nDimPlot(merged.18279.skin.singlets,reduction = \"umap.harmony\", group.by = \"Timepoint\")\n\n\n\n\n\n\n\nDimPlot(merged.18279.skin.singlets,reduction = \"umap.harmony\", group.by = \"IpiCohort\")\n\n\n\n\n\n\n\nDimPlot(merged.18279.skin.singlets,reduction = \"umap.harmony\", group.by = \"Sample\") + NoLegend()\n\n\n\n\n\n\n\nFeaturePlot(merged.18279.skin.singlets,reduction = \"umap.harmony\",features=\"nCount_RNA\",order=T)\n\n\n\n\n\n\n\nFeaturePlot(merged.18279.skin.singlets,reduction = \"umap.harmony\",features=\"nFeature_RNA\",order=T)\n\n\n\n\n\n\n\nFeaturePlot(merged.18279.skin.singlets,reduction = \"umap.harmony\",features=\"percent.mt\",order=T)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#save-clustered-object",
    "href": "Skin_scRNA_Part2.html#save-clustered-object",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "4.3 Save clustered object",
    "text": "4.3 Save clustered object\n\nsaveRDS(merged.18279.skin.singlets,\"Skin_scRNA_Part2.rds\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part2.html#get-session-info",
    "href": "Skin_scRNA_Part2.html#get-session-info",
    "title": "2  Skin: Normalization, doublet discrimination, integration, clustering",
    "section": "4.4 Get session info",
    "text": "4.4 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] cellXY_0.99.0               scDblFinder_1.14.0         \n [3] harmony_1.2.0               alevinQC_1.16.1            \n [5] vctrs_0.6.5                 patchwork_1.3.0            \n [7] scater_1.30.1               scuttle_1.12.0             \n [9] speckle_1.0.0               Matrix_1.6-4               \n[11] fishpond_2.6.2              readxl_1.4.3               \n[13] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[15] Biobase_2.62.0              GenomicRanges_1.54.1       \n[17] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[19] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[21] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[23] flexmix_2.3-19              lattice_0.22-6             \n[25] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[27] lubridate_1.9.3             forcats_1.0.0              \n[29] stringr_1.5.1               dplyr_1.1.4                \n[31] purrr_1.0.2                 readr_2.1.5                \n[33] tidyr_1.3.1                 tibble_3.2.1               \n[35] ggplot2_3.5.1               tidyverse_2.0.0            \n[37] Seurat_5.1.0                SeuratObject_5.0.2         \n[39] sp_2.1-4                    sctransform_0.4.1          \n[41] glmGamPoi_1.12.2            BiocParallel_1.36.0        \n[43] presto_1.0.0                Rcpp_1.0.13-1              \n[45] devtools_2.4.5              usethis_3.0.0              \n[47] data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] labeling_0.4.3            spatstat.data_3.1-4      \n [23] ggridges_0.5.6            pbapply_1.7-2            \n [25] Rsamtools_2.18.0          R.utils_2.12.3           \n [27] parallelly_1.39.0         sessioninfo_1.2.2        \n [29] limma_3.58.1              RSQLite_2.3.8            \n [31] BiocIO_1.12.0             generics_0.1.3           \n [33] gtools_3.9.5              ica_1.0-3                \n [35] spatstat.random_3.2-2     ggbeeswarm_0.7.2         \n [37] fansi_1.0.6               abind_1.4-8              \n [39] R.methodsS3_1.8.2         lifecycle_1.0.4          \n [41] yaml_2.3.10               edgeR_4.0.16             \n [43] SparseArray_1.2.2         Rtsne_0.17               \n [45] blob_1.2.4                grid_4.3.2               \n [47] dqrng_0.4.1               promises_1.3.0           \n [49] crayon_1.5.3              shinydashboard_0.7.2     \n [51] miniUI_0.1.1.1            beachmat_2.18.1          \n [53] cowplot_1.1.3             KEGGREST_1.42.0          \n [55] metapod_1.10.1            pillar_1.9.0             \n [57] knitr_1.45                rjson_0.2.23             \n [59] xgboost_1.7.8.1           future.apply_1.11.3      \n [61] codetools_0.2-20          leiden_0.4.3.1           \n [63] glue_1.8.0                remotes_2.5.0            \n [65] png_0.1-8                 spam_2.11-0              \n [67] org.Mm.eg.db_3.18.0       cellranger_1.1.0         \n [69] gtable_0.3.6              cachem_1.1.0             \n [71] xfun_0.49                 S4Arrays_1.2.0           \n [73] mime_0.12                 survival_3.7-0           \n [75] bluster_1.12.0            statmod_1.5.0            \n [77] ellipsis_0.3.2            fitdistrplus_1.2-1       \n [79] ROCR_1.0-11               nlme_3.1-166             \n [81] bit64_4.5.2               RcppAnnoy_0.0.22         \n [83] irlba_2.3.5.1             vipor_0.4.7              \n [85] KernSmooth_2.23-24        DBI_1.2.3                \n [87] colorspace_2.1-1          nnet_7.3-19              \n [89] tidyselect_1.2.1          bit_4.5.0                \n [91] compiler_4.3.2            BiocNeighbors_1.20.2     \n [93] DelayedArray_0.28.0       plotly_4.10.4            \n [95] rtracklayer_1.62.0        scales_1.3.0             \n [97] lmtest_0.9-40             digest_0.6.37            \n [99] goftest_1.2-3             spatstat.utils_3.1-1     \n[101] rmarkdown_2.29            RhpcBLASctl_0.23-42      \n[103] XVector_0.42.0            htmltools_0.5.8.1        \n[105] pkgconfig_2.0.3           sparseMatrixStats_1.14.0 \n[107] fastmap_1.2.0             rlang_1.1.4              \n[109] htmlwidgets_1.6.4         shiny_1.9.1              \n[111] DelayedMatrixStats_1.24.0 farver_2.1.2             \n[113] zoo_1.8-12                jsonlite_1.8.9           \n[115] R.oo_1.27.0               BiocSingular_1.18.0      \n[117] RCurl_1.98-1.16           magrittr_2.0.3           \n[119] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[121] dotCall64_1.2             munsell_0.5.1            \n[123] viridis_0.6.5             reticulate_1.35.0        \n[125] stringi_1.8.4             zlibbioc_1.48.2          \n[127] MASS_7.3-60.0.1           org.Hs.eg.db_3.18.0      \n[129] plyr_1.8.9                pkgbuild_1.4.5           \n[131] ggstats_0.7.0             parallel_4.3.2           \n[133] listenv_0.9.1             ggrepel_0.9.6            \n[135] deldir_2.0-4              Biostrings_2.70.3        \n[137] splines_4.3.2             tensor_1.5               \n[139] hms_1.1.3                 locfit_1.5-9.10          \n[141] igraph_2.1.1              spatstat.geom_3.2-8      \n[143] RcppHNSW_0.6.0            reshape2_1.4.4           \n[145] ScaledMatrix_1.10.0       pkgload_1.4.0            \n[147] XML_3.99-0.17             evaluate_1.0.1           \n[149] scran_1.30.2              BiocManager_1.30.25      \n[151] tzdb_0.4.0                httpuv_1.6.15            \n[153] RANN_2.6.2                polyclip_1.10-7          \n[155] future_1.34.0             scattermore_1.2          \n[157] rsvd_1.0.5                xtable_1.8-4             \n[159] restfulr_0.0.15           svMisc_1.2.3             \n[161] RSpectra_0.16-2           later_1.3.2              \n[163] viridisLite_0.4.2         AnnotationDbi_1.64.1     \n[165] GenomicAlignments_1.38.2  memoise_2.0.1            \n[167] beeswarm_0.4.0            tximport_1.28.0          \n[169] cluster_2.1.6             timechange_0.3.0         \n[171] globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Skin: Normalization, doublet discrimination, integration, clustering</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html",
    "href": "Skin_scRNA_Part3.html",
    "title": "3  Skin: Check patient sexes",
    "section": "",
    "text": "3.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto)\nlibrary(glmGamPoi)\nlibrary(sctransform)\nlibrary(Seurat) \nlibrary(tidyverse)\nlibrary(miQC)   \nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#load-previously-saved-clustered-object",
    "href": "Skin_scRNA_Part3.html#load-previously-saved-clustered-object",
    "title": "3  Skin: Check patient sexes",
    "section": "3.2 Load previously saved clustered object",
    "text": "3.2 Load previously saved clustered object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part2.rds\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#infer-sex-per-cell-using-chrx-and-chry-gene-counts-using-cellxy",
    "href": "Skin_scRNA_Part3.html#infer-sex-per-cell-using-chrx-and-chry-gene-counts-using-cellxy",
    "title": "3  Skin: Check patient sexes",
    "section": "3.3 Infer sex per cell using chrX and chrY gene counts using cellXY",
    "text": "3.3 Infer sex per cell using chrX and chrY gene counts using cellXY\n\nmerged.18279.skin.singlets[['RNA']] &lt;- JoinLayers(merged.18279.skin.singlets[['RNA']])\nxyPredict &lt;- classifySex(x=merged.18279.skin.singlets@assays$RNA$counts,genome=\"Hs\", qc=F)\n\nWarning in asMethod(object): sparse-&gt;dense coercion: allocating vector of size\n15.2 GiB\n\n\n28cell/s are unable to be classified\n              due to an abundance of zeroes on X and Y chromosome genes\n\nmerged.18279.skin.singlets &lt;- AddMetaData(merged.18279.skin.singlets,xyPredict$prediction,col.name=\"CellPredictedSex\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#assign-known-sexes-to-each-sample",
    "href": "Skin_scRNA_Part3.html#assign-known-sexes-to-each-sample",
    "title": "3  Skin: Check patient sexes",
    "section": "3.4 Assign known sexes to each sample",
    "text": "3.4 Assign known sexes to each sample\n\nknownSex &lt;- as.data.frame(cbind(\"Sample\" = unique(merged.18279.skin.singlets$Sample), \"Sex\" = c(rep(\"Male\",2),rep(\"Male\",2),rep(\"Female\",2),rep(\"Male\",2),rep(\"Female\",2),rep(\"Male\",2),rep(\"Female\",1),rep(\"Male\",2),rep(\"Male\",2))))\n\nknownSex\n\n                           Sample    Sex\n1   P101_Skin_Pre3rd_2.5mgIpi_RNA   Male\n2  P101_Skin_Post3rd_2.5mgIpi_RNA   Male\n3   P103_Skin_Pre3rd_2.5mgIpi_RNA   Male\n4  P103_Skin_Post3rd_2.5mgIpi_RNA   Male\n5  P104_Skin_Post3rd_2.5mgIpi_RNA Female\n6   P104_Skin_Pre3rd_2.5mgIpi_RNA Female\n7  P105_Skin_Post3rd_2.5mgIpi_RNA   Male\n8   P105_Skin_Pre3rd_2.5mgIpi_RNA   Male\n9   P106_Skin_Pre3rd_2.5mgIpi_RNA Female\n10 P106_Skin_Post3rd_2.5mgIpi_RNA Female\n11    P108_Skin_Pre3rd_5mgIpi_RNA   Male\n12   P108_Skin_Post3rd_5mgIpi_RNA   Male\n13    P109_Skin_Pre3rd_5mgIpi_RNA Female\n14    P110_Skin_Pre3rd_5mgIpi_RNA   Male\n15   P110_Skin_Post3rd_5mgIpi_RNA   Male\n16    P111_Skin_Pre3rd_5mgIpi_RNA   Male\n17   P111_Skin_Post3rd_5mgIpi_RNA   Male",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#summarize-cell-wise-sex-predictions-per-sample-and-compare-to-known-labels",
    "href": "Skin_scRNA_Part3.html#summarize-cell-wise-sex-predictions-per-sample-and-compare-to-known-labels",
    "title": "3  Skin: Check patient sexes",
    "section": "3.5 Summarize cell-wise sex predictions per Sample and compare to known labels",
    "text": "3.5 Summarize cell-wise sex predictions per Sample and compare to known labels\nIf more than 80% of the individual cell sex predictions are consistent for a given Sample, we call that Sample as that sex, then match to known labels\n\n# Show snippet first\nrownames_to_column(merged.18279.skin.singlets@meta.data,var=\"bc\") %&gt;%\n    as_tibble() %&gt;%\n    dplyr::select(bc,CellPredictedSex,Sample) %&gt;%\n    group_by(Sample) %&gt;%\n    summarize(nMale = sum(CellPredictedSex==\"Male\"), \n        nFemale = sum(CellPredictedSex==\"Female\"), \n        nCells = n()\n    )\n\n# A tibble: 17 × 4\n   Sample                         nMale nFemale nCells\n   &lt;chr&gt;                          &lt;int&gt;   &lt;int&gt;  &lt;int&gt;\n 1 P101_Skin_Post3rd_2.5mgIpi_RNA  1655      62   1718\n 2 P101_Skin_Pre3rd_2.5mgIpi_RNA    417       9    426\n 3 P103_Skin_Post3rd_2.5mgIpi_RNA  3436     278   3726\n 4 P103_Skin_Pre3rd_2.5mgIpi_RNA    786      36    822\n 5 P104_Skin_Post3rd_2.5mgIpi_RNA   957    4465   5434\n 6 P104_Skin_Pre3rd_2.5mgIpi_RNA    136    2956   3092\n 7 P105_Skin_Post3rd_2.5mgIpi_RNA  3213     215   3429\n 8 P105_Skin_Pre3rd_2.5mgIpi_RNA   2387     139   2526\n 9 P106_Skin_Post3rd_2.5mgIpi_RNA   249    1405   1655\n10 P106_Skin_Pre3rd_2.5mgIpi_RNA     45    1076   1121\n11 P108_Skin_Post3rd_5mgIpi_RNA    2589     100   2689\n12 P108_Skin_Pre3rd_5mgIpi_RNA      906      31    937\n13 P109_Skin_Pre3rd_5mgIpi_RNA       44    1331   1375\n14 P110_Skin_Post3rd_5mgIpi_RNA    1408      72   1481\n15 P110_Skin_Pre3rd_5mgIpi_RNA     1160      31   1191\n16 P111_Skin_Post3rd_5mgIpi_RNA    1270      72   1342\n17 P111_Skin_Pre3rd_5mgIpi_RNA      406      31    437\n\n# Now determine sex per sample and count matching vs non-matching labels\nrownames_to_column(merged.18279.skin.singlets@meta.data,var=\"bc\") %&gt;%\n    as_tibble() %&gt;%\n    dplyr::select(bc,CellPredictedSex,Sample) %&gt;%\n    group_by(Sample) %&gt;%\n    summarize(nMale = sum(CellPredictedSex==\"Male\"), \n        nFemale = sum(CellPredictedSex==\"Female\"), \n        nCells = n()\n    ) %&gt;%\n    ungroup() %&gt;%\n    mutate(PredictedSex = case_when(\n        nMale / nCells &gt; 0.8 ~ \"Male\",\n        nFemale / nCells &gt; 0.8 ~ \"Female\",\n        T ~ \"other\"\n        )\n    ) %&gt;%\n    inner_join(knownSex,by=\"Sample\") %&gt;%\n    summarize(nEqual = sum(PredictedSex==Sex), nNotEqual = sum(PredictedSex != Sex))\n\n# A tibble: 1 × 2\n  nEqual nNotEqual\n   &lt;int&gt;     &lt;int&gt;\n1     17         0",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#since-everything-matches-we-now-add-sex-as-a-metadata-label",
    "href": "Skin_scRNA_Part3.html#since-everything-matches-we-now-add-sex-as-a-metadata-label",
    "title": "3  Skin: Check patient sexes",
    "section": "3.6 Since everything matches we now add Sex as a metadata label",
    "text": "3.6 Since everything matches we now add Sex as a metadata label\n\nknownSexByCell &lt;- enframe(merged.18279.skin.singlets$Sample,name=\"bc\",value=\"Sample\") %&gt;% \n    inner_join(knownSex,by=\"Sample\") %&gt;% \n    pull(Sex)\n    \nmerged.18279.skin.singlets &lt;- AddMetaData(merged.18279.skin.singlets,knownSexByCell,col.name=\"Sex\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#plot-umap-of-sex",
    "href": "Skin_scRNA_Part3.html#plot-umap-of-sex",
    "title": "3  Skin: Check patient sexes",
    "section": "3.7 Plot UMAP of sex",
    "text": "3.7 Plot UMAP of sex\n\nDimPlot(merged.18279.skin.singlets,reduction = \"umap.harmony\", group.by = \"Sex\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#save-the-updated-object",
    "href": "Skin_scRNA_Part3.html#save-the-updated-object",
    "title": "3  Skin: Check patient sexes",
    "section": "3.8 Save the updated object",
    "text": "3.8 Save the updated object\n\nsaveRDS(merged.18279.skin.singlets,file=\"Skin_scRNA_Part3.rds\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part3.html#get-session-info",
    "href": "Skin_scRNA_Part3.html#get-session-info",
    "title": "3  Skin: Check patient sexes",
    "section": "3.9 Get session info",
    "text": "3.9 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] cellXY_0.99.0               scDblFinder_1.14.0         \n [3] harmony_1.2.0               alevinQC_1.16.1            \n [5] vctrs_0.6.5                 patchwork_1.3.0            \n [7] scater_1.30.1               scuttle_1.12.0             \n [9] speckle_1.0.0               Matrix_1.6-4               \n[11] fishpond_2.6.2              readxl_1.4.3               \n[13] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[15] Biobase_2.62.0              GenomicRanges_1.54.1       \n[17] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[19] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[21] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[23] flexmix_2.3-19              lattice_0.22-6             \n[25] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[27] lubridate_1.9.3             forcats_1.0.0              \n[29] stringr_1.5.1               dplyr_1.1.4                \n[31] purrr_1.0.2                 readr_2.1.5                \n[33] tidyr_1.3.1                 tibble_3.2.1               \n[35] ggplot2_3.5.1               tidyverse_2.0.0            \n[37] Seurat_5.1.0                SeuratObject_5.0.2         \n[39] sp_2.1-4                    sctransform_0.4.1          \n[41] glmGamPoi_1.12.2            presto_1.0.0               \n[43] Rcpp_1.0.13-1               devtools_2.4.5             \n[45] usethis_3.0.0               data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] labeling_0.4.3            spatstat.data_3.1-4      \n [23] ggridges_0.5.6            pbapply_1.7-2            \n [25] Rsamtools_2.18.0          R.utils_2.12.3           \n [27] parallelly_1.39.0         sessioninfo_1.2.2        \n [29] limma_3.58.1              RSQLite_2.3.8            \n [31] BiocIO_1.12.0             generics_0.1.3           \n [33] gtools_3.9.5              ica_1.0-3                \n [35] spatstat.random_3.2-2     ggbeeswarm_0.7.2         \n [37] fansi_1.0.6               abind_1.4-8              \n [39] R.methodsS3_1.8.2         lifecycle_1.0.4          \n [41] yaml_2.3.10               edgeR_4.0.16             \n [43] recipes_1.1.0             SparseArray_1.2.2        \n [45] Rtsne_0.17                blob_1.2.4               \n [47] grid_4.3.2                dqrng_0.4.1              \n [49] promises_1.3.0            crayon_1.5.3             \n [51] shinydashboard_0.7.2      miniUI_0.1.1.1           \n [53] beachmat_2.18.1           cowplot_1.1.3            \n [55] KEGGREST_1.42.0           metapod_1.10.1           \n [57] pillar_1.9.0              knitr_1.45               \n [59] rjson_0.2.23              xgboost_1.7.8.1          \n [61] future.apply_1.11.3       codetools_0.2-20         \n [63] leiden_0.4.3.1            glue_1.8.0               \n [65] remotes_2.5.0             png_0.1-8                \n [67] spam_2.11-0               org.Mm.eg.db_3.18.0      \n [69] cellranger_1.1.0          gtable_0.3.6             \n [71] cachem_1.1.0              gower_1.0.1              \n [73] xfun_0.49                 prodlim_2024.06.25       \n [75] S4Arrays_1.2.0            mime_0.12                \n [77] survival_3.7-0            timeDate_4041.110        \n [79] iterators_1.0.14          hardhat_1.4.0            \n [81] lava_1.8.0                bluster_1.12.0           \n [83] statmod_1.5.0             ellipsis_0.3.2           \n [85] fitdistrplus_1.2-1        ipred_0.9-15             \n [87] ROCR_1.0-11               nlme_3.1-166             \n [89] bit64_4.5.2               RcppAnnoy_0.0.22         \n [91] irlba_2.3.5.1             rpart_4.1.23             \n [93] vipor_0.4.7               KernSmooth_2.23-24       \n [95] DBI_1.2.3                 colorspace_2.1-1         \n [97] nnet_7.3-19               tidyselect_1.2.1         \n [99] bit_4.5.0                 compiler_4.3.2           \n[101] BiocNeighbors_1.20.2      DelayedArray_0.28.0      \n[103] plotly_4.10.4             rtracklayer_1.62.0       \n[105] scales_1.3.0              lmtest_0.9-40            \n[107] digest_0.6.37             goftest_1.2-3            \n[109] spatstat.utils_3.1-1      rmarkdown_2.29           \n[111] XVector_0.42.0            htmltools_0.5.8.1        \n[113] pkgconfig_2.0.3           sparseMatrixStats_1.14.0 \n[115] fastmap_1.2.0             rlang_1.1.4              \n[117] htmlwidgets_1.6.4         shiny_1.9.1              \n[119] DelayedMatrixStats_1.24.0 farver_2.1.2             \n[121] zoo_1.8-12                jsonlite_1.8.9           \n[123] BiocParallel_1.36.0       ModelMetrics_1.2.2.2     \n[125] R.oo_1.27.0               BiocSingular_1.18.0      \n[127] RCurl_1.98-1.16           magrittr_2.0.3           \n[129] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[131] dotCall64_1.2             munsell_0.5.1            \n[133] viridis_0.6.5             reticulate_1.35.0        \n[135] pROC_1.18.5               stringi_1.8.4            \n[137] zlibbioc_1.48.2           MASS_7.3-60.0.1          \n[139] org.Hs.eg.db_3.18.0       plyr_1.8.9               \n[141] pkgbuild_1.4.5            ggstats_0.7.0            \n[143] parallel_4.3.2            listenv_0.9.1            \n[145] ggrepel_0.9.6             deldir_2.0-4             \n[147] Biostrings_2.70.3         splines_4.3.2            \n[149] tensor_1.5                hms_1.1.3                \n[151] locfit_1.5-9.10           igraph_2.1.1             \n[153] spatstat.geom_3.2-8       RcppHNSW_0.6.0           \n[155] reshape2_1.4.4            ScaledMatrix_1.10.0      \n[157] pkgload_1.4.0             XML_3.99-0.17            \n[159] evaluate_1.0.1            scran_1.30.2             \n[161] BiocManager_1.30.25       foreach_1.5.2            \n[163] tzdb_0.4.0                httpuv_1.6.15            \n[165] RANN_2.6.2                polyclip_1.10-7          \n[167] future_1.34.0             scattermore_1.2          \n[169] rsvd_1.0.5                xtable_1.8-4             \n[171] restfulr_0.0.15           svMisc_1.2.3             \n[173] RSpectra_0.16-2           later_1.3.2              \n[175] class_7.3-22              viridisLite_0.4.2        \n[177] AnnotationDbi_1.64.1      GenomicAlignments_1.38.2 \n[179] memoise_2.0.1             beeswarm_0.4.0           \n[181] tximport_1.28.0           cluster_2.1.6            \n[183] timechange_0.3.0          globals_0.16.3           \n[185] caret_6.0-94",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Skin: Check patient sexes</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html",
    "href": "Skin_scRNA_Part4.html",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "",
    "text": "4.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto) \nlibrary(glmGamPoi)\nlibrary(sctransform)\nlibrary(Seurat) \nlibrary(tidyverse)\nlibrary(miQC)\nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#load-previously-saved-object",
    "href": "Skin_scRNA_Part4.html#load-previously-saved-object",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.2 Load previously saved object",
    "text": "4.2 Load previously saved object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part3.rds\")",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#set-idents-to-preferred-initial-clustering-resolution",
    "href": "Skin_scRNA_Part4.html#set-idents-to-preferred-initial-clustering-resolution",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.3 Set idents to preferred initial clustering resolution",
    "text": "4.3 Set idents to preferred initial clustering resolution\n\nIdents(merged.18279.skin.singlets) &lt;- merged.18279.skin.singlets$RNA_snn_res.0.8\nmerged.18279.skin.singlets$seurat_clusters &lt;- merged.18279.skin.singlets$RNA_snn_res.0.8\nDimPlot(merged.18279.skin.singlets, reduction=\"umap.harmony\", label = TRUE)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#plot-qc",
    "href": "Skin_scRNA_Part4.html#plot-qc",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.4 Plot QC",
    "text": "4.4 Plot QC\n\nVlnPlot(merged.18279.skin.singlets, features = \"nCount_RNA\", group.by=\"seurat_clusters\",pt.size=0) + NoLegend()\n\n\n\n\n\n\n\nVlnPlot(merged.18279.skin.singlets, features = \"nFeature_RNA\", group.by=\"seurat_clusters\",pt.size=0) + NoLegend()\n\n\n\n\n\n\n\nVlnPlot(merged.18279.skin.singlets, features = \"percent.mt\", group.by=\"seurat_clusters\",pt.size=0) + NoLegend()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#identify-cursory-marker-genes-of-each-cluster",
    "href": "Skin_scRNA_Part4.html#identify-cursory-marker-genes-of-each-cluster",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.5 Identify cursory marker genes of each cluster",
    "text": "4.5 Identify cursory marker genes of each cluster\nNote layers were already joined in previous session\n\nDefaultAssay(merged.18279.skin.singlets) &lt;- \"RNA\"\n\nvargenes &lt;- presto::wilcoxauc(merged.18279.skin.singlets, 'seurat_clusters', seurat_assay = 'RNA')\ntop_vargenes &lt;- top_markers(vargenes, n = 100, auc_min = 0.5, pct_in_min = 50, pct_out_max = 50)\ntop_vargenes\n\n# A tibble: 100 × 28\n    rank `0`   `1`   `10`  `11`  `12`  `13`  `14`  `15`  `16`  `17`  `18`  `19` \n   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;\n 1     1 TYRO… IL7R  COL6… CNOT… DOCK4 STMN1 ENSG… LAMP3 HPGD  TM4S… CPVL  DSP  \n 2     2 BCL2… SPOC… DCN   PARP8 RBM47 HMGB2 IL3RA FSCN1 TPSA… SPAR… ENSG… PERP \n 3     3 FCER… CD3E  COL6… SYNE2 FNDC… TYMS  IRF4  MARC… TPSB2 PECA… WDFY4 SFN  \n 4     4 IFI30 LTB   COL1… SLC3… MYO9B RRM2  P2RY6 DAPP1 CPA3  GNG11 HLA-… DSC3 \n 5     5 IL1RN ICOS  CALD1 BCL1… KYNU  MKI67 ENSG… NUB1  HPGDS CAV1  HLA-… EGFR \n 6     6 MARC… IL32  NNMT  PRKCH CYRIA DUT   PLD4  BASP1 GATA2 RAMP2 C1or… JUP  \n 7     7 PLAUR CD52  C1R   PPP1… ABCA1 H4C3  JCHA… CCR7  KIT   A2M   DNAS… KLF5 \n 8     8 ENSG… CD3D  C1S   KLF12 DMXL2 PCLAF SLC1… CERS6 CTSG  PDLI… HDAC9 TACS…\n 9     9 S100… CD2   PRRX1 CAMK4 ATP1… MCM7  POLB  CD83  HDC   ADGR… RUBC… CDH1 \n10    10 PLEK  CD6   CXCL… CDK17 MCTP1 PPP1… FCHS… RASS… IL18… EMCN  CLEC… PARD3\n# ℹ 90 more rows\n# ℹ 15 more variables: `2` &lt;chr&gt;, `20` &lt;chr&gt;, `21` &lt;chr&gt;, `22` &lt;chr&gt;,\n#   `23` &lt;chr&gt;, `24` &lt;chr&gt;, `25` &lt;chr&gt;, `26` &lt;chr&gt;, `3` &lt;chr&gt;, `4` &lt;chr&gt;,\n#   `5` &lt;chr&gt;, `6` &lt;chr&gt;, `7` &lt;chr&gt;, `8` &lt;chr&gt;, `9` &lt;chr&gt;",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#plot-genes-from-slide-tags-preprint",
    "href": "Skin_scRNA_Part4.html#plot-genes-from-slide-tags-preprint",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.6 Plot genes from slide-tags preprint",
    "text": "4.6 Plot genes from slide-tags preprint\nSourced from this preprint\n\ngoi &lt;- c(\"PMEL\",\"MLANA\",\"CCL5\",\"LEF1\",\"FOXP3\",\"PAX5\",\"IGHG3\",\"KCNMA1\",\"ZNF366\",\"CUX2\",\"COL1A1\",\"PLVAP\")\nVlnPlot(merged.18279.skin.singlets,features=goi,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#plot-other-known-markers",
    "href": "Skin_scRNA_Part4.html#plot-other-known-markers",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.7 Plot other known markers",
    "text": "4.7 Plot other known markers\nSourced from this paper\n\ntumor &lt;- c(\"DCT\",\"MLANA\",\"MITF\",\"PMEL\",\"S100A1\",\"TYR\",\"APOC1\")\nendothelial &lt;- c(\"PECAM1\",\"VWF\")\nfibroblast &lt;- c(\"COL3A1\",\"COL1A1\",\"COL1A2\",\"LUM\")\ntcell &lt;- c(\"FGFBP2\",\"KLRD1\",\"CD3E\",\"CD3D\",\"GZMB\",\"XCL2\",\"GZMH\",\"CST7\",\"GZMK\",\"GZMA\",\"IFNG\",\"GNLY\",\"CCL4\",\"NKG7\",\"CCL5\",\"CD8A\",\"CD8B\",\"CTLA4\",\"TNFRSF4\",\"BATF\",\"ITM2A\")\nmono &lt;- c(\"LYZ\",\"CD74\",\"CD68\")\nbcell &lt;- c(\"MS4A1\",\"CD79A\")\n\nVlnPlot(merged.18279.skin.singlets,features=tumor,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T) +\n  VlnPlot(merged.18279.skin.singlets,features=endothelial,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T) +\n  VlnPlot(merged.18279.skin.singlets,features=fibroblast,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T) +\n  VlnPlot(merged.18279.skin.singlets,features=tcell,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T) +\n  VlnPlot(merged.18279.skin.singlets,features=mono,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T) +\n  VlnPlot(merged.18279.skin.singlets,features=bcell,assay=\"RNA\",layer=\"data\",flip=T,sort=T,stack=T) +\n  NoLegend()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#plot-top-markers-identified-and-canonical-genes-as-a-dotplot",
    "href": "Skin_scRNA_Part4.html#plot-top-markers-identified-and-canonical-genes-as-a-dotplot",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.8 Plot top markers identified and canonical genes as a dotplot",
    "text": "4.8 Plot top markers identified and canonical genes as a dotplot\n\ntop_vargenes &lt;- top_markers(vargenes, n = 5, auc_min = 0.5, pct_in_min = 50, pct_out_max = 50)\ntop_markers &lt;- top_vargenes %&gt;%\n    select(-rank) %&gt;% \n    unclass() %&gt;% \n    stack() %&gt;%\n    pull(values) %&gt;%\n    unique() %&gt;%\n    .[!is.na(.)]\n\ndotplotmarkers &lt;- unique(c(top_markers,tumor,endothelial,fibroblast,tcell,mono,bcell))\n\n# Compute aggregated expression values of these genes and cluster them to order the figure\nrna &lt;- AverageExpression(merged.18279.skin.singlets,assay=\"RNA\",slot=\"data\")\n\nAs of Seurat v5, we recommend using AggregateExpression to perform pseudo-bulk analysis.\nFirst group.by variable `ident` starts with a number, appending `g` to ensure valid variable names\nThis message is displayed once per session.\n\nrna.sub &lt;- rna$RNA[dotplotmarkers,]\ncors.genes &lt;- as.dist(1-cor(as.matrix(t(rna.sub)),method=\"pearson\"))\nhc.genes &lt;- hclust(cors.genes)\ndotplotmarkers.sorted &lt;- rownames(rna.sub)[hc.genes$order]\n\n# Plot\nDotPlot(merged.18279.skin.singlets,features=dotplotmarkers.sorted,assay=\"RNA\",cols=c(\"blue\",\"red\"),cluster.idents=T) + RotatedAxis()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#plot-expression-of-key-genes-in-umap-space",
    "href": "Skin_scRNA_Part4.html#plot-expression-of-key-genes-in-umap-space",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.9 Plot expression of key genes in UMAP space",
    "text": "4.9 Plot expression of key genes in UMAP space\n\nFeaturePlot(merged.18279.skin.singlets, \n    reduction=\"umap.harmony\", \n    features=c(\"CD8A\",\"CD4\",\"CTLA4\",\"KLRC1\",\"CD79A\",\"PMEL\",\"MLANA\",\"LYZ\",\"PECAM1\",\"COL3A1\",\"SFN\",\"KRT19\"),\n    order = T,\n    ncol = 2)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part4.html#get-session-info",
    "href": "Skin_scRNA_Part4.html#get-session-info",
    "title": "4  Skin: Post-clustering QC and characterization",
    "section": "4.10 Get session info",
    "text": "4.10 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] cellXY_0.99.0               scDblFinder_1.14.0         \n [3] harmony_1.2.0               alevinQC_1.16.1            \n [5] vctrs_0.6.5                 patchwork_1.3.0            \n [7] scater_1.30.1               scuttle_1.12.0             \n [9] speckle_1.0.0               Matrix_1.6-4               \n[11] fishpond_2.6.2              readxl_1.4.3               \n[13] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[15] Biobase_2.62.0              GenomicRanges_1.54.1       \n[17] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[19] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[21] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[23] flexmix_2.3-19              lattice_0.22-6             \n[25] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[27] lubridate_1.9.3             forcats_1.0.0              \n[29] stringr_1.5.1               dplyr_1.1.4                \n[31] purrr_1.0.2                 readr_2.1.5                \n[33] tidyr_1.3.1                 tibble_3.2.1               \n[35] ggplot2_3.5.1               tidyverse_2.0.0            \n[37] Seurat_5.1.0                SeuratObject_5.0.2         \n[39] sp_2.1-4                    sctransform_0.4.1          \n[41] glmGamPoi_1.12.2            presto_1.0.0               \n[43] Rcpp_1.0.13-1               devtools_2.4.5             \n[45] usethis_3.0.0               data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] labeling_0.4.3            spatstat.data_3.1-4      \n [23] ggridges_0.5.6            pbapply_1.7-2            \n [25] Rsamtools_2.18.0          R.utils_2.12.3           \n [27] parallelly_1.39.0         sessioninfo_1.2.2        \n [29] limma_3.58.1              RSQLite_2.3.8            \n [31] BiocIO_1.12.0             generics_0.1.3           \n [33] gtools_3.9.5              ica_1.0-3                \n [35] spatstat.random_3.2-2     ggbeeswarm_0.7.2         \n [37] fansi_1.0.6               abind_1.4-8              \n [39] R.methodsS3_1.8.2         lifecycle_1.0.4          \n [41] yaml_2.3.10               edgeR_4.0.16             \n [43] SparseArray_1.2.2         Rtsne_0.17               \n [45] blob_1.2.4                grid_4.3.2               \n [47] dqrng_0.4.1               promises_1.3.0           \n [49] crayon_1.5.3              shinydashboard_0.7.2     \n [51] miniUI_0.1.1.1            beachmat_2.18.1          \n [53] cowplot_1.1.3             KEGGREST_1.42.0          \n [55] metapod_1.10.1            pillar_1.9.0             \n [57] knitr_1.45                rjson_0.2.23             \n [59] xgboost_1.7.8.1           future.apply_1.11.3      \n [61] codetools_0.2-20          leiden_0.4.3.1           \n [63] glue_1.8.0                remotes_2.5.0            \n [65] png_0.1-8                 spam_2.11-0              \n [67] org.Mm.eg.db_3.18.0       cellranger_1.1.0         \n [69] gtable_0.3.6              cachem_1.1.0             \n [71] xfun_0.49                 S4Arrays_1.2.0           \n [73] mime_0.12                 survival_3.7-0           \n [75] bluster_1.12.0            statmod_1.5.0            \n [77] ellipsis_0.3.2            fitdistrplus_1.2-1       \n [79] ROCR_1.0-11               nlme_3.1-166             \n [81] bit64_4.5.2               RcppAnnoy_0.0.22         \n [83] irlba_2.3.5.1             vipor_0.4.7              \n [85] KernSmooth_2.23-24        DBI_1.2.3                \n [87] colorspace_2.1-1          nnet_7.3-19              \n [89] ggrastr_1.0.2             tidyselect_1.2.1         \n [91] bit_4.5.0                 compiler_4.3.2           \n [93] BiocNeighbors_1.20.2      DelayedArray_0.28.0      \n [95] plotly_4.10.4             rtracklayer_1.62.0       \n [97] scales_1.3.0              lmtest_0.9-40            \n [99] digest_0.6.37             goftest_1.2-3            \n[101] spatstat.utils_3.1-1      rmarkdown_2.29           \n[103] XVector_0.42.0            htmltools_0.5.8.1        \n[105] pkgconfig_2.0.3           sparseMatrixStats_1.14.0 \n[107] fastmap_1.2.0             rlang_1.1.4              \n[109] htmlwidgets_1.6.4         shiny_1.9.1              \n[111] DelayedMatrixStats_1.24.0 farver_2.1.2             \n[113] zoo_1.8-12                jsonlite_1.8.9           \n[115] BiocParallel_1.36.0       R.oo_1.27.0              \n[117] BiocSingular_1.18.0       RCurl_1.98-1.16          \n[119] magrittr_2.0.3            modeltools_0.2-23        \n[121] GenomeInfoDbData_1.2.11   dotCall64_1.2            \n[123] munsell_0.5.1             viridis_0.6.5            \n[125] reticulate_1.35.0         stringi_1.8.4            \n[127] zlibbioc_1.48.2           MASS_7.3-60.0.1          \n[129] org.Hs.eg.db_3.18.0       plyr_1.8.9               \n[131] pkgbuild_1.4.5            ggstats_0.7.0            \n[133] parallel_4.3.2            listenv_0.9.1            \n[135] ggrepel_0.9.6             deldir_2.0-4             \n[137] Biostrings_2.70.3         splines_4.3.2            \n[139] tensor_1.5                hms_1.1.3                \n[141] locfit_1.5-9.10           igraph_2.1.1             \n[143] spatstat.geom_3.2-8       RcppHNSW_0.6.0           \n[145] reshape2_1.4.4            ScaledMatrix_1.10.0      \n[147] pkgload_1.4.0             XML_3.99-0.17            \n[149] evaluate_1.0.1            scran_1.30.2             \n[151] BiocManager_1.30.25       tzdb_0.4.0               \n[153] httpuv_1.6.15             RANN_2.6.2               \n[155] polyclip_1.10-7           future_1.34.0            \n[157] scattermore_1.2           rsvd_1.0.5               \n[159] xtable_1.8-4              restfulr_0.0.15          \n[161] svMisc_1.2.3              RSpectra_0.16-2          \n[163] later_1.3.2               viridisLite_0.4.2        \n[165] AnnotationDbi_1.64.1      GenomicAlignments_1.38.2 \n[167] memoise_2.0.1             beeswarm_0.4.0           \n[169] tximport_1.28.0           cluster_2.1.6            \n[171] timechange_0.3.0          globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Skin: Post-clustering QC and characterization</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html",
    "href": "Skin_scRNA_Part5.html",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "",
    "text": "5.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto)\nlibrary(glmGamPoi)\nlibrary(sctransform) \nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(miQC)\nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#load-previously-saved-object",
    "href": "Skin_scRNA_Part5.html#load-previously-saved-object",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.2 Load previously saved object",
    "text": "5.2 Load previously saved object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part3.rds\")",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#set-idents-to-preferred-initial-clustering-resolution",
    "href": "Skin_scRNA_Part5.html#set-idents-to-preferred-initial-clustering-resolution",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.3 Set idents to preferred initial clustering resolution",
    "text": "5.3 Set idents to preferred initial clustering resolution\n\nIdents(merged.18279.skin.singlets) &lt;- merged.18279.skin.singlets$RNA_snn_res.0.8\nmerged.18279.skin.singlets$seurat_clusters &lt;- merged.18279.skin.singlets$RNA_snn_res.0.8\nDimPlot(merged.18279.skin.singlets, reduction=\"umap.harmony\", label=TRUE)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#detect-markers-with-findallmarkers",
    "href": "Skin_scRNA_Part5.html#detect-markers-with-findallmarkers",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.4 Detect markers with FindAllMarkers",
    "text": "5.4 Detect markers with FindAllMarkers\n\nfam &lt;- FindAllMarkers(merged.18279.skin.singlets,\n                      assay=\"RNA\",\n                      slot=\"data\",\n                      only.pos = TRUE, \n                      logfc.threshold = 0.25)\n\nCalculating cluster 0\n\n\nCalculating cluster 1\n\n\nCalculating cluster 2\n\n\nCalculating cluster 3\n\n\nCalculating cluster 4\n\n\nCalculating cluster 5\n\n\nCalculating cluster 6\n\n\nCalculating cluster 7\n\n\nCalculating cluster 8\n\n\nCalculating cluster 9\n\n\nCalculating cluster 10\n\n\nCalculating cluster 11\n\n\nCalculating cluster 12\n\n\nCalculating cluster 13\n\n\nCalculating cluster 14\n\n\nCalculating cluster 15\n\n\nCalculating cluster 16\n\n\nCalculating cluster 17\n\n\nCalculating cluster 18\n\n\nCalculating cluster 19\n\n\nCalculating cluster 20\n\n\nCalculating cluster 21\n\n\nCalculating cluster 22\n\n\nCalculating cluster 23\n\n\nCalculating cluster 24\n\n\nCalculating cluster 25\n\n\nCalculating cluster 26\n\nhead(fam)\n\n         p_val avg_log2FC pct.1 pct.2 p_val_adj cluster     gene\nS100A9       0   3.955395 0.896 0.126         0       0   S100A9\nC5AR1        0   3.610838 0.895 0.130         0       0    C5AR1\nAPOBEC3A     0   4.327725 0.866 0.116         0       0 APOBEC3A\nSERPINA1     0   3.751497 0.871 0.121         0       0 SERPINA1\nIL1RN        0   3.784982 0.944 0.199         0       0    IL1RN\nC15orf48     0   3.431901 0.887 0.147         0       0 C15orf48",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#plot-top-markers-per-cluster-as-dotplot",
    "href": "Skin_scRNA_Part5.html#plot-top-markers-per-cluster-as-dotplot",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.5 Plot top markers per cluster as dotplot",
    "text": "5.5 Plot top markers per cluster as dotplot\n\nfam_top &lt;- fam %&gt;%\n    mutate(diff = pct.1 - pct.2) %&gt;%\n    dplyr::filter(pct.1 &gt; 0.25 & diff &gt; 0.1 & pct.2 &lt; 0.1 & p_val_adj &lt; 0.01) %&gt;%\n    group_by(cluster) %&gt;%\n    slice_head(n=10) %&gt;%\n    pull(gene) %&gt;%\n    unique()\n\n# Compute aggregated expression values of these genes and cluster them to order the figure\nrna &lt;- AverageExpression(merged.18279.skin.singlets,assay=\"RNA\",slot=\"data\")\n\nAs of Seurat v5, we recommend using AggregateExpression to perform pseudo-bulk analysis.\nFirst group.by variable `ident` starts with a number, appending `g` to ensure valid variable names\nThis message is displayed once per session.\n\nrna.sub &lt;- rna$RNA[fam_top,]\ncors.genes &lt;- as.dist(1-cor(as.matrix(t(rna.sub)),method=\"pearson\"))\nhc.genes &lt;- hclust(cors.genes)\nfam_top.sorted &lt;- rownames(rna.sub)[hc.genes$order]\n\n# Plot\nDotPlot(merged.18279.skin.singlets,\n        features = fam_top.sorted,\n        assay = \"RNA\",\n        cols=c(\"blue\",\"red\"),\n        cluster.idents=T) + \n  RotatedAxis()",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#subset-to-tnk-lineage-and-compute-markers-just-among-these-clusters",
    "href": "Skin_scRNA_Part5.html#subset-to-tnk-lineage-and-compute-markers-just-among-these-clusters",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.6 Subset to T/NK lineage and compute markers just among these clusters",
    "text": "5.6 Subset to T/NK lineage and compute markers just among these clusters\n\nmerged.18279.skin.singlets.tnk &lt;- subset(merged.18279.skin.singlets,\n                                    subset = seurat_clusters %in% c(1,2,4,5,6,9,11,13,19))\nfam.tnk &lt;- FindAllMarkers(merged.18279.skin.singlets.tnk,\n                      assay=\"RNA\",\n                      slot=\"data\",\n                      only.pos = T, \n                      logfc.threshold = 0.25)\n\nCalculating cluster 1\n\n\nCalculating cluster 2\n\n\nCalculating cluster 4\n\n\nCalculating cluster 5\n\n\nCalculating cluster 6\n\n\nCalculating cluster 9\n\n\nCalculating cluster 11\n\n\nCalculating cluster 13\n\n\nCalculating cluster 19\n\nhead(fam.tnk)\n\n       p_val avg_log2FC pct.1 pct.2 p_val_adj cluster   gene\nLTB        0  1.7198102 0.813 0.327         0       1    LTB\nICOS       0  1.6732385 0.724 0.257         0       1   ICOS\nIL7R       0  1.3524027 0.853 0.402         0       1   IL7R\nSPOCK2     0  1.3218146 0.832 0.397         0       1 SPOCK2\nCD3E       0  0.9763243 0.888 0.474         0       1   CD3E\nCD3D       0  0.9674333 0.773 0.364         0       1   CD3D",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#plot-top-markers-per-cluster-as-dotplot-1",
    "href": "Skin_scRNA_Part5.html#plot-top-markers-per-cluster-as-dotplot-1",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.7 Plot top markers per cluster as dotplot",
    "text": "5.7 Plot top markers per cluster as dotplot\n\nfam.tnk_top &lt;- fam.tnk %&gt;%\n    mutate(diff = pct.1 - pct.2) %&gt;%\n    dplyr::filter(pct.1 &gt; 0.25 & diff &gt; 0.1 & pct.2 &lt; 0.1 & p_val_adj &lt; 0.01) %&gt;%\n    group_by(cluster) %&gt;%\n    slice_head(n=10) %&gt;%\n    pull(gene) %&gt;%\n    unique()\n\n# Compute aggregated expression values of these genes and cluster them to order the figure\nrna &lt;- AverageExpression(merged.18279.skin.singlets,assay=\"RNA\",slot=\"data\")\nrna.sub &lt;- rna$RNA[fam.tnk_top,]\ncors.genes &lt;- as.dist(1-cor(as.matrix(t(rna.sub)),method=\"pearson\"))\nhc.genes &lt;- hclust(cors.genes)\nfam.tnk_top.sorted &lt;- rownames(rna.sub)[hc.genes$order]\n\n# Plot\nDotPlot(merged.18279.skin.singlets,\n        features = fam.tnk_top.sorted,\n        assay = \"RNA\",\n        cols=c(\"blue\",\"red\"),\n        cluster.idents=T) + \n  RotatedAxis()",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part5.html#get-sessioninfo",
    "href": "Skin_scRNA_Part5.html#get-sessioninfo",
    "title": "5  Skin: Post-clustering comprehensive marker identification",
    "section": "5.8 Get sessionInfo",
    "text": "5.8 Get sessionInfo\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] cellXY_0.99.0               scDblFinder_1.14.0         \n [3] harmony_1.2.0               alevinQC_1.16.1            \n [5] vctrs_0.6.5                 patchwork_1.3.0            \n [7] scater_1.30.1               scuttle_1.12.0             \n [9] speckle_1.0.0               Matrix_1.6-4               \n[11] fishpond_2.6.2              readxl_1.4.3               \n[13] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[15] Biobase_2.62.0              GenomicRanges_1.54.1       \n[17] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[19] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[21] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[23] flexmix_2.3-19              lattice_0.22-6             \n[25] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[27] lubridate_1.9.3             forcats_1.0.0              \n[29] stringr_1.5.1               dplyr_1.1.4                \n[31] purrr_1.0.2                 readr_2.1.5                \n[33] tidyr_1.3.1                 tibble_3.2.1               \n[35] ggplot2_3.5.1               tidyverse_2.0.0            \n[37] Seurat_5.1.0                SeuratObject_5.0.2         \n[39] sp_2.1-4                    sctransform_0.4.1          \n[41] glmGamPoi_1.12.2            presto_1.0.0               \n[43] Rcpp_1.0.13-1               devtools_2.4.5             \n[45] usethis_3.0.0               data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] labeling_0.4.3            spatstat.data_3.1-4      \n [23] ggridges_0.5.6            pbapply_1.7-2            \n [25] Rsamtools_2.18.0          R.utils_2.12.3           \n [27] parallelly_1.39.0         sessioninfo_1.2.2        \n [29] limma_3.58.1              RSQLite_2.3.8            \n [31] BiocIO_1.12.0             generics_0.1.3           \n [33] gtools_3.9.5              ica_1.0-3                \n [35] spatstat.random_3.2-2     ggbeeswarm_0.7.2         \n [37] fansi_1.0.6               abind_1.4-8              \n [39] R.methodsS3_1.8.2         lifecycle_1.0.4          \n [41] yaml_2.3.10               edgeR_4.0.16             \n [43] SparseArray_1.2.2         Rtsne_0.17               \n [45] blob_1.2.4                grid_4.3.2               \n [47] dqrng_0.4.1               promises_1.3.0           \n [49] crayon_1.5.3              shinydashboard_0.7.2     \n [51] miniUI_0.1.1.1            beachmat_2.18.1          \n [53] cowplot_1.1.3             KEGGREST_1.42.0          \n [55] metapod_1.10.1            pillar_1.9.0             \n [57] knitr_1.45                rjson_0.2.23             \n [59] xgboost_1.7.8.1           future.apply_1.11.3      \n [61] codetools_0.2-20          leiden_0.4.3.1           \n [63] glue_1.8.0                remotes_2.5.0            \n [65] png_0.1-8                 spam_2.11-0              \n [67] org.Mm.eg.db_3.18.0       cellranger_1.1.0         \n [69] gtable_0.3.6              cachem_1.1.0             \n [71] xfun_0.49                 S4Arrays_1.2.0           \n [73] mime_0.12                 survival_3.7-0           \n [75] bluster_1.12.0            statmod_1.5.0            \n [77] ellipsis_0.3.2            fitdistrplus_1.2-1       \n [79] ROCR_1.0-11               nlme_3.1-166             \n [81] bit64_4.5.2               RcppAnnoy_0.0.22         \n [83] irlba_2.3.5.1             vipor_0.4.7              \n [85] KernSmooth_2.23-24        DBI_1.2.3                \n [87] colorspace_2.1-1          nnet_7.3-19              \n [89] tidyselect_1.2.1          bit_4.5.0                \n [91] compiler_4.3.2            BiocNeighbors_1.20.2     \n [93] DelayedArray_0.28.0       plotly_4.10.4            \n [95] rtracklayer_1.62.0        scales_1.3.0             \n [97] lmtest_0.9-40             digest_0.6.37            \n [99] goftest_1.2-3             spatstat.utils_3.1-1     \n[101] rmarkdown_2.29            XVector_0.42.0           \n[103] htmltools_0.5.8.1         pkgconfig_2.0.3          \n[105] sparseMatrixStats_1.14.0  fastmap_1.2.0            \n[107] rlang_1.1.4               htmlwidgets_1.6.4        \n[109] shiny_1.9.1               DelayedMatrixStats_1.24.0\n[111] farver_2.1.2              zoo_1.8-12               \n[113] jsonlite_1.8.9            BiocParallel_1.36.0      \n[115] R.oo_1.27.0               BiocSingular_1.18.0      \n[117] RCurl_1.98-1.16           magrittr_2.0.3           \n[119] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[121] dotCall64_1.2             munsell_0.5.1            \n[123] viridis_0.6.5             reticulate_1.35.0        \n[125] stringi_1.8.4             zlibbioc_1.48.2          \n[127] MASS_7.3-60.0.1           org.Hs.eg.db_3.18.0      \n[129] plyr_1.8.9                pkgbuild_1.4.5           \n[131] ggstats_0.7.0             parallel_4.3.2           \n[133] listenv_0.9.1             ggrepel_0.9.6            \n[135] deldir_2.0-4              Biostrings_2.70.3        \n[137] splines_4.3.2             tensor_1.5               \n[139] hms_1.1.3                 locfit_1.5-9.10          \n[141] igraph_2.1.1              spatstat.geom_3.2-8      \n[143] RcppHNSW_0.6.0            reshape2_1.4.4           \n[145] ScaledMatrix_1.10.0       pkgload_1.4.0            \n[147] XML_3.99-0.17             evaluate_1.0.1           \n[149] scran_1.30.2              BiocManager_1.30.25      \n[151] tzdb_0.4.0                httpuv_1.6.15            \n[153] RANN_2.6.2                polyclip_1.10-7          \n[155] future_1.34.0             scattermore_1.2          \n[157] rsvd_1.0.5                xtable_1.8-4             \n[159] restfulr_0.0.15           svMisc_1.2.3             \n[161] RSpectra_0.16-2           later_1.3.2              \n[163] viridisLite_0.4.2         AnnotationDbi_1.64.1     \n[165] GenomicAlignments_1.38.2  memoise_2.0.1            \n[167] beeswarm_0.4.0            tximport_1.28.0          \n[169] cluster_2.1.6             timechange_0.3.0         \n[171] globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Skin: Post-clustering comprehensive marker identification</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html",
    "href": "Skin_scRNA_Part6.html",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "",
    "text": "6.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto)\nlibrary(glmGamPoi)\nlibrary(sctransform) \nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(miQC)  \nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#load-previously-saved-object",
    "href": "Skin_scRNA_Part6.html#load-previously-saved-object",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.2 Load previously saved object",
    "text": "6.2 Load previously saved object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part3.rds\")",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#set-idents-to-preferred-initial-clustering-resolution",
    "href": "Skin_scRNA_Part6.html#set-idents-to-preferred-initial-clustering-resolution",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.3 Set idents to preferred initial clustering resolution",
    "text": "6.3 Set idents to preferred initial clustering resolution\n\nIdents(merged.18279.skin.singlets) &lt;- merged.18279.skin.singlets$RNA_snn_res.0.8\nmerged.18279.skin.singlets$seurat_clusters &lt;- merged.18279.skin.singlets$RNA_snn_res.0.8\nDimPlot(merged.18279.skin.singlets, reduction=\"umap.harmony\", label=T)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#run-sub-clustering-on-tnk-lineage",
    "href": "Skin_scRNA_Part6.html#run-sub-clustering-on-tnk-lineage",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.4 Run sub-clustering on T/NK lineage",
    "text": "6.4 Run sub-clustering on T/NK lineage\nT/NK cells are in clusters 1, 2, 4, 5, 6, 9, 11, 13, 19\n\n6.4.1 Cluster 1\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets, \n                                        cluster = \"1\",\n                                        resolution = 0.2,\n                                        graph.name = \"RNA_snn\",  \n                                        algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 3711\nNumber of edges: 114477\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8350\nNumber of communities: 2\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,  \n        reduction = \"umap.harmony\",  \n        group.by = \"sub.cluster\", \n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10   11   12   13   14   15   16   17   18   19    2   20   21 \n5899 2584 1127 1145  939  892  573  560  515  406  361  306  298 2966  278  239 \n  22   23   24   25   26    3    4    5    6    7    8    9 \n 239  173  145   45   34 2364 2337 2197 2070 1757 1594 1358 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"  \"7\"   \"0\"   \"25\"  \"9\"   \"18\"  \"22\"  \"4\"   \"1_1\" \"13\"  \"14\"  \"17\" \n[13] \"19\"  \"23\"  \"1_0\" \"12\"  \"3\"   \"11\"  \"8\"   \"5\"   \"6\"   \"2\"   \"16\"  \"20\" \n[25] \"24\"  \"15\"  \"21\"  \"26\" \n\n\n\n\n6.4.2 Cluster 2\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets, \n                                        cluster = \"2\",\n                                        resolution = 0.2,\n                                        graph.name = \"RNA_snn\",  \n                                        algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 2966\nNumber of edges: 91828\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8299\nNumber of communities: 3\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,  \n        reduction = \"umap.harmony\",  \n        group.by = \"sub.cluster\", \n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10   11   12   13   14   15   16   17   18   19  2_0  2_1  2_2 \n5899 2584 1127 1145  939  892  573  560  515  406  361  306  298 1634  905  427 \n  20   21   22   23   24   25   26    3    4    5    6    7    8    9 \n 278  239  239  173  145   45   34 2364 2337 2197 2070 1757 1594 1358 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"  \"7\"   \"0\"   \"25\"  \"9\"   \"18\"  \"22\"  \"4\"   \"1_1\" \"13\"  \"14\"  \"17\" \n[13] \"19\"  \"23\"  \"1_0\" \"12\"  \"3\"   \"11\"  \"8\"   \"5\"   \"6\"   \"2_1\" \"2_0\" \"16\" \n[25] \"20\"  \"2_2\" \"24\"  \"15\"  \"21\"  \"26\" \n\n\n\n\n6.4.3 Cluster 4\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets, \n                                        cluster = \"4\",\n                                        resolution = 0.2,\n                                        graph.name = \"RNA_snn\",  \n                                        algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 2337\nNumber of edges: 74398\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8541\nNumber of communities: 3\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,  \n        reduction = \"umap.harmony\",  \n        group.by = \"sub.cluster\", \n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10   11   12   13   14   15   16   17   18   19  2_0  2_1  2_2 \n5899 2584 1127 1145  939  892  573  560  515  406  361  306  298 1634  905  427 \n  20   21   22   23   24   25   26    3  4_0  4_1  4_2    5    6    7    8    9 \n 278  239  239  173  145   45   34 2364  961  907  469 2197 2070 1757 1594 1358 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"  \"7\"   \"0\"   \"25\"  \"9\"   \"18\"  \"22\"  \"4_2\" \"1_1\" \"13\"  \"14\"  \"4_0\"\n[13] \"17\"  \"19\"  \"23\"  \"1_0\" \"12\"  \"3\"   \"11\"  \"8\"   \"5\"   \"6\"   \"2_1\" \"2_0\"\n[25] \"4_1\" \"16\"  \"20\"  \"2_2\" \"24\"  \"15\"  \"21\"  \"26\" \n\n\n\n\n6.4.4 Cluster 5\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets, \n                                        cluster = \"5\",\n                                        resolution = 0.2,\n                                        graph.name = \"RNA_snn\",  \n                                        algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 2197\nNumber of edges: 82865\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8501\nNumber of communities: 3\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,  \n        reduction = \"umap.harmony\",  \n        group.by = \"sub.cluster\", \n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10   11   12   13   14   15   16   17   18   19  2_0  2_1  2_2 \n5899 2584 1127 1145  939  892  573  560  515  406  361  306  298 1634  905  427 \n  20   21   22   23   24   25   26    3  4_0  4_1  4_2  5_0  5_1  5_2    6    7 \n 278  239  239  173  145   45   34 2364  961  907  469 1474  557  166 2070 1757 \n   8    9 \n1594 1358 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"  \"7\"   \"0\"   \"25\"  \"9\"   \"18\"  \"22\"  \"4_2\" \"1_1\" \"13\"  \"14\"  \"4_0\"\n[13] \"17\"  \"19\"  \"23\"  \"1_0\" \"12\"  \"3\"   \"11\"  \"8\"   \"5_0\" \"6\"   \"2_1\" \"2_0\"\n[25] \"4_1\" \"16\"  \"5_1\" \"20\"  \"2_2\" \"5_2\" \"24\"  \"15\"  \"21\"  \"26\" \n\n\n\n\n6.4.5 Cluster 6\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets, \n                                        cluster = \"6\",\n                                        resolution = 0.2,\n                                        graph.name = \"RNA_snn\",  \n                                        algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 2070\nNumber of edges: 56777\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8576\nNumber of communities: 2\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,  \n        reduction = \"umap.harmony\",  \n        group.by = \"sub.cluster\", \n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10   11   12   13   14   15   16   17   18   19  2_0  2_1  2_2 \n5899 2584 1127 1145  939  892  573  560  515  406  361  306  298 1634  905  427 \n  20   21   22   23   24   25   26    3  4_0  4_1  4_2  5_0  5_1  5_2  6_0  6_1 \n 278  239  239  173  145   45   34 2364  961  907  469 1474  557  166 1163  907 \n   7    8    9 \n1757 1594 1358 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"  \"7\"   \"0\"   \"25\"  \"9\"   \"18\"  \"22\"  \"4_2\" \"1_1\" \"13\"  \"14\"  \"4_0\"\n[13] \"17\"  \"19\"  \"23\"  \"1_0\" \"12\"  \"3\"   \"11\"  \"8\"   \"5_0\" \"6_0\" \"6_1\" \"2_1\"\n[25] \"2_0\" \"4_1\" \"16\"  \"5_1\" \"20\"  \"2_2\" \"5_2\" \"24\"  \"15\"  \"21\"  \"26\" \n\n\n\n\n6.4.6 Cluster 9\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets, \n                                        cluster = \"9\",\n                                        resolution = 0.2,\n                                        graph.name = \"RNA_snn\",  \n                                        algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 1358\nNumber of edges: 49285\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8613\nNumber of communities: 4\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,  \n        reduction = \"umap.harmony\",  \n        group.by = \"sub.cluster\", \n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10   11   12   13   14   15   16   17   18   19  2_0  2_1  2_2 \n5899 2584 1127 1145  939  892  573  560  515  406  361  306  298 1634  905  427 \n  20   21   22   23   24   25   26    3  4_0  4_1  4_2  5_0  5_1  5_2  6_0  6_1 \n 278  239  239  173  145   45   34 2364  961  907  469 1474  557  166 1163  907 \n   7    8  9_0  9_1  9_2  9_3 \n1757 1594  544  372  358   84 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"  \"7\"   \"0\"   \"25\"  \"9_2\" \"18\"  \"22\"  \"4_2\" \"9_1\" \"9_0\" \"1_1\" \"13\" \n[13] \"14\"  \"4_0\" \"17\"  \"19\"  \"23\"  \"1_0\" \"12\"  \"3\"   \"11\"  \"8\"   \"5_0\" \"6_0\"\n[25] \"6_1\" \"2_1\" \"2_0\" \"4_1\" \"16\"  \"5_1\" \"20\"  \"2_2\" \"5_2\" \"24\"  \"15\"  \"21\" \n[37] \"9_3\" \"26\" \n\n\n\n\n6.4.7 Cluster 11\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets,\n                                                                                cluster = \"11\",\n                                                                                resolution = 0.2,\n                                                                                graph.name = \"RNA_snn\",\n                                                                                algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 939\nNumber of edges: 27404\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8043\nNumber of communities: 2\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,\n        reduction = \"umap.harmony\",\n        group.by = \"sub.cluster\",\n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10 11_0 11_1   12   13   14   15   16   17   18   19  2_0  2_1 \n5899 2584 1127 1145  833  106  892  573  560  515  406  361  306  298 1634  905 \n 2_2   20   21   22   23   24   25   26    3  4_0  4_1  4_2  5_0  5_1  5_2  6_0 \n 427  278  239  239  173  145   45   34 2364  961  907  469 1474  557  166 1163 \n 6_1    7    8  9_0  9_1  9_2  9_3 \n 907 1757 1594  544  372  358   84 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"   \"7\"    \"0\"    \"25\"   \"9_2\"  \"18\"   \"22\"   \"4_2\"  \"9_1\"  \"9_0\" \n[11] \"1_1\"  \"13\"   \"14\"   \"4_0\"  \"17\"   \"19\"   \"23\"   \"1_0\"  \"12\"   \"3\"   \n[21] \"11_0\" \"8\"    \"5_0\"  \"6_0\"  \"6_1\"  \"2_1\"  \"2_0\"  \"4_1\"  \"16\"   \"5_1\" \n[31] \"20\"   \"2_2\"  \"11_1\" \"5_2\"  \"24\"   \"15\"   \"21\"   \"9_3\"  \"26\"  \n\n\n\n\n6.4.8 Cluster 13\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets,\n                                                                                cluster = \"13\",\n                                                                                resolution = 0.2,\n                                                                                graph.name = \"RNA_snn\",\n                                                                                algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 573\nNumber of edges: 18576\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8666\nNumber of communities: 2\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,\n        reduction = \"umap.harmony\",\n        group.by = \"sub.cluster\",\n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10 11_0 11_1   12 13_0 13_1   14   15   16   17   18   19  2_0 \n5899 2584 1127 1145  833  106  892  315  258  560  515  406  361  306  298 1634 \n 2_1  2_2   20   21   22   23   24   25   26    3  4_0  4_1  4_2  5_0  5_1  5_2 \n 905  427  278  239  239  173  145   45   34 2364  961  907  469 1474  557  166 \n 6_0  6_1    7    8  9_0  9_1  9_2  9_3 \n1163  907 1757 1594  544  372  358   84 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"   \"7\"    \"0\"    \"25\"   \"9_2\"  \"18\"   \"22\"   \"4_2\"  \"9_1\"  \"9_0\" \n[11] \"1_1\"  \"13_1\" \"14\"   \"4_0\"  \"17\"   \"13_0\" \"19\"   \"23\"   \"1_0\"  \"12\"  \n[21] \"3\"    \"11_0\" \"8\"    \"5_0\"  \"6_0\"  \"6_1\"  \"2_1\"  \"2_0\"  \"4_1\"  \"16\"  \n[31] \"5_1\"  \"20\"   \"2_2\"  \"11_1\" \"5_2\"  \"24\"   \"15\"   \"21\"   \"9_3\"  \"26\"  \n\n\n\n\n6.4.9 Cluster 19\n\nmerged.18279.skin.singlets &lt;- FindSubCluster(object = merged.18279.skin.singlets,\n                                                                                cluster = \"19\",\n                                                                                resolution = 0.2,\n                                                                                graph.name = \"RNA_snn\",\n                                                                                algorithm = 2)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 298\nNumber of edges: 7425\n\nRunning Louvain algorithm with multilevel refinement...\nMaximum modularity in 10 random starts: 0.8898\nNumber of communities: 2\nElapsed time: 0 seconds\n\nDimPlot(merged.18279.skin.singlets,\n        reduction = \"umap.harmony\",\n        group.by = \"sub.cluster\",\n        label = TRUE)\n\n\n\n\n\n\n\ntable(merged.18279.skin.singlets$sub.cluster)\n\n\n   0  1_0  1_1   10 11_0 11_1   12 13_0 13_1   14   15   16   17   18 19_0 19_1 \n5899 2584 1127 1145  833  106  892  315  258  560  515  406  361  306  166  132 \n 2_0  2_1  2_2   20   21   22   23   24   25   26    3  4_0  4_1  4_2  5_0  5_1 \n1634  905  427  278  239  239  173  145   45   34 2364  961  907  469 1474  557 \n 5_2  6_0  6_1    7    8  9_0  9_1  9_2  9_3 \n 166 1163  907 1757 1594  544  372  358   84 \n\nIdents(merged.18279.skin.singlets) &lt;- \"sub.cluster\"\nlevels(merged.18279.skin.singlets)\n\n [1] \"10\"   \"7\"    \"0\"    \"25\"   \"9_2\"  \"18\"   \"22\"   \"4_2\"  \"9_1\"  \"9_0\" \n[11] \"1_1\"  \"13_1\" \"14\"   \"4_0\"  \"17\"   \"13_0\" \"19_1\" \"23\"   \"1_0\"  \"12\"  \n[21] \"3\"    \"11_0\" \"8\"    \"5_0\"  \"6_0\"  \"6_1\"  \"2_1\"  \"2_0\"  \"4_1\"  \"16\"  \n[31] \"5_1\"  \"20\"   \"2_2\"  \"11_1\" \"5_2\"  \"24\"   \"15\"   \"21\"   \"9_3\"  \"19_0\"\n[41] \"26\"",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#plot-updated-qc-metrics-per-clustersub-cluster",
    "href": "Skin_scRNA_Part6.html#plot-updated-qc-metrics-per-clustersub-cluster",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.5 Plot updated QC metrics per cluster/sub-cluster",
    "text": "6.5 Plot updated QC metrics per cluster/sub-cluster\n\nVlnPlot(merged.18279.skin.singlets, features = \"nCount_RNA\", group.by=\"sub.cluster\", pt.size=0) + NoLegend()\n\n\n\n\n\n\n\nVlnPlot(merged.18279.skin.singlets, features = \"nFeature_RNA\", group.by=\"sub.cluster\", pt.size=0) + NoLegend()\n\n\n\n\n\n\n\nVlnPlot(merged.18279.skin.singlets, features = \"percent.mt\", group.by=\"sub.cluster\", pt.size=0) + NoLegend()",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#identify-updated-cursory-marker-genes-per-clustersub-cluster",
    "href": "Skin_scRNA_Part6.html#identify-updated-cursory-marker-genes-per-clustersub-cluster",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.6 Identify updated cursory marker genes per cluster/sub-cluster",
    "text": "6.6 Identify updated cursory marker genes per cluster/sub-cluster\n\nDefaultAssay(merged.18279.skin.singlets) &lt;- \"RNA\"\n\nvargenes &lt;- presto::wilcoxauc(merged.18279.skin.singlets, 'sub.cluster', seurat_assay = 'RNA')\ntop_vargenes &lt;- top_markers(vargenes, n = 100, auc_min = 0.5, pct_in_min = 50, pct_out_max = 50)\ntop_vargenes\n\n# A tibble: 100 × 42\n    rank `0`     `1_0` `1_1` `10`  `11_0` `11_1` `12`  `13_0` `13_1` `14`  `15` \n   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;\n 1     1 TYROBP  IL7R  ICOS  COL6… CNOT6L INPP4B DOCK4 STMN1  STMN1  ENSG… LAMP3\n 2     2 BCL2A1  LTB   CD2   DCN   PARP8  SKAP1  RBM47 HMGB2  TYMS   IL3RA FSCN1\n 3     3 FCER1G  SPOC… CD3E  COL6… SLC38… THEMIS FNDC… TYMS   HMGB2  IRF4  MARC…\n 4     4 IFI30   CD3E  CD3D  COL1… SYNE2  ANK3   MYO9B DUT    GZMB   P2RY6 DAPP1\n 5     5 IL1RN   KLF2  SPOC… CALD1 BCL11B PIP4K… KYNU  RRM2   CTSW   ENSG… NUB1 \n 6     6 MARCKS  LDHB  CLEC… NNMT  PRKCH  PARP8  CYRIA MKI67  NKG7   PLD4  BASP1\n 7     7 PLAUR   ICOS  TENT… C1R   PITPN… SYNE2  ABCA1 PPP1CA GZMA   JCHA… CCR7 \n 8     8 ENSG00… CD6   CD6   C1S   PPP1R… AKT3   DMXL2 CKS1B  GNLY   SLC1… CERS6\n 9     9 S100A9  CD3D  BCL1… PRRX1 CDK17  KLF12  ATP1… PCLAF  PRF1   POLB  CD83 \n10    10 PLEK    BCL1… PDCD1 CXCL… CAMK4  CDC14A MCTP1 H4C3   RRM2   FCHS… RASS…\n# ℹ 90 more rows\n# ℹ 30 more variables: `16` &lt;chr&gt;, `17` &lt;chr&gt;, `18` &lt;chr&gt;, `19_0` &lt;chr&gt;,\n#   `19_1` &lt;chr&gt;, `2_0` &lt;chr&gt;, `2_1` &lt;chr&gt;, `2_2` &lt;chr&gt;, `20` &lt;chr&gt;,\n#   `21` &lt;chr&gt;, `22` &lt;chr&gt;, `23` &lt;chr&gt;, `24` &lt;chr&gt;, `25` &lt;chr&gt;, `26` &lt;chr&gt;,\n#   `3` &lt;chr&gt;, `4_0` &lt;chr&gt;, `4_1` &lt;chr&gt;, `4_2` &lt;chr&gt;, `5_0` &lt;chr&gt;, `5_1` &lt;chr&gt;,\n#   `5_2` &lt;chr&gt;, `6_0` &lt;chr&gt;, `6_1` &lt;chr&gt;, `7` &lt;chr&gt;, `8` &lt;chr&gt;, `9_0` &lt;chr&gt;,\n#   `9_1` &lt;chr&gt;, `9_2` &lt;chr&gt;, `9_3` &lt;chr&gt;\n\nwrite_tsv(top_vargenes,\"Skin_scRNA_prestoMarkers.tsv\")",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#plot-top-markers-identified-and-canonical-genes-as-a-dotplot",
    "href": "Skin_scRNA_Part6.html#plot-top-markers-identified-and-canonical-genes-as-a-dotplot",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.7 Plot top markers identified and canonical genes as a dotplot",
    "text": "6.7 Plot top markers identified and canonical genes as a dotplot\n\ntumor &lt;- c(\"DCT\",\"MLANA\",\"MITF\",\"PMEL\",\"S100A1\",\"TYR\",\"APOC1\")\nendothelial &lt;- c(\"PECAM1\",\"VWF\")\nfibroblast &lt;- c(\"COL3A1\",\"COL1A1\",\"COL1A2\",\"LUM\")\ntcell &lt;- c(\"FGFBP2\",\"KLRD1\",\"CD3E\",\"CD3D\",\"GZMB\",\"XCL2\",\"GZMH\",\"CST7\",\"GZMK\",\"GZMA\",\"IFNG\",\"GNLY\",\"CCL4\",\"NKG7\",\"CCL5\",\"CD8A\",\"CD8B\",\"CTLA4\",\"TNFRSF4\",\"BATF\",\"ITM2A\")\nmono &lt;- c(\"LYZ\",\"CD74\",\"CD68\")\nbcell &lt;- c(\"MS4A1\",\"CD79A\")\n\ntop_vargenes &lt;- top_markers(vargenes, n = 5, auc_min = 0.5, pct_in_min = 50, pct_out_max = 50)\ntop_markers &lt;- top_vargenes %&gt;%\n    select(-rank) %&gt;% \n    unclass() %&gt;% \n    stack() %&gt;%\n    pull(values) %&gt;%\n    unique() %&gt;%\n    .[!is.na(.)]\n\ndotplotmarkers &lt;- unique(c(top_markers,tumor,endothelial,fibroblast,tcell,mono,bcell))\n\n# Compute aggregated expression values of these genes and cluster them to order the figure\nrna &lt;- AverageExpression(merged.18279.skin.singlets,assay=\"RNA\",slot=\"data\")\n\nAs of Seurat v5, we recommend using AggregateExpression to perform pseudo-bulk analysis.\nNames of identity class contain underscores ('_'), replacing with dashes ('-')\nFirst group.by variable `ident` starts with a number, appending `g` to ensure valid variable names\nThis message is displayed once per session.\n\nrna.sub &lt;- rna$RNA[dotplotmarkers,]\ncors.genes &lt;- as.dist(1-cor(as.matrix(t(rna.sub)),method=\"pearson\"))\nhc.genes &lt;- hclust(cors.genes)\ndotplotmarkers.sorted &lt;- rownames(rna.sub)[hc.genes$order]\n\n# Also re-order the sub-clusters\ncors.subs &lt;- as.dist(1-cor(as.matrix(rna.sub),method=\"pearson\"))\nhc.subs &lt;- hclust(cors.subs)\nmerged.18279.skin.singlets@active.ident &lt;- factor(merged.18279.skin.singlets@active.ident, \n                            levels=str_replace_all(str_replace_all(colnames(rna.sub)[hc.subs$order],\"g\",\"\"),\"-\",\"_\"))\n\n# Plot\nDotPlot(merged.18279.skin.singlets,\n    features = dotplotmarkers.sorted,\n    assay = \"RNA\",\n    cols = c(\"blue\",\"red\")\n    ) + \n    RotatedAxis()",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#plot-updated-skin-sample-proportions-pre-vs-post-3rd-vaccine-per-cluster",
    "href": "Skin_scRNA_Part6.html#plot-updated-skin-sample-proportions-pre-vs-post-3rd-vaccine-per-cluster",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.8 Plot updated skin sample proportions, pre vs post 3rd vaccine, per cluster",
    "text": "6.8 Plot updated skin sample proportions, pre vs post 3rd vaccine, per cluster\n\nas.data.frame(table(merged.18279.skin.singlets$sub.cluster, merged.18279.skin.singlets$Sample)) %&gt;% \n  as_tibble() %&gt;%\n  dplyr::rename(\"Sample\" = Var2,\"Cluster\" = Var1) %&gt;%\n  separate(Sample, into=c(\"Patient\",\"Site\",\"Timepoint\",\"IpiCohort\",\"Assay\"),sep=\"_\",remove=F) %&gt;%\n  dplyr::filter(Timepoint==\"Pre3rd\" | Timepoint==\"Post3rd\") %&gt;%\n  group_by(Sample) %&gt;%\n  mutate(Proportion = Freq / sum(Freq)) %&gt;%\n  ggplot(aes(fill = Timepoint, x = fct_relevel(Timepoint,c(\"Pre3rd\",\"Post3rd\")), y=Proportion)) +\n  geom_boxplot(outlier.shape=NA) +\n  geom_point(pch = 21, position = position_jitterdodge(jitter.width=0.2)) +\n  facet_wrap(~Cluster,scales=\"free\") +\n  xlab(\"Timepoint\") +\n  scale_fill_discrete(breaks=c(\"Pre3rd\",\"Post3rd\"))",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#save-updated-object",
    "href": "Skin_scRNA_Part6.html#save-updated-object",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.9 Save updated object",
    "text": "6.9 Save updated object\n\nsaveRDS(merged.18279.skin.singlets, \"Skin_scRNA_Part6.rds\")",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part6.html#get-session-info",
    "href": "Skin_scRNA_Part6.html#get-session-info",
    "title": "6  Skin: Sub-clustering on T/NK lineage",
    "section": "6.10 Get session info",
    "text": "6.10 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] cellXY_0.99.0               scDblFinder_1.14.0         \n [3] harmony_1.2.0               alevinQC_1.16.1            \n [5] vctrs_0.6.5                 patchwork_1.3.0            \n [7] scater_1.30.1               scuttle_1.12.0             \n [9] speckle_1.0.0               Matrix_1.6-4               \n[11] fishpond_2.6.2              readxl_1.4.3               \n[13] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[15] Biobase_2.62.0              GenomicRanges_1.54.1       \n[17] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[19] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[21] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[23] flexmix_2.3-19              lattice_0.22-6             \n[25] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[27] lubridate_1.9.3             forcats_1.0.0              \n[29] stringr_1.5.1               dplyr_1.1.4                \n[31] purrr_1.0.2                 readr_2.1.5                \n[33] tidyr_1.3.1                 tibble_3.2.1               \n[35] ggplot2_3.5.1               tidyverse_2.0.0            \n[37] Seurat_5.1.0                SeuratObject_5.0.2         \n[39] sp_2.1-4                    sctransform_0.4.1          \n[41] glmGamPoi_1.12.2            presto_1.0.0               \n[43] Rcpp_1.0.13-1               devtools_2.4.5             \n[45] usethis_3.0.0               data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] labeling_0.4.3            spatstat.data_3.1-4      \n [23] ggridges_0.5.6            pbapply_1.7-2            \n [25] Rsamtools_2.18.0          R.utils_2.12.3           \n [27] parallelly_1.39.0         sessioninfo_1.2.2        \n [29] limma_3.58.1              RSQLite_2.3.8            \n [31] BiocIO_1.12.0             generics_0.1.3           \n [33] vroom_1.6.5               gtools_3.9.5             \n [35] ica_1.0-3                 spatstat.random_3.2-2    \n [37] ggbeeswarm_0.7.2          fansi_1.0.6              \n [39] abind_1.4-8               R.methodsS3_1.8.2        \n [41] lifecycle_1.0.4           yaml_2.3.10              \n [43] edgeR_4.0.16              SparseArray_1.2.2        \n [45] Rtsne_0.17                blob_1.2.4               \n [47] grid_4.3.2                dqrng_0.4.1              \n [49] promises_1.3.0            crayon_1.5.3             \n [51] shinydashboard_0.7.2      miniUI_0.1.1.1           \n [53] beachmat_2.18.1           cowplot_1.1.3            \n [55] KEGGREST_1.42.0           metapod_1.10.1           \n [57] pillar_1.9.0              knitr_1.45               \n [59] rjson_0.2.23              xgboost_1.7.8.1          \n [61] future.apply_1.11.3       codetools_0.2-20         \n [63] leiden_0.4.3.1            glue_1.8.0               \n [65] remotes_2.5.0             png_0.1-8                \n [67] spam_2.11-0               org.Mm.eg.db_3.18.0      \n [69] cellranger_1.1.0          gtable_0.3.6             \n [71] cachem_1.1.0              xfun_0.49                \n [73] S4Arrays_1.2.0            mime_0.12                \n [75] survival_3.7-0            bluster_1.12.0           \n [77] statmod_1.5.0             ellipsis_0.3.2           \n [79] fitdistrplus_1.2-1        ROCR_1.0-11              \n [81] nlme_3.1-166              bit64_4.5.2              \n [83] RcppAnnoy_0.0.22          irlba_2.3.5.1            \n [85] vipor_0.4.7               KernSmooth_2.23-24       \n [87] DBI_1.2.3                 colorspace_2.1-1         \n [89] nnet_7.3-19               ggrastr_1.0.2            \n [91] tidyselect_1.2.1          bit_4.5.0                \n [93] compiler_4.3.2            BiocNeighbors_1.20.2     \n [95] DelayedArray_0.28.0       plotly_4.10.4            \n [97] rtracklayer_1.62.0        scales_1.3.0             \n [99] lmtest_0.9-40             digest_0.6.37            \n[101] goftest_1.2-3             spatstat.utils_3.1-1     \n[103] rmarkdown_2.29            XVector_0.42.0           \n[105] htmltools_0.5.8.1         pkgconfig_2.0.3          \n[107] sparseMatrixStats_1.14.0  fastmap_1.2.0            \n[109] rlang_1.1.4               htmlwidgets_1.6.4        \n[111] shiny_1.9.1               DelayedMatrixStats_1.24.0\n[113] farver_2.1.2              zoo_1.8-12               \n[115] jsonlite_1.8.9            BiocParallel_1.36.0      \n[117] R.oo_1.27.0               BiocSingular_1.18.0      \n[119] RCurl_1.98-1.16           magrittr_2.0.3           \n[121] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[123] dotCall64_1.2             munsell_0.5.1            \n[125] viridis_0.6.5             reticulate_1.35.0        \n[127] stringi_1.8.4             zlibbioc_1.48.2          \n[129] MASS_7.3-60.0.1           org.Hs.eg.db_3.18.0      \n[131] plyr_1.8.9                pkgbuild_1.4.5           \n[133] ggstats_0.7.0             parallel_4.3.2           \n[135] listenv_0.9.1             ggrepel_0.9.6            \n[137] deldir_2.0-4              Biostrings_2.70.3        \n[139] splines_4.3.2             tensor_1.5               \n[141] hms_1.1.3                 locfit_1.5-9.10          \n[143] igraph_2.1.1              spatstat.geom_3.2-8      \n[145] RcppHNSW_0.6.0            reshape2_1.4.4           \n[147] ScaledMatrix_1.10.0       pkgload_1.4.0            \n[149] XML_3.99-0.17             evaluate_1.0.1           \n[151] scran_1.30.2              BiocManager_1.30.25      \n[153] tzdb_0.4.0                httpuv_1.6.15            \n[155] RANN_2.6.2                polyclip_1.10-7          \n[157] future_1.34.0             scattermore_1.2          \n[159] rsvd_1.0.5                xtable_1.8-4             \n[161] restfulr_0.0.15           svMisc_1.2.3             \n[163] RSpectra_0.16-2           later_1.3.2              \n[165] viridisLite_0.4.2         AnnotationDbi_1.64.1     \n[167] GenomicAlignments_1.38.2  memoise_2.0.1            \n[169] beeswarm_0.4.0            tximport_1.28.0          \n[171] cluster_2.1.6             timechange_0.3.0         \n[173] globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Skin: Sub-clustering on T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part7.html",
    "href": "Skin_scRNA_Part7.html",
    "title": "7  Skin: Assisting cell type annotation with enrichR",
    "section": "",
    "text": "7.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto) \nlibrary(glmGamPoi) \nlibrary(sctransform) \nlibrary(Seurat) \nlibrary(tidyverse)\nlibrary(miQC) \nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\nlibrary(enrichR)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Skin: Assisting cell type annotation with enrichR</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part7.html#load-sub-cluster-specific-marker-gene-table",
    "href": "Skin_scRNA_Part7.html#load-sub-cluster-specific-marker-gene-table",
    "title": "7  Skin: Assisting cell type annotation with enrichR",
    "section": "7.2 Load sub-cluster specific marker gene table",
    "text": "7.2 Load sub-cluster specific marker gene table\n\nmarkers &lt;- read_tsv(\"Skin_scRNA_prestoMarkers.tsv\")\n\nRows: 100 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (41): 0, 1_0, 1_1, 10, 11_0, 11_1, 12, 13_0, 13_1, 14, 15, 16, 17, 18, 1...\ndbl  (1): rank\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Skin: Assisting cell type annotation with enrichR</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part7.html#run-enrichr-to-estimate-cell-type-annotation",
    "href": "Skin_scRNA_Part7.html#run-enrichr-to-estimate-cell-type-annotation",
    "title": "7  Skin: Assisting cell type annotation with enrichR",
    "section": "7.3 Run enrichR to estimate cell type annotation",
    "text": "7.3 Run enrichR to estimate cell type annotation\n\ndbs &lt;- c(\"Tabula_Sapiens\",\"PanglaoDB_Augmented_2021\",\"Azimuth_Cell_Types_2021\",\"HuBMAP_ASCTplusB_augmented_2022\",\"Azimuth_2023\",\"CellMarker_2024\")\n\npredictions &lt;- NULL\n\nfor(i in colnames(markers)[-1]) {\n    m &lt;- pull(markers[,i])\n    res &lt;- enrichr(m, dbs)\n    \n    pred &lt;- res %&gt;% \n        map_dfr(~ .x %&gt;% as_tibble(), .id = \"name\") %&gt;%\n        group_by(name) %&gt;%\n        slice_min(Adjusted.P.value, n=1, with_ties = F) %&gt;%\n        dplyr::select(name,Term,Adjusted.P.value) %&gt;%\n        mutate(Term = str_replace_all(str_replace_all(Term,\"[ -]\",\"_\"),\"_+\",\"_\")) %&gt;%\n        add_column(sub.cluster = i, .before = 1)\n        \n    predictions &lt;- bind_rows(predictions, pred)     \n}\n\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\nUploading data to Enrichr... Done.\n  Querying Tabula_Sapiens... Done.\n  Querying PanglaoDB_Augmented_2021... Done.\n  Querying Azimuth_Cell_Types_2021... Done.\n  Querying HuBMAP_ASCTplusB_augmented_2022... Done.\n  Querying Azimuth_2023... Done.\n  Querying CellMarker_2024... Done.\nParsing results... Done.\n\nwrite_tsv(predictions,\"Skin_scRNA_CellID_enrichR.tsv\")",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Skin: Assisting cell type annotation with enrichR</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part7.html#get-session-info",
    "href": "Skin_scRNA_Part7.html#get-session-info",
    "title": "7  Skin: Assisting cell type annotation with enrichR",
    "section": "7.4 Get session info",
    "text": "7.4 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] enrichR_3.2                 cellXY_0.99.0              \n [3] scDblFinder_1.14.0          harmony_1.2.0              \n [5] alevinQC_1.16.1             vctrs_0.6.5                \n [7] patchwork_1.3.0             scater_1.30.1              \n [9] scuttle_1.12.0              speckle_1.0.0              \n[11] Matrix_1.6-4                fishpond_2.6.2             \n[13] readxl_1.4.3                SingleCellExperiment_1.24.0\n[15] SummarizedExperiment_1.32.0 Biobase_2.62.0             \n[17] GenomicRanges_1.54.1        GenomeInfoDb_1.38.8        \n[19] IRanges_2.36.0              S4Vectors_0.40.2           \n[21] BiocGenerics_0.48.1         MatrixGenerics_1.14.0      \n[23] matrixStats_1.4.1           flexmix_2.3-19             \n[25] lattice_0.22-6              SeuratWrappers_0.3.19      \n[27] miQC_1.8.0                  lubridate_1.9.3            \n[29] forcats_1.0.0               stringr_1.5.1              \n[31] dplyr_1.1.4                 purrr_1.0.2                \n[33] readr_2.1.5                 tidyr_1.3.1                \n[35] tibble_3.2.1                ggplot2_3.5.1              \n[37] tidyverse_2.0.0             Seurat_5.1.0               \n[39] SeuratObject_5.0.2          sp_2.1-4                   \n[41] sctransform_0.4.1           glmGamPoi_1.12.2           \n[43] presto_1.0.0                Rcpp_1.0.13-1              \n[45] devtools_2.4.5              usethis_3.0.0              \n[47] data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] spatstat.data_3.1-4       ggridges_0.5.6           \n [23] pbapply_1.7-2             Rsamtools_2.18.0         \n [25] R.utils_2.12.3            WriteXLS_6.7.0           \n [27] parallelly_1.39.0         sessioninfo_1.2.2        \n [29] limma_3.58.1              RSQLite_2.3.8            \n [31] BiocIO_1.12.0             generics_0.1.3           \n [33] vroom_1.6.5               gtools_3.9.5             \n [35] ica_1.0-3                 spatstat.random_3.2-2    \n [37] ggbeeswarm_0.7.2          fansi_1.0.6              \n [39] abind_1.4-8               R.methodsS3_1.8.2        \n [41] lifecycle_1.0.4           yaml_2.3.10              \n [43] edgeR_4.0.16              SparseArray_1.2.2        \n [45] Rtsne_0.17                blob_1.2.4               \n [47] grid_4.3.2                dqrng_0.4.1              \n [49] promises_1.3.0            crayon_1.5.3             \n [51] shinydashboard_0.7.2      miniUI_0.1.1.1           \n [53] beachmat_2.18.1           cowplot_1.1.3            \n [55] KEGGREST_1.42.0           metapod_1.10.1           \n [57] pillar_1.9.0              knitr_1.45               \n [59] rjson_0.2.23              xgboost_1.7.8.1          \n [61] future.apply_1.11.3       codetools_0.2-20         \n [63] leiden_0.4.3.1            glue_1.8.0               \n [65] remotes_2.5.0             png_0.1-8                \n [67] spam_2.11-0               org.Mm.eg.db_3.18.0      \n [69] cellranger_1.1.0          gtable_0.3.6             \n [71] cachem_1.1.0              xfun_0.49                \n [73] S4Arrays_1.2.0            mime_0.12                \n [75] survival_3.7-0            bluster_1.12.0           \n [77] statmod_1.5.0             ellipsis_0.3.2           \n [79] fitdistrplus_1.2-1        ROCR_1.0-11              \n [81] nlme_3.1-166              bit64_4.5.2              \n [83] RcppAnnoy_0.0.22          irlba_2.3.5.1            \n [85] vipor_0.4.7               KernSmooth_2.23-24       \n [87] DBI_1.2.3                 colorspace_2.1-1         \n [89] nnet_7.3-19               tidyselect_1.2.1         \n [91] curl_6.0.1                bit_4.5.0                \n [93] compiler_4.3.2            BiocNeighbors_1.20.2     \n [95] DelayedArray_0.28.0       plotly_4.10.4            \n [97] rtracklayer_1.62.0        scales_1.3.0             \n [99] lmtest_0.9-40             digest_0.6.37            \n[101] goftest_1.2-3             spatstat.utils_3.1-1     \n[103] rmarkdown_2.29            XVector_0.42.0           \n[105] htmltools_0.5.8.1         pkgconfig_2.0.3          \n[107] sparseMatrixStats_1.14.0  fastmap_1.2.0            \n[109] rlang_1.1.4               htmlwidgets_1.6.4        \n[111] shiny_1.9.1               DelayedMatrixStats_1.24.0\n[113] farver_2.1.2              zoo_1.8-12               \n[115] jsonlite_1.8.9            BiocParallel_1.36.0      \n[117] R.oo_1.27.0               BiocSingular_1.18.0      \n[119] RCurl_1.98-1.16           magrittr_2.0.3           \n[121] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[123] dotCall64_1.2             munsell_0.5.1            \n[125] viridis_0.6.5             reticulate_1.35.0        \n[127] stringi_1.8.4             zlibbioc_1.48.2          \n[129] MASS_7.3-60.0.1           org.Hs.eg.db_3.18.0      \n[131] plyr_1.8.9                pkgbuild_1.4.5           \n[133] ggstats_0.7.0             parallel_4.3.2           \n[135] listenv_0.9.1             ggrepel_0.9.6            \n[137] deldir_2.0-4              Biostrings_2.70.3        \n[139] splines_4.3.2             tensor_1.5               \n[141] hms_1.1.3                 locfit_1.5-9.10          \n[143] igraph_2.1.1              spatstat.geom_3.2-8      \n[145] RcppHNSW_0.6.0            reshape2_1.4.4           \n[147] ScaledMatrix_1.10.0       pkgload_1.4.0            \n[149] XML_3.99-0.17             evaluate_1.0.1           \n[151] scran_1.30.2              BiocManager_1.30.25      \n[153] tzdb_0.4.0                httpuv_1.6.15            \n[155] RANN_2.6.2                polyclip_1.10-7          \n[157] future_1.34.0             scattermore_1.2          \n[159] rsvd_1.0.5                xtable_1.8-4             \n[161] restfulr_0.0.15           svMisc_1.2.3             \n[163] RSpectra_0.16-2           later_1.3.2              \n[165] viridisLite_0.4.2         AnnotationDbi_1.64.1     \n[167] GenomicAlignments_1.38.2  memoise_2.0.1            \n[169] beeswarm_0.4.0            tximport_1.28.0          \n[171] cluster_2.1.6             timechange_0.3.0         \n[173] globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Skin: Assisting cell type annotation with enrichR</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part8.html",
    "href": "Skin_scRNA_Part8.html",
    "title": "8  Skin: Classification of CD4 and CD8 T cell states within T/NK lineage",
    "section": "",
    "text": "8.1 Set up Seurat workspace\n# Load libraries\nlibrary(data.table)\nlibrary(devtools)\nlibrary(presto) \nlibrary(glmGamPoi)\nlibrary(sctransform) \nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(miQC) \nlibrary(SeuratWrappers)\nlibrary(flexmix)\nlibrary(SingleCellExperiment)\nlibrary(SummarizedExperiment)\nlibrary(readxl)\nlibrary(fishpond)\nlibrary(Matrix)\nlibrary(speckle)\nlibrary(scater)\nlibrary(patchwork)\nlibrary(vctrs)\nlibrary(alevinQC)\nlibrary(harmony)\nlibrary(scDblFinder)\nlibrary(cellXY)\nlibrary(STACAS)\nlibrary(ProjecTILs)\n\n# Set global options for Seurat v5 objects\noptions(Seurat.object.assay.version = 'v5')",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Skin: Classification of CD4 and CD8 T cell states within T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part8.html#load-previously-saved-sub-clustered-object",
    "href": "Skin_scRNA_Part8.html#load-previously-saved-sub-clustered-object",
    "title": "8  Skin: Classification of CD4 and CD8 T cell states within T/NK lineage",
    "section": "8.2 Load previously saved sub-clustered object",
    "text": "8.2 Load previously saved sub-clustered object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part6.rds\")",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Skin: Classification of CD4 and CD8 T cell states within T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part8.html#run-cd8-and-cd4-projection-with-projectils-as-in-this-vignette",
    "href": "Skin_scRNA_Part8.html#run-cd8-and-cd4-projection-with-projectils-as-in-this-vignette",
    "title": "8  Skin: Classification of CD4 and CD8 T cell states within T/NK lineage",
    "section": "8.3 Run CD8 and CD4 projection with projecTILs as in this vignette",
    "text": "8.3 Run CD8 and CD4 projection with projecTILs as in this vignette\nNote these classifications are limited only to CD4/CD8 and do not include NK cells\n\n8.3.1 Retrieve human CD8 and CD4 reference maps\n\noptions(timeout = max(900, getOption(\"timeout\")))\ndownload.file(\"https://figshare.com/ndownloader/files/41414556\", destfile = \"CD8T_human_ref_v1.rds\")\ndownload.file(\"https://figshare.com/ndownloader/files/43794750\", destfile = \"CD4T_human_ref_v2.rds\")\n\n\n\n8.3.2 Load reference maps\n\nref.cd8 &lt;- load.reference.map(\"CD8T_human_ref_v1.rds\")\n\n[1] \"Loading Custom Reference Atlas...\"\n[1] \"Loaded Custom Reference map Human CD8 TILs\"\n\nref.cd4 &lt;- load.reference.map(\"CD4T_human_ref_v2.rds\")\n\n[1] \"Loading Custom Reference Atlas...\"\n[1] \"Loaded Custom Reference map custom_reference\"\n\n\n\n\n8.3.3 Plot reference atlases\n\na &lt;- DimPlot(ref.cd8, cols = ref.cd8@misc$atlas.palette, label = T) + theme(aspect.ratio = 1) +\n    ggtitle(\"CD8 T reference\") + NoLegend()\n\nb &lt;- DimPlot(ref.cd4, cols = ref.cd4@misc$atlas.palette, label = T) + theme(aspect.ratio = 1) +\n    ggtitle(\"CD4 T reference\") + NoLegend()\n\na | b\n\n\n\n\n\n\n\n\n\n\n8.3.4 Classify CD8 T subtypes\n\nmerged.18279.skin.singlets &lt;- ProjecTILs.classifier(merged.18279.skin.singlets, ref.cd8, ncores = 8, split.by = \"Sample\")\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"383 out of 437 ( 88% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1255 out of 1342 ( 94% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"339 out of 426 ( 80% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1501 out of 1718 ( 87% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"746 out of 822 ( 91% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1221 out of 1375 ( 89% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"974 out of 1191 ( 82% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1284 out of 1481 ( 87% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1517 out of 1655 ( 92% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"881 out of 937 ( 94% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2364 out of 2689 ( 88% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2661 out of 3429 ( 78% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2211 out of 2526 ( 88% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1008 out of 1121 ( 90% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"3609 out of 3726 ( 97% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"4680 out of 5434 ( 86% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2661 out of 3092 ( 86% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n\n8.3.5 Classify CD4 T subtypes\n\nmerged.18279.skin.singlets &lt;- ProjecTILs.classifier(merged.18279.skin.singlets, ref.cd4, ncores = 8, split.by = \"Sample\", overwrite = F)\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"361 out of 437 ( 83% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1139 out of 1342 ( 85% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"325 out of 426 ( 76% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1519 out of 1718 ( 88% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"484 out of 822 ( 59% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1103 out of 1375 ( 80% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"849 out of 1191 ( 71% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1101 out of 1481 ( 74% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1359 out of 1655 ( 82% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"731 out of 937 ( 78% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"1851 out of 2689 ( 69% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2488 out of 3429 ( 73% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2160 out of 2526 ( 86% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"819 out of 1121 ( 73% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"3265 out of 3726 ( 88% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"4574 out of 5434 ( 84% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%[1] \"Using assay RNA for query\"\n[1] \"2233 out of 3092 ( 72% ) non-pure cells removed. Use filter.cells=FALSE to avoid pre-filtering\"\nPerforming log-normalization\n0%   10   20   30   40   50   60   70   80   90   100%\n[----|----|----|----|----|----|----|----|----|----|\n**************************************************|\n[1] \"Aligning query to reference map for batch-correction...\"\n\nProjecting corrected query onto Reference PCA space\n\nProjecting corrected query onto Reference UMAP space\n\n  |                                                                            \n  |======================================================================| 100%",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Skin: Classification of CD4 and CD8 T cell states within T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part8.html#tabulate-and-visualize-projections",
    "href": "Skin_scRNA_Part8.html#tabulate-and-visualize-projections",
    "title": "8  Skin: Classification of CD4 and CD8 T cell states within T/NK lineage",
    "section": "8.4 Tabulate and visualize projections",
    "text": "8.4 Tabulate and visualize projections\nIn addition to guiding annotation, these projected cell states can be quantified downstream comparing pre vs post-vaccine, tumor samples over time, or to characterize the phenotypes of T-cells that have expanded with vaccination\n\n8.4.1 Count total cells by T cell state\n\ntable(merged.18279.skin.singlets$functional.cluster, useNA = \"ifany\")\n\n\nCD4.CTL_EOMES   CD4.CTL_Exh  CD4.CTL_GNLY    CD4.Memory CD4.NaiveLike \n         1126           165           540          1755          1462 \n      CD4.Tfh      CD4.Th17      CD4.Treg        CD8.CM        CD8.EM \n          568            81          1327          2325          1108 \n     CD8.MAIT CD8.NaiveLike     CD8.TEMRA       CD8.TEX      CD8.TPEX \n           44           233            78           247            55 \n         &lt;NA&gt; \n        22287 \n\n\n\n\n8.4.2 Tabulate which T cell state was most abundant in each subcluster\n\nas.data.frame(table(merged.18279.skin.singlets$sub.cluster, merged.18279.skin.singlets$functional.cluster, useNA = \"ifany\")) %&gt;%\n    as_tibble() %&gt;%\n    dplyr::rename(\"Cluster\" = Var1, \"CellState\" = Var2) %&gt;%\n    group_by(Cluster) %&gt;%\n    slice_max(Freq,n=1) %&gt;%\n    inner_join(enframe(table(merged.18279.skin.singlets$sub.cluster),name=\"Cluster\",value=\"TotalCount\"),by=\"Cluster\") %&gt;%\n    as.data.frame()\n\n   Cluster     CellState Freq TotalCount\n1        0          &lt;NA&gt; 5899       5899\n2      1_0 CD4.NaiveLike 1079       2584\n3      1_1 CD4.CTL_EOMES  469       1127\n4       10          &lt;NA&gt; 1145       1145\n5     11_0          &lt;NA&gt;  598        833\n6     11_1          &lt;NA&gt;   80        106\n7       12          &lt;NA&gt;  892        892\n8     13_0       CD8.TEX   65        315\n9     13_1          &lt;NA&gt;  249        258\n10      14          &lt;NA&gt;  560        560\n11      15          &lt;NA&gt;  514        515\n12      16          &lt;NA&gt;  405        406\n13      17          &lt;NA&gt;  361        361\n14      18          &lt;NA&gt;  306        306\n15    19_0          &lt;NA&gt;  166        166\n16    19_1          &lt;NA&gt;  132        132\n17     2_0        CD8.EM  833       1634\n18     2_1        CD8.CM  636        905\n19     2_2          &lt;NA&gt;  147        427\n20      20          &lt;NA&gt;  270        278\n21      21          &lt;NA&gt;  239        239\n22      22          &lt;NA&gt;  239        239\n23      23          &lt;NA&gt;  172        173\n24      24          &lt;NA&gt;  145        145\n25      25          &lt;NA&gt;   45         45\n26      26          &lt;NA&gt;   34         34\n27       3        CD8.CM  711       2364\n28     4_0          &lt;NA&gt;  961        961\n29     4_1          &lt;NA&gt;  907        907\n30     4_2          &lt;NA&gt;  469        469\n31     5_0          &lt;NA&gt; 1431       1474\n32     5_1          &lt;NA&gt;  556        557\n33     5_2          &lt;NA&gt;  164        166\n34     6_0    CD4.Memory  450       1163\n35     6_1    CD4.Memory  294        907\n36       7          &lt;NA&gt; 1757       1757\n37       8      CD4.Treg 1212       1594\n38     9_0          &lt;NA&gt;  544        544\n39     9_1          &lt;NA&gt;  372        372\n40     9_2          &lt;NA&gt;  358        358\n41     9_3          &lt;NA&gt;   84         84\n\n\n\n\n8.4.3 Plot UMAP of all cells labeled by projected T cell state\n\nDimPlot(merged.18279.skin.singlets, group.by = \"functional.cluster\", reduction=\"umap.harmony\")\n\n\n\n\n\n\n\n\n\n\n8.4.4 Plot just T/NK cell lineage\n\ntnk_clusters &lt;- sort(str_subset(unique(merged.18279.skin.singlets$sub.cluster),\"_\"))\ntnk_clusters\n\n [1] \"1_0\"  \"1_1\"  \"11_0\" \"11_1\" \"13_0\" \"13_1\" \"19_0\" \"19_1\" \"2_0\"  \"2_1\" \n[11] \"2_2\"  \"4_0\"  \"4_1\"  \"4_2\"  \"5_0\"  \"5_1\"  \"5_2\"  \"6_0\"  \"6_1\"  \"9_0\" \n[21] \"9_1\"  \"9_2\"  \"9_3\" \n\ntnk_cells &lt;- WhichCells(merged.18279.skin.singlets,idents = tnk_clusters)\nDimPlot(merged.18279.skin.singlets, \n    group.by = \"functional.cluster\", \n    reduction=\"umap.harmony\",\n    cells = tnk_cells)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Skin: Classification of CD4 and CD8 T cell states within T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part8.html#save-modified-object",
    "href": "Skin_scRNA_Part8.html#save-modified-object",
    "title": "8  Skin: Classification of CD4 and CD8 T cell states within T/NK lineage",
    "section": "8.5 Save modified object",
    "text": "8.5 Save modified object\n\nsaveRDS(merged.18279.skin.singlets, \"Skin_scRNA_Part8.rds\")",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Skin: Classification of CD4 and CD8 T cell states within T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part8.html#get-session-info",
    "href": "Skin_scRNA_Part8.html#get-session-info",
    "title": "8  Skin: Classification of CD4 and CD8 T cell states within T/NK lineage",
    "section": "8.6 Get session info",
    "text": "8.6 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ProjecTILs_3.3.1            STACAS_2.2.2               \n [3] cellXY_0.99.0               scDblFinder_1.14.0         \n [5] harmony_1.2.0               alevinQC_1.16.1            \n [7] vctrs_0.6.5                 patchwork_1.3.0            \n [9] scater_1.30.1               scuttle_1.12.0             \n[11] speckle_1.0.0               Matrix_1.6-4               \n[13] fishpond_2.6.2              readxl_1.4.3               \n[15] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[17] Biobase_2.62.0              GenomicRanges_1.54.1       \n[19] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[21] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[23] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[25] flexmix_2.3-19              lattice_0.22-6             \n[27] SeuratWrappers_0.3.19       miQC_1.8.0                 \n[29] lubridate_1.9.3             forcats_1.0.0              \n[31] stringr_1.5.1               dplyr_1.1.4                \n[33] purrr_1.0.2                 readr_2.1.5                \n[35] tidyr_1.3.1                 tibble_3.2.1               \n[37] ggplot2_3.5.1               tidyverse_2.0.0            \n[39] Seurat_5.1.0                SeuratObject_5.0.2         \n[41] sp_2.1-4                    sctransform_0.4.1          \n[43] glmGamPoi_1.12.2            presto_1.0.0               \n[45] Rcpp_1.0.13-1               devtools_2.4.5             \n[47] usethis_3.0.0               data.table_1.16.2          \n\nloaded via a namespace (and not attached):\n  [1] fs_1.6.5                  spatstat.sparse_3.1-0    \n  [3] bitops_1.0-9              httr_1.4.7               \n  [5] RColorBrewer_1.1-3        profvis_0.4.0            \n  [7] tools_4.3.2               utf8_1.2.4               \n  [9] R6_2.5.1                  DT_0.33                  \n [11] lazyeval_0.2.2            uwot_0.2.2               \n [13] urlchecker_1.0.1          withr_3.0.2              \n [15] GGally_2.2.1              gridExtra_2.3            \n [17] progressr_0.15.1          cli_3.6.3                \n [19] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [21] labeling_0.4.3            spatstat.data_3.1-4      \n [23] askpass_1.2.0             ggridges_0.5.6           \n [25] pbapply_1.7-2             Rsamtools_2.18.0         \n [27] R.utils_2.12.3            parallelly_1.39.0        \n [29] sessioninfo_1.2.2         limma_3.58.1             \n [31] RSQLite_2.3.8             BiocIO_1.12.0            \n [33] generics_0.1.3            gtools_3.9.5             \n [35] ica_1.0-3                 spatstat.random_3.2-2    \n [37] ggbeeswarm_0.7.2          fansi_1.0.6              \n [39] abind_1.4-8               R.methodsS3_1.8.2        \n [41] lifecycle_1.0.4           yaml_2.3.10              \n [43] edgeR_4.0.16              SparseArray_1.2.2        \n [45] Rtsne_0.17                blob_1.2.4               \n [47] grid_4.3.2                dqrng_0.4.1              \n [49] promises_1.3.0            crayon_1.5.3             \n [51] shinydashboard_0.7.2      miniUI_0.1.1.1           \n [53] beachmat_2.18.1           cowplot_1.1.3            \n [55] KEGGREST_1.42.0           scGate_1.6.0             \n [57] metapod_1.10.1            pillar_1.9.0             \n [59] knitr_1.45                rjson_0.2.23             \n [61] xgboost_1.7.8.1           future.apply_1.11.3      \n [63] codetools_0.2-20          leiden_0.4.3.1           \n [65] glue_1.8.0                remotes_2.5.0            \n [67] png_0.1-8                 spam_2.11-0              \n [69] org.Mm.eg.db_3.18.0       cellranger_1.1.0         \n [71] gtable_0.3.6              cachem_1.1.0             \n [73] xfun_0.49                 S4Arrays_1.2.0           \n [75] mime_0.12                 pracma_2.4.4             \n [77] survival_3.7-0            pheatmap_1.0.12          \n [79] bluster_1.12.0            statmod_1.5.0            \n [81] ellipsis_0.3.2            fitdistrplus_1.2-1       \n [83] ROCR_1.0-11               nlme_3.1-166             \n [85] bit64_4.5.2               RcppAnnoy_0.0.22         \n [87] irlba_2.3.5.1             vipor_0.4.7              \n [89] KernSmooth_2.23-24        DBI_1.2.3                \n [91] colorspace_2.1-1          nnet_7.3-19              \n [93] UCell_2.6.2               tidyselect_1.2.1         \n [95] bit_4.5.0                 compiler_4.3.2           \n [97] BiocNeighbors_1.20.2      DelayedArray_0.28.0      \n [99] plotly_4.10.4             rtracklayer_1.62.0       \n[101] scales_1.3.0              lmtest_0.9-40            \n[103] digest_0.6.37             goftest_1.2-3            \n[105] spatstat.utils_3.1-1      rmarkdown_2.29           \n[107] XVector_0.42.0            htmltools_0.5.8.1        \n[109] pkgconfig_2.0.3           umap_0.2.10.0            \n[111] sparseMatrixStats_1.14.0  fastmap_1.2.0            \n[113] rlang_1.1.4               htmlwidgets_1.6.4        \n[115] shiny_1.9.1               DelayedMatrixStats_1.24.0\n[117] farver_2.1.2              zoo_1.8-12               \n[119] jsonlite_1.8.9            BiocParallel_1.36.0      \n[121] R.oo_1.27.0               BiocSingular_1.18.0      \n[123] RCurl_1.98-1.16           magrittr_2.0.3           \n[125] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[127] dotCall64_1.2             munsell_0.5.1            \n[129] viridis_0.6.5             reticulate_1.35.0        \n[131] stringi_1.8.4             zlibbioc_1.48.2          \n[133] MASS_7.3-60.0.1           org.Hs.eg.db_3.18.0      \n[135] plyr_1.8.9                pkgbuild_1.4.5           \n[137] ggstats_0.7.0             parallel_4.3.2           \n[139] listenv_0.9.1             ggrepel_0.9.6            \n[141] deldir_2.0-4              Biostrings_2.70.3        \n[143] splines_4.3.2             tensor_1.5               \n[145] hms_1.1.3                 locfit_1.5-9.10          \n[147] igraph_2.1.1              spatstat.geom_3.2-8      \n[149] RcppHNSW_0.6.0            reshape2_1.4.4           \n[151] ScaledMatrix_1.10.0       pkgload_1.4.0            \n[153] XML_3.99-0.17             evaluate_1.0.1           \n[155] scran_1.30.2              BiocManager_1.30.25      \n[157] tzdb_0.4.0                httpuv_1.6.15            \n[159] openssl_2.2.2             RANN_2.6.2               \n[161] polyclip_1.10-7           future_1.34.0            \n[163] scattermore_1.2           rsvd_1.0.5               \n[165] xtable_1.8-4              restfulr_0.0.15          \n[167] svMisc_1.2.3              RSpectra_0.16-2          \n[169] later_1.3.2               viridisLite_0.4.2        \n[171] AnnotationDbi_1.64.1      GenomicAlignments_1.38.2 \n[173] memoise_2.0.1             beeswarm_0.4.0           \n[175] tximport_1.28.0           cluster_2.1.6            \n[177] timechange_0.3.0          globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Skin: Classification of CD4 and CD8 T cell states within T/NK lineage</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part9.html",
    "href": "Skin_scRNA_Part9.html",
    "title": "9  Skin: Differential expression analysis, Post vs Pre 3rd vaccination",
    "section": "",
    "text": "9.1 Set up Seurat workspace\n# Load libraries\nlibrary(presto)\nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(paletteer)\nlibrary(msigdbr)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(muscat)\nlibrary(edgeR)\nlibrary(SingleCellExperiment)\nlibrary(DESeq2)\nlibrary(scuttle)\nlibrary(gprofiler2)\nlibrary(msigdbr)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Skin: Differential expression analysis, Post vs Pre 3rd vaccination</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part9.html#load-previous-seurat-object",
    "href": "Skin_scRNA_Part9.html#load-previous-seurat-object",
    "title": "9  Skin: Differential expression analysis, Post vs Pre 3rd vaccination",
    "section": "9.2 Load previous seurat object",
    "text": "9.2 Load previous seurat object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part8.rds\")",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Skin: Differential expression analysis, Post vs Pre 3rd vaccination</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part9.html#run-pseudobulk-differential-expression-test-with-muscat",
    "href": "Skin_scRNA_Part9.html#run-pseudobulk-differential-expression-test-with-muscat",
    "title": "9  Skin: Differential expression analysis, Post vs Pre 3rd vaccination",
    "section": "9.3 Run pseudobulk differential expression test with muscat",
    "text": "9.3 Run pseudobulk differential expression test with muscat\n\n9.3.1 Convert Seurat object to SingleCellExperiment\n\nmerged.18279.skin.singlets[['RNA']] &lt;- JoinLayers(merged.18279.skin.singlets[['RNA']])\nmerged.sce &lt;- as.SingleCellExperiment(merged.18279.skin.singlets, assay=\"RNA\")\n\n\n\n9.3.2 Prep coldata and create pseudobulk of raw counts by sub-cluster x sample\n\n(mergedCondition.sce &lt;- prepSCE(merged.sce,\n    kid = \"sub.cluster\",\n    gid = \"Timepoint\",\n    sid = \"Sample\",\n    drop=TRUE))\n\nclass: SingleCellExperiment \ndim: 61217 33401 \nmetadata(1): experiment_info\nassays(2): counts logcounts\nrownames(61217): 5-8S-rRNA 5S-rRNA ... ZZEF1 ZZZ3\nrowData names(0):\ncolnames(33401): P101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT\n  P101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT ...\n  P111_Skin_Post3rd_5mgIpi_RNA_ACGATGTTCCTAGGGC\n  P111_Skin_Post3rd_5mgIpi_RNA_GAACATCAGCCACGTC\ncolData names(3): cluster_id sample_id group_id\nreducedDimNames(4): PCA UMAP.UNINTEGRATED INTEGRATED.HARMONY\n  UMAP.HARMONY\nmainExpName: RNA\naltExpNames(0):\n\npb &lt;- aggregateData(mergedCondition.sce,\n    assay = \"counts\",fun=\"sum\",\n    by = c(\"cluster_id\", \"sample_id\"))\n\n\n\n9.3.3 Construct design & contrast matrix to compare Post3rd to Pre3rd timepoints\n\nei &lt;- metadata(mergedCondition.sce)$experiment_info\nmm &lt;- model.matrix(~0 + ei$group_id)\ndim_name &lt;- levels(ei$group_id)\ndimnames(mm) &lt;- list(ei$sample_id, dim_name)\ncontrast &lt;- makeContrasts(\"Post3rd-Pre3rd\", levels = mm)\n\n\n\n9.3.4 Run differential expression test via DESeq2\n\nres &lt;- pbDS(pb, \n            design = mm, \n            contrast = contrast, \n            method=\"DESeq2\", \n            min_cells = 20,\n            verbose = FALSE)\n\n# Combine results from all clusters into one tibble\ndf &lt;- bind_rows(res$table$`Post3rd-Pre3rd`, .id = \"sub.cluster\") %&gt;% \n    as_tibble()\n\n\n\n9.3.5 Show snippet of results from one cluster: upregulated genes in cluster 7\n\ndf %&gt;% \n    dplyr::filter(p_adj.loc &lt; 0.05 & sub.cluster==\"7\" & logFC &gt; 0) %&gt;% \n    dplyr::arrange(p_adj.loc) %&gt;% \n    print(n=30)\n\n# A tibble: 956 × 11\n   sub.cluster gene     cluster_id baseMean logFC lfcSE  stat    p_val p_adj.loc\n   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 7           APOBEC3A 7             764.   4.35 0.424 10.3  1.06e-24  8.44e-21\n 2 7           ISG15    7            1455.   4.48 0.442 10.1  4.01e-24  1.60e-20\n 3 7           IFI6     7             663.   4.10 0.412  9.94 2.71e-23  7.21e-20\n 4 7           MX1      7             373.   3.97 0.438  9.07 1.23e-19  2.46e-16\n 5 7           OAS2     7              79.6  3.37 0.375  8.97 3.02e-19  4.82e-16\n 6 7           IRF7     7             319.   2.52 0.283  8.91 5.14e-19  6.83e-16\n 7 7           OAS1     7             135.   3.78 0.430  8.79 1.53e-18  1.57e-15\n 8 7           IFI35    7             167.   3.07 0.351  8.75 2.13e-18  1.89e-15\n 9 7           LY6E     7             831.   2.95 0.341  8.64 5.47e-18  4.36e-15\n10 7           OAS3     7              66.5  3.26 0.387  8.41 3.99e-17  2.89e-14\n11 7           IL15RA   7              35.5  2.78 0.339  8.21 2.13e-16  1.13e-13\n12 7           PSME2    7             786.   1.65 0.207  7.96 1.74e-15  6.60e-13\n13 7           IFIT3    7              92.2  6.33 0.804  7.87 3.46e-15  1.20e-12\n14 7           XAF1     7             128.   2.80 0.358  7.83 5.05e-15  1.61e-12\n15 7           SAMD9    7              58.6  3.22 0.415  7.76 8.73e-15  2.58e-12\n16 7           PML      7             110.   1.86 0.242  7.71 1.30e-14  3.71e-12\n17 7           UBE2L6   7             252.   2.18 0.283  7.70 1.37e-14  3.77e-12\n18 7           EPSTI1   7             294.   2.72 0.354  7.69 1.46e-14  3.90e-12\n19 7           LGALS9   7             355.   1.65 0.216  7.67 1.70e-14  4.24e-12\n20 7           TNFSF10  7             308.   3.25 0.427  7.61 2.68e-14  6.29e-12\n21 7           SERPING1 7             323.   2.75 0.361  7.61 2.76e-14  6.31e-12\n22 7           OPTN     7              50.1  2.58 0.341  7.57 3.81e-14  8.45e-12\n23 7           IFITM1   7            1509.   4.47 0.592  7.55 4.20e-14  9.07e-12\n24 7           LYSMD2   7              81.6  1.87 0.251  7.45 9.46e-14  1.99e-11\n25 7           SP110    7             142.   1.99 0.268  7.42 1.17e-13  2.36e-11\n26 7           TYMP     7            1473.   2.10 0.283  7.42 1.18e-13  2.36e-11\n27 7           ENSG000… 7              25.6  3.19 0.433  7.38 1.64e-13  3.19e-11\n28 7           IFITM3   7            3421.   2.25 0.306  7.35 2.00e-13  3.79e-11\n29 7           NMI      7              80.3  2.27 0.309  7.34 2.09e-13  3.88e-11\n30 7           DDX60    7              21.5  2.42 0.330  7.33 2.38e-13  4.32e-11\n# ℹ 926 more rows\n# ℹ 2 more variables: p_adj.glb &lt;dbl&gt;, contrast &lt;chr&gt;\n\n\n\n\n9.3.6 Write differential expression results to tsv\n\nwrite_tsv(df, \"Skin_scRNA_PostVsPre3rd_DiffExp_results.tsv\")\n\n\n\n9.3.7 Plot number of significant genes for all clusters\n\nall_subclusts &lt;- enframe(unique(merged.18279.skin.singlets$sub.cluster),name=NULL,value=\"sub.cluster\")\ndf %&gt;%\n  dplyr::filter(p_adj.loc &lt; 0.05) %&gt;%\n  group_by(sub.cluster) %&gt;%\n  summarize(Up = count(logFC &gt; 0),Down = (-1 * count(logFC &lt; 0)),Total = (count(logFC &gt; 0) + count(logFC &lt; 0))) %&gt;%\n  left_join(all_subclusts, ., by=\"sub.cluster\") %&gt;%\n  mutate(Up = replace_na(Up, 0), Down = replace_na(Down, 0), Total = replace_na(Total, 0)) %&gt;%\n  pivot_longer(cols = c(Up,Down), names_to=\"Direction\", values_to=\"NumberDE\") %&gt;%\n  ggplot(aes(x = reorder(sub.cluster,-Total), y = NumberDE, fill = Direction)) +\n  geom_col() +\n  theme_bw() +\n  xlab(\"Sub-cluster\") +\n  ylab(\"Number of Differentially Expressed Genes\\np_adj.loc &lt; 0.05\") +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Skin: Differential expression analysis, Post vs Pre 3rd vaccination</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part9.html#get-session-info",
    "href": "Skin_scRNA_Part9.html#get-session-info",
    "title": "9  Skin: Differential expression analysis, Post vs Pre 3rd vaccination",
    "section": "9.4 Get session info",
    "text": "9.4 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    grid      stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] gprofiler2_0.2.2            scuttle_1.12.0             \n [3] DESeq2_1.42.1               SingleCellExperiment_1.24.0\n [5] SummarizedExperiment_1.32.0 Biobase_2.62.0             \n [7] GenomicRanges_1.54.1        GenomeInfoDb_1.38.8        \n [9] IRanges_2.36.0              S4Vectors_0.40.2           \n[11] BiocGenerics_0.48.1         MatrixGenerics_1.14.0      \n[13] matrixStats_1.4.1           edgeR_4.0.16               \n[15] limma_3.58.1                muscat_1.14.0              \n[17] circlize_0.4.16             ComplexHeatmap_2.18.0      \n[19] msigdbr_7.5.1               paletteer_1.6.0            \n[21] patchwork_1.3.0             lubridate_1.9.3            \n[23] forcats_1.0.0               stringr_1.5.1              \n[25] dplyr_1.1.4                 purrr_1.0.2                \n[27] readr_2.1.5                 tidyr_1.3.1                \n[29] tibble_3.2.1                ggplot2_3.5.1              \n[31] tidyverse_2.0.0             Seurat_5.1.0               \n[33] SeuratObject_5.0.2          sp_2.1-4                   \n[35] presto_1.0.0                data.table_1.16.2          \n[37] Rcpp_1.0.13-1              \n\nloaded via a namespace (and not attached):\n  [1] spatstat.sparse_3.1-0     bitops_1.0-9             \n  [3] httr_1.4.7                RColorBrewer_1.1-3       \n  [5] doParallel_1.0.17         numDeriv_2016.8-1.1      \n  [7] backports_1.5.0           tools_4.3.2              \n  [9] sctransform_0.4.1         utf8_1.2.4               \n [11] R6_2.5.1                  lazyeval_0.2.2           \n [13] uwot_0.2.2                mgcv_1.9-1               \n [15] GetoptLong_1.0.5          withr_3.0.2              \n [17] prettyunits_1.2.0         gridExtra_2.3            \n [19] SeuratWrappers_0.3.19     progressr_0.15.1         \n [21] cli_3.6.3                 spatstat.explore_3.2-6   \n [23] fastDummies_1.7.3         sandwich_3.1-1           \n [25] labeling_0.4.3            mvtnorm_1.3-2            \n [27] spatstat.data_3.1-4       blme_1.0-5               \n [29] ggridges_0.5.6            pbapply_1.7-2            \n [31] R.utils_2.12.3            scater_1.30.1            \n [33] parallelly_1.39.0         generics_0.1.3           \n [35] shape_1.4.6.1             vroom_1.6.5              \n [37] gtools_3.9.5              ica_1.0-3                \n [39] spatstat.random_3.2-2     Matrix_1.6-4             \n [41] ggbeeswarm_0.7.2          fansi_1.0.6              \n [43] abind_1.4-8               R.methodsS3_1.8.2        \n [45] lifecycle_1.0.4           multcomp_1.4-26          \n [47] yaml_2.3.10               gplots_3.2.0             \n [49] SparseArray_1.2.2         Rtsne_0.17               \n [51] promises_1.3.0            crayon_1.5.3             \n [53] miniUI_0.1.1.1            lattice_0.22-6           \n [55] beachmat_2.18.1           cowplot_1.1.3            \n [57] pillar_1.9.0              knitr_1.45               \n [59] rjson_0.2.23              boot_1.3-31              \n [61] estimability_1.5.1        future.apply_1.11.3      \n [63] codetools_0.2-20          leiden_0.4.3.1           \n [65] glue_1.8.0                remotes_2.5.0            \n [67] vctrs_0.6.5               png_0.1-8                \n [69] spam_2.11-0               Rdpack_2.6.2             \n [71] gtable_0.3.6              rematch2_2.1.2           \n [73] xfun_0.49                 rbibutils_2.3            \n [75] S4Arrays_1.2.0            mime_0.12                \n [77] coda_0.19-4.1             reformulas_0.4.0         \n [79] survival_3.7-0            iterators_1.0.14         \n [81] statmod_1.5.0             fitdistrplus_1.2-1       \n [83] TH.data_1.1-2             ROCR_1.0-11              \n [85] nlme_3.1-166              pbkrtest_0.5.3           \n [87] bit64_4.5.2               EnvStats_2.8.1           \n [89] progress_1.2.3            RcppAnnoy_0.0.22         \n [91] TMB_1.9.15                irlba_2.3.5.1            \n [93] vipor_0.4.7               KernSmooth_2.23-24       \n [95] colorspace_2.1-1          nnet_7.3-19              \n [97] tidyselect_1.2.1          emmeans_1.10.5           \n [99] bit_4.5.0                 compiler_4.3.2           \n[101] BiocNeighbors_1.20.2      DelayedArray_0.28.0      \n[103] plotly_4.10.4             caTools_1.18.3           \n[105] scales_1.3.0              remaCor_0.0.18           \n[107] lmtest_0.9-40             digest_0.6.37            \n[109] goftest_1.2-3             spatstat.utils_3.1-1     \n[111] minqa_1.2.8               variancePartition_1.30.2 \n[113] rmarkdown_2.29            aod_1.3.3                \n[115] RhpcBLASctl_0.23-42       XVector_0.42.0           \n[117] htmltools_0.5.8.1         pkgconfig_2.0.3          \n[119] lme4_1.1-35.5             sparseMatrixStats_1.14.0 \n[121] fastmap_1.2.0             rlang_1.1.4              \n[123] GlobalOptions_0.1.2       htmlwidgets_1.6.4        \n[125] shiny_1.9.1               DelayedMatrixStats_1.24.0\n[127] farver_2.1.2              zoo_1.8-12               \n[129] jsonlite_1.8.9            BiocParallel_1.36.0      \n[131] R.oo_1.27.0               BiocSingular_1.18.0      \n[133] RCurl_1.98-1.16           magrittr_2.0.3           \n[135] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[137] dotCall64_1.2             munsell_0.5.1            \n[139] viridis_0.6.5             babelgene_22.9           \n[141] reticulate_1.35.0         stringi_1.8.4            \n[143] zlibbioc_1.48.2           MASS_7.3-60.0.1          \n[145] flexmix_2.3-19            plyr_1.8.9               \n[147] parallel_4.3.2            listenv_0.9.1            \n[149] ggrepel_0.9.6             deldir_2.0-4             \n[151] splines_4.3.2             tensor_1.5               \n[153] hms_1.1.3                 locfit_1.5-9.10          \n[155] igraph_2.1.1              spatstat.geom_3.2-8      \n[157] RcppHNSW_0.6.0            ScaledMatrix_1.10.0      \n[159] reshape2_1.4.4            evaluate_1.0.1           \n[161] BiocManager_1.30.25       nloptr_2.0.3             \n[163] tzdb_0.4.0                foreach_1.5.2            \n[165] httpuv_1.6.15             RANN_2.6.2               \n[167] polyclip_1.10-7           future_1.34.0            \n[169] clue_0.3-66               scattermore_1.2          \n[171] rsvd_1.0.5                broom_1.0.7              \n[173] xtable_1.8-4              RSpectra_0.16-2          \n[175] later_1.3.2               viridisLite_0.4.2        \n[177] lmerTest_3.1-3            glmmTMB_1.1.10           \n[179] beeswarm_0.4.0            cluster_2.1.6            \n[181] timechange_0.3.0          globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Skin: Differential expression analysis, Post vs Pre 3rd vaccination</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html",
    "href": "Skin_scRNA_Part10.html",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "",
    "text": "10.1 Set up Seurat workspace\n# Load libraries\nlibrary(presto)\nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(paletteer)\nlibrary(msigdbr)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(SingleCellExperiment)\nlibrary(muscat)\nlibrary(limma)\nlibrary(scuttle)\nlibrary(lemon)\nlibrary(ggforce)\nlibrary(cowplot)\nlibrary(speckle)\nlibrary(knitr)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#load-previous-saved-object",
    "href": "Skin_scRNA_Part10.html#load-previous-saved-object",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.2 Load previous saved object",
    "text": "10.2 Load previous saved object\n\nmerged.18279.skin.singlets &lt;- readRDS(\"Skin_scRNA_Part8.rds\")",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#set-up-cluster-groupings-by-cell-class",
    "href": "Skin_scRNA_Part10.html#set-up-cluster-groupings-by-cell-class",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.3 Set up cluster groupings by cell class",
    "text": "10.3 Set up cluster groupings by cell class\n\ncluster_annot &lt;- c(\n        \"0\" = \"MonoMac_1\",\n        \"1_0\" = \"CD4_T_Naive/CM\",\n        \"1_1\" = \"CD4_T_CTL\",\n        \"2_0\" = \"CD8_T_EM_1\",\n        \"2_1\" = \"CD8_T_Naive/CM_1\",\n        \"2_2\" = \"CD8_T_EM_2\",\n        \"3\" = \"MonoMac_2\",\n        \"4_0\" = \"CD8_T_Naive/CM_2\",\n        \"4_1\" = \"CD8_T_Naive/CM_3\",\n        \"5_0\" = \"NK/T_1\",\n        \"5_1\" = \"NK/T_2\",\n        \"5_2\" = \"NK_cells\",\n        \"6_0\" = \"T_unknown_1\",\n        \"6_1\" = \"CD8_T_EM_3\",\n        \"7\" = \"cDC2\",\n        \"8\" = \"Keratinocytes\",\n        \"9_0\" = \"Treg_1\",\n        \"9_1\" = \"Treg_2\",\n        \"10\" = \"Fibroblasts\",\n        \"11_0\" = \"T_unknown_2\",\n        \"11_1\" = \"T_unknown_3\",\n        \"12\" = \"MonoMac_3\",\n        \"13_0\" = \"Proliferating_T_cells_1\",\n        \"13_1\" = \"Proliferating_T_cells_2\",\n        \"14\" = \"pDC\",\n        \"15\" = \"DC_LAMP3\",\n        \"16\" = \"Mast\",\n        \"17\" = \"Endothelial\",\n        \"18\" = \"cDC1\",\n        \"19_0\" = \"NK/T_3\",\n        \"20\" = \"Pericytes/smooth_muscle\",\n        \"21\" = \"Basal_1\",\n        \"22\" = \"MonoMac_4\",\n        \"23\" = \"B_cells\",\n        \"24\" = \"Basal_2\",\n        \"25\" = \"Macrophages\",\n        \"26\" = \"Proliferating_cDC2\"\n)\nclustLabels &lt;- as.data.frame(cluster_annot)[merged.18279.skin.singlets$sub.cluster,]\nmerged.18279.skin.singlets &lt;- AddMetaData(merged.18279.skin.singlets, list(clustLabels), col.name = \"CellAnnotation\")",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#set-up-broader-cell-classes",
    "href": "Skin_scRNA_Part10.html#set-up-broader-cell-classes",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.4 Set up broader cell classes",
    "text": "10.4 Set up broader cell classes\n\ncluster_classes &lt;- enframe(cluster_annot,name = \"sub.cluster\",value = \"CellAnnotation\") %&gt;%\n  as_tibble() %&gt;%\n  mutate(CellClass = case_when(\n    sub.cluster %in% c(\"0\",\"3\",\"12\",\"22\",\"25\") ~ \"Monocyte/\\nMacrophage\",\n    sub.cluster %in% c(\"14\",\"18\",\"7\",\"26\",\"15\") ~ \"DC\",\n    sub.cluster %in% c(\"23\") ~ \"B\",\n    sub.cluster %in% c(\"5_2\",\"5_0\",\"5_1\",\"19_0\",\"2_1\",\"4_0\",\"4_1\",\"2_0\",\"2_2\",\"6_1\",\"1_0\",\"1_1\",\"9_0\",\"9_1\",\"13_0\",\"13_1\",\"6_0\",\"11_0\",\"11_1\") ~ \"NK/T\",\n    sub.cluster %in% c(\"16\") ~ \"Mast\",\n    sub.cluster %in% c(\"8\",\"10\",\"17\",\"20\",\"21\",\"24\") ~ \"Non-immune\"\n    )\n  ) %&gt;%\n  dplyr::select(-CellAnnotation) %&gt;%\n  column_to_rownames(var = \"sub.cluster\") %&gt;%\n  as.data.frame()\n\nclustClasses &lt;- cluster_classes[merged.18279.skin.singlets$sub.cluster,]\nmerged.18279.skin.singlets &lt;- AddMetaData(merged.18279.skin.singlets, list(clustClasses), col.name = \"CellClass\")",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-original-umap-labeled-by-sub-cluster",
    "href": "Skin_scRNA_Part10.html#plot-original-umap-labeled-by-sub-cluster",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.5 Plot original UMAP labeled by sub-cluster",
    "text": "10.5 Plot original UMAP labeled by sub-cluster\n\nmerged.18279.skin.singlets$CellAnnotation &lt;- factor(x = merged.18279.skin.singlets$CellAnnotation, \n                                                    levels = as.character(cluster_annot))\nDimPlot(merged.18279.skin.singlets, \n        label = FALSE, \n        reduction = \"umap.harmony\",\n        group.by = \"CellAnnotation\")\n\n\n\n\n\n\n\n\n\n10.5.1 Plot again split by Timepoint\n\nmerged.18279.skin.singlets$CellAnnotation &lt;- factor(x = merged.18279.skin.singlets$CellAnnotation, \n                                                    levels = as.character(cluster_annot))\nmerged.18279.skin.singlets$Timepoint &lt;- factor(x = merged.18279.skin.singlets$Timepoint, levels = c(\"Pre3rd\", \"Post3rd\"))\n\nDimPlot(merged.18279.skin.singlets, \n        label = FALSE, \n        reduction = \"umap.harmony\",\n        group.by = \"CellAnnotation\",\n        split.by = \"Timepoint\")",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-original-umap-labeled-by-broader-cell-class",
    "href": "Skin_scRNA_Part10.html#plot-original-umap-labeled-by-broader-cell-class",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.6 Plot original UMAP labeled by broader cell class",
    "text": "10.6 Plot original UMAP labeled by broader cell class\n\nDimPlot(merged.18279.skin.singlets, \n        label = FALSE, \n        reduction = \"umap.harmony\",\n        group.by = \"CellClass\")\n\n\n\n\n\n\n\n\n\n10.6.1 Plot again except split by Timepoint\n\nDimPlot(merged.18279.skin.singlets, \n        label = FALSE, \n        reduction = \"umap.harmony\",\n        split.by = \"Timepoint\",\n        group.by = \"CellClass\") +\n  theme_classic() +\n  theme(panel.border = element_rect(colour = \"black\",fill = NA)\n        )",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#now-plot-all-cluster-annotations-using-only-ggplot-functions-useful-later",
    "href": "Skin_scRNA_Part10.html#now-plot-all-cluster-annotations-using-only-ggplot-functions-useful-later",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.7 Now plot all cluster annotations using only ggplot functions, useful later",
    "text": "10.7 Now plot all cluster annotations using only ggplot functions, useful later\n\numap &lt;- rownames_to_column(as.data.frame(Embeddings(merged.18279.skin.singlets,reduction = \"umap.harmony\")),var=\"Barcode\") %&gt;%\n  as_tibble() %&gt;%\n  left_join(enframe(merged.18279.skin.singlets$sub.cluster,name = \"Barcode\",value=\"sub.cluster\"),by=\"Barcode\") %&gt;%\n  left_join(enframe(merged.18279.skin.singlets$CellAnnotation,name = \"Barcode\",value=\"CellAnnotation\"),by=\"Barcode\")\n\numap %&gt;%\n  ggplot(aes(x = umapharmony_1, y = umapharmony_2, color = CellAnnotation)) +\n  geom_point(size=0.25) +\n  theme_bw()",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-umap-split-by-ipilimumab-concentration-cohort-and-timepoint",
    "href": "Skin_scRNA_Part10.html#plot-umap-split-by-ipilimumab-concentration-cohort-and-timepoint",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.8 Plot UMAP split by Ipilimumab concentration cohort and Timepoint",
    "text": "10.8 Plot UMAP split by Ipilimumab concentration cohort and Timepoint\n\nrownames_to_column(as.data.frame(Embeddings(merged.18279.skin.singlets,reduction = \"umap.harmony\")),var=\"Barcode\") %&gt;%\n    as_tibble() %&gt;%\n    left_join(enframe(merged.18279.skin.singlets$sub.cluster,name = \"Barcode\",value=\"sub.cluster\"),by=\"Barcode\") %&gt;%\n    left_join(enframe(merged.18279.skin.singlets$CellClass,name = \"Barcode\",value=\"CellClass\"),by=\"Barcode\") %&gt;%\n    mutate(Timepoint = str_split_i(Barcode,pattern = \"_\",i = 3)) %&gt;%\n    mutate(IpiCohort = str_split_i(Barcode,pattern = \"_\", i = 4)) %&gt;%\n    ggplot(aes(x = umapharmony_1, y = umapharmony_2, color = CellClass)) +\n    geom_point(size = 0.25) +\n    facet_grid(IpiCohort ~ fct_relevel(Timepoint,c(\"Pre3rd\",\"Post3rd\"))) +\n    theme_bw() +\n    geom_text(aes(x, y, label = lab),\n              data = data.frame(x = 13, \n                                y = 14, \n                                lab = c(paste0(\"n = \", table(merged.18279.skin.singlets$IpiCohort,merged.18279.skin.singlets$Timepoint)[1,1]),\n                                        paste0(\"n = \", table(merged.18279.skin.singlets$IpiCohort,merged.18279.skin.singlets$Timepoint)[1,2]), \n                                        paste0(\"n = \", table(merged.18279.skin.singlets$IpiCohort,merged.18279.skin.singlets$Timepoint)[2,1]),\n                                        paste0(\"n = \", table(merged.18279.skin.singlets$IpiCohort,merged.18279.skin.singlets$Timepoint)[2,2])\n                                        ),\n                                Timepoint = c(\"Pre3rd\",\"Post3rd\",\"Pre3rd\",\"Post3rd\"),\n                                IpiCohort = c(\"2.5mgIpi\",\"2.5mgIpi\",\"5mgIpi\",\"5mgIpi\")\n                                ), \n                inherit.aes = FALSE\n            )",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-large-heatmap-demonstrating-marker-gene-selectivity-and-cluster-identity",
    "href": "Skin_scRNA_Part10.html#plot-large-heatmap-demonstrating-marker-gene-selectivity-and-cluster-identity",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.9 Plot large heatmap demonstrating marker gene selectivity and cluster identity",
    "text": "10.9 Plot large heatmap demonstrating marker gene selectivity and cluster identity\n\nmerged.18279.skin.singlets[['RNA']] &lt;- JoinLayers(merged.18279.skin.singlets[['RNA']])\nmerged.sce &lt;- as.SingleCellExperiment(merged.18279.skin.singlets, assay=\"RNA\")\n\n(mergedCondition.sce &lt;- prepSCE(merged.sce,\n        kid = \"sub.cluster\",\n        gid = \"Timepoint\",\n        sid = \"Sample\",\n        drop = TRUE))\n\nclass: SingleCellExperiment \ndim: 61217 33401 \nmetadata(1): experiment_info\nassays(2): counts logcounts\nrownames(61217): 5-8S-rRNA 5S-rRNA ... ZZEF1 ZZZ3\nrowData names(0):\ncolnames(33401): P101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT\n  P101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT ...\n  P111_Skin_Post3rd_5mgIpi_RNA_ACGATGTTCCTAGGGC\n  P111_Skin_Post3rd_5mgIpi_RNA_GAACATCAGCCACGTC\ncolData names(3): cluster_id sample_id group_id\nreducedDimNames(4): PCA UMAP.UNINTEGRATED INTEGRATED.HARMONY\n  UMAP.HARMONY\nmainExpName: RNA\naltExpNames(0):\n\nall_genes_to_plot &lt;- c(\"PTPRC\",\"TCF4\",\"TNFSF10\",\"S100A8\",\"S100A9\",\"RNASE1\",\"MARCO\",\"SIGLEC1\",\"CD14\",\"ITGAM\",\"ITGAX\",\"FCN1\",\"APOBEC3A\",\"SERPINA1\",\"FOLR2\",\"LILRB5\",\"CD163\",\"APOE\",\"FABP5\",\"LIPA\",\"APOC1\",\"TREM2\",\"CD68\",\"CSF1R\",\"FCGR3A\",\"C1QA\",\"C1QB\",\"C1QC\",\"ICAM1\",\"LGALS9\",\"CD40\",\"CD80\",\"CD86\",\"HLA-DRA\",\"HLA-DRB1\",\"HLA-DQA1\",\"HLA-DQA2\",\"HLA-DQB1\",\"HLA-DQB2\",\"IL3RA\",\"IRF4\",\"IRF8\",\"CLEC4C\",\"CLEC9A\",\"CLEC10A\",\"CD1C\",\"CD1E\",\"FCER1A\",\"CD207\",\"MARCKSL1\",\"FSCN1\",\"LAMP3\",\"LY75\",\"FLT3\",\"CD274\",\"BANK1\",\"CD79A\",\"MS4A1\",\"CD19\",\"NCR1\",\"NCAM1\",\"CD3E\",\"CD3G\", \"CD4\",\"CD8A\",\"TRAC\",\"TRBC1\",\"TRBC2\",\"TRDC\",\"IL7R\",\"CCR7\",\"SELL\",\"CD27\",\"TCF7\",\"CXCR6\",\"CCR6\",\"NKG7\",\"GNLY\",\"GZMA\",\"GZMB\",\"PRF1\",\"PDCD1\",\"LAG3\",\"TIGIT\",\"CTLA4\",\"TOX\",\"BATF\",\"TNFRSF4\",\"ICOS\",\"IL2RA\",\"FOXP3\",\"TNFRSF18\",\"KIT\",\"MKI67\",\"TOP2A\",\"HPGD\",\"CPA3\",\"SFN\",\"CXCL14\",\"CAV1\",\"DCN\",\"LUM\",\"PECAM1\",\"VWF\",\"TAGLN\",\"CALD1\",\"KRT5\",\"DMKN\",\"TACSTD2\")\n\ncluster_order &lt;- c(\"0\",\"3\",\"12\",\"22\",\"25\",\"14\",\"18\",\"7\",\"26\",\"15\",\"23\",\"5_2\",\"5_0\",\"5_1\",\"19_0\",\"2_1\",\"4_0\",\"4_1\",\"2_0\",\"2_2\",\"6_1\",\"1_0\",\"1_1\",\"9_0\",\"9_1\",\"13_0\",\"13_1\",\"6_0\",\"11_0\",\"11_1\",\"16\",\"8\",\"10\",\"17\",\"20\",\"21\",\"24\")\nslice_order &lt;- factor(cluster_classes[cluster_order,], levels = unique(cluster_classes[cluster_order,]))\n\ngene_categories &lt;- enframe(all_genes_to_plot,name=NULL,value=\"Gene\") %&gt;%\n  as_tibble() %&gt;%\n  mutate(GeneClass = case_when(\n    Gene %in% c(\"PTPRC\") ~ \"Immune\",\n    Gene %in% c(\"TCF4\",\"TNFSF10\",\"S100A8\",\"S100A9\",\"RNASE1\",\"MARCO\",\"SIGLEC1\",\"CD14\",\"ITGAM\",\"ITGAX\",\"FCN1\",\"APOBEC3A\",\"SERPINA1\",\"FOLR2\",\"LILRB5\",\"CD163\",\"APOE\",\"FABP5\",\"LIPA\",\"APOC1\",\"TREM2\",\"CD68\",\"CSF1R\",\"FCGR3A\",\"C1QA\",\"C1QB\",\"C1QC\",\"ICAM1\",\"LGALS9\") ~ \"Monocyte/\\nMacrophage\",\n    Gene %in% c(\"CD40\",\"CD80\",\"CD86\",\"HLA-DRA\",\"HLA-DRB1\",\"HLA-DQA1\",\"HLA-DQA2\",\"HLA-DQB1\",\"HLA-DQB2\",\"IL3RA\",\"IRF4\",\"IRF8\",\"CLEC4C\",\"CLEC9A\",\"CLEC10A\",\"CD1C\",\"CD1E\",\"FCER1A\",\"CD207\",\"MARCKSL1\",\"FSCN1\",\"LAMP3\",\"LY75\",\"FLT3\",\"CD274\") ~ \"Dendritic\\ncell\",\n    Gene %in% c(\"BANK1\",\"CD79A\",\"MS4A1\",\"CD19\") ~ \"B cell\",\n    Gene %in% c(\"NCR1\",\"NCAM1\") ~ \"NK cell\",\n    Gene %in% c(\"CD3E\",\"CD3G\",\"CD4\",\"CD8A\",\"TRAC\",\"TRBC1\",\"TRBC2\",\"TRDC\",\"IL7R\",\"CCR7\",\"SELL\",\"CD27\",\"TCF7\") ~ \"T cell\",\n    Gene %in% c(\"CXCR6\",\"CCR6\",\"NKG7\",\"GNLY\",\"GZMA\",\"GZMB\",\"PRF1\",\"PDCD1\",\"LAG3\",\"TIGIT\",\"CTLA4\",\"TOX\",\"BATF\",\"TNFRSF4\",\"ICOS\",\"IL2RA\",\"FOXP3\",\"TNFRSF18\",\"KIT\") ~ \"T cell\\nsubsets/\\nNK cells\",\n    Gene %in% c(\"MKI67\",\"TOP2A\") ~ \"Proliferation\",\n    Gene %in% c(\"SFN\",\"CXCL14\",\"CAV1\") ~ \"Keratinocyte\",\n    Gene %in% c(\"DCN\",\"LUM\") ~ \"Fibroblast\",\n    Gene %in% c(\"HPGD\",\"CPA3\") ~ \"Mast cell\",\n    Gene %in% c(\"PECAM1\",\"VWF\") ~ \"Endothelial\",\n    Gene %in% c(\"TAGLN\",\"CALD1\") ~ \"Pericyte/\\nsmooth muscle\",\n    Gene %in% c(\"KRT5\",\"DMKN\",\"TACSTD2\") ~ \"Basal\"\n    )\n  )\n  \ngene_slice_order &lt;- factor(gene_categories$GeneClass, levels = unique(gene_categories$GeneClass))\n  \npb_all &lt;- aggregateData(mergedCondition.sce,\n    assay = \"counts\",\n    fun = \"mean\",\n    by = \"cluster_id\")\n\nall_genes_to_plot &lt;- all_genes_to_plot[all_genes_to_plot %in% rownames(assay(pb_all))]\nmat &lt;- assay(pb_all)[all_genes_to_plot,cluster_order]\ncolnames(mat) &lt;- cluster_annot[cluster_order]\nComplexHeatmap::Heatmap(mat,\n                        col = circlize::colorRamp2(c(0,3),hcl_palette = \"viridis\"),\n                        cluster_rows = FALSE,\n                        cluster_columns = FALSE,\n                        column_split = slice_order,\n                        row_split = gene_slice_order,\n                        row_title_rot = 0,\n                        cluster_column_slices = FALSE,\n                        border = TRUE,\n                        row_names_gp = gpar(fontsize=6,fontface=\"italic\"),\n                        column_names_gp = gpar(fontsize=8),\n                        column_title_gp = gpar(fontsize=8,fontface=\"bold\"),\n                        row_title_gp = gpar(fontsize=8,fontface=\"bold\"),\n                        name = \"Mean expression\",\n                        heatmap_legend_param = list(title_position = \"leftcenter-rot\",border = TRUE)\n                  )",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-heatmap-of-functional-genes",
    "href": "Skin_scRNA_Part10.html#plot-heatmap-of-functional-genes",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "10.10 Plot heatmap of functional genes",
    "text": "10.10 Plot heatmap of functional genes\n\nfunctional_genes_to_plot &lt;- c(\"IDO1\",\"CCL2\",\"CXCL10\",\"CXCL2\",\"CXCL3\",\"IL10\",\"IL18\",\"IL1B\",\"CXCL8\",\"CXCL16\",\"LYZ\",\"IL15\",\"CCL19\",\"CXCL19\",\"TNF\",\"CCL3\",\"CCL4\",\"CCL5\",\"XCL1\",\"XCL2\",\"IFNG\",\"CSF2\")\n\nfunctional_genes_to_plot &lt;- functional_genes_to_plot[functional_genes_to_plot %in% rownames(assay(pb_all))]\nfx_mat &lt;- assay(pb_all)[functional_genes_to_plot,cluster_order]\ncolnames(fx_mat) &lt;- cluster_annot[cluster_order]\nComplexHeatmap::Heatmap(fx_mat,\n                        col = circlize::colorRamp2(c(0,3),hcl_palette = \"viridis\"),\n                        cluster_rows = FALSE,\n                        cluster_columns = FALSE,\n                        column_split = slice_order,\n                        cluster_column_slices = FALSE,\n                        border = TRUE,\n                        row_names_gp = gpar(fontsize=6,fontface=\"italic\"),\n                        column_names_gp = gpar(fontsize=8),\n                        column_title_gp = gpar(fontsize=8,fontface=\"bold\"),\n                        name = \"Mean expression\",\n                        heatmap_legend_param = list(title_position = \"leftcenter-rot\",border = TRUE)\n                  )",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-boxplots-of-cell-proportion-differences-pre-vs-post-connecting-patients-with-a-line",
    "href": "Skin_scRNA_Part10.html#plot-boxplots-of-cell-proportion-differences-pre-vs-post-connecting-patients-with-a-line",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "11.1 Plot boxplots of cell proportion differences, Pre vs Post, connecting patients with a line",
    "text": "11.1 Plot boxplots of cell proportion differences, Pre vs Post, connecting patients with a line\n\ntotalsPerSample &lt;- enframe(table(merged.18279.skin.singlets$Sample),name=\"Sample\",value=\"TotalCells\") %&gt;%\n    as_tibble() %&gt;%\n    mutate(TotalCells = as.numeric(TotalCells)) %&gt;%\n    mutate(Sample = str_replace_all(Sample,\"_.{1,3}mgIpi_RNA\",\"\"))\n\nCellAnnotation.labels &lt;- enframe(cluster_annot,value=\"CellAnnotation\") %&gt;%\n  as_tibble() %&gt;%\n  left_join(sigProps,by = c(\"CellAnnotation\" = \"Annot\")) %&gt;%\n    mutate(CellAnnotation.labels = case_when(\n      adj.P.Val &lt; 0.05 ~ paste0(CellAnnotation,\"**\\nadj.p = \",round(adj.P.Val,4)),\n      (adj.P.Val &gt;= 0.05) & (adj.P.Val &lt; 0.1) ~ paste0(CellAnnotation,\"*\\nadj.p = \",round(adj.P.Val,4)),\n      is.na(adj.P.Val) ~ CellAnnotation\n      )\n    ) %&gt;%\n  dplyr::select(CellAnnotation,CellAnnotation.labels) %&gt;%\n  deframe()\n\nrownames_to_column(as.data.frame(merged.18279.skin.singlets@meta.data),var=\"Barcode\") %&gt;%\n    as_tibble() %&gt;%\n    dplyr::select(Barcode,sub.cluster,Sample,CellAnnotation) %&gt;%\n    mutate(Sample = str_replace_all(Sample,\"_.{1,3}mgIpi_RNA\",\"\")) %&gt;%\n    group_by(CellAnnotation,Sample) %&gt;%\n    summarize(n = dplyr::n()) %&gt;%\n    ungroup() %&gt;%\n    complete(Sample,CellAnnotation) %&gt;%             # Makes sure 0s get represented rather than omitted\n    mutate(n = replace_na(n,0)) %&gt;%\n    mutate(Patient = str_split_i(Sample,pattern = \"_\",i = 1)) %&gt;%\n    mutate(Site = str_split_i(Sample,pattern = \"_\",i = 2)) %&gt;%\n    mutate(Timepoint = str_split_i(Sample,pattern = \"_\",i = 3)) %&gt;%\n    mutate(Timepoint = str_replace_all(Timepoint,\"3rd\",\"\")) %&gt;%\n    right_join(totalsPerSample,.,by=\"Sample\") %&gt;%\n      group_by(Sample) %&gt;%\n      mutate(Proportion = n / TotalCells) %&gt;%\n    left_join(sigProps,by = c(\"CellAnnotation\" = \"Annot\")) %&gt;%\n    mutate(CellAnnotation = factor(CellAnnotation, levels = cluster_annot[cluster_order])) %&gt;%\n    ungroup() %&gt;%\n    ggplot(aes(x = fct_relevel(Timepoint,c(\"Pre\",\"Post\")),\n               y = Proportion,\n               fill = fct_relevel(Timepoint,c(\"Pre\",\"Post\"))\n              )\n           ) +\n      geom_boxplot(outlier.shape=NA, width = 0.5) +\n    facet_wrap(~CellAnnotation,scales=\"free_y\") +\n      lemon::geom_pointpath(aes(group=Patient), \n                            position = position_jitterdodge(jitter.width = 0.1,\n                                                            dodge.width = 0.4,\n                                                            seed=123)\n                            ) +\n      facet_wrap(~CellAnnotation,scales=\"free_y\",ncol=6,labeller = as_labeller(CellAnnotation.labels)) +\n    theme_bw() +\n    theme(axis.text.y = element_text(size=10),\n        strip.text = element_text(size=8,face=\"bold\"),\n        axis.title = element_text(size=10,face=\"bold\"),\n        legend.text = element_text(size=10),\n        legend.title = element_text(size=10,face=\"bold\"),\n        legend.key.size = unit(2,\"line\"),\n        panel.grid = element_blank(), \n        panel.grid.minor = element_blank(),\n        panel.border = element_rect(fill = NA, color = \"black\")\n        ) +\n      xlab(\"Timepoint\") +\n      ylab(\"Skin composition fraction\") +\n    labs(fill = \"Timepoint\") +\n    scale_fill_manual(values=c(\"lightgreen\",\"darkgreen\"))\n\n`summarise()` has grouped output by 'CellAnnotation'. You can override using\nthe `.groups` argument.\n\n\nWarning in left_join(., sigProps, by = c(CellAnnotation = \"Annot\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 38 of `x` matches multiple rows in `y`.\nℹ Row 1 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#plot-the-same-except-now-facet-both-by-cluster-and-ipilimumab-concentration-cohort",
    "href": "Skin_scRNA_Part10.html#plot-the-same-except-now-facet-both-by-cluster-and-ipilimumab-concentration-cohort",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "11.2 Plot the same except now facet both by Cluster and Ipilimumab concentration cohort",
    "text": "11.2 Plot the same except now facet both by Cluster and Ipilimumab concentration cohort\n\nrownames_to_column(as.data.frame(merged.18279.skin.singlets@meta.data),var=\"Barcode\") %&gt;%\n    as_tibble() %&gt;%\n    dplyr::select(Barcode,sub.cluster,Sample,CellAnnotation) %&gt;%\n    group_by(CellAnnotation,Sample) %&gt;%\n    summarize(n = dplyr::n()) %&gt;%\n    ungroup() %&gt;%\n    complete(Sample,CellAnnotation) %&gt;%             # Makes sure 0s get represented rather than omitted\n    mutate(n = replace_na(n,0)) %&gt;%\n    mutate(Patient = str_split_i(Sample,pattern = \"_\",i = 1)) %&gt;%\n    mutate(Site = str_split_i(Sample,pattern = \"_\",i = 2)) %&gt;%\n    mutate(Timepoint = str_split_i(Sample,pattern = \"_\",i = 3)) %&gt;%\n    mutate(Timepoint = str_replace_all(Timepoint,\"3rd\",\"\")) %&gt;%\n    mutate(IpiCohort = str_split_i(Sample,pattern = \"_\",i = 4)) %&gt;%\n    mutate(Sample = str_replace_all(Sample,\"_.{1,3}mgIpi_RNA\",\"\"))  %&gt;%\n    right_join(totalsPerSample,.,by=\"Sample\") %&gt;%\n      group_by(Sample) %&gt;%\n      mutate(Proportion = n / TotalCells) %&gt;%\n    left_join(sigProps,by = c(\"CellAnnotation\" = \"Annot\")) %&gt;%\n    mutate(CellAnnotation = factor(CellAnnotation, levels = cluster_annot[cluster_order])) %&gt;%\n    ungroup() %&gt;%\n    ggplot(aes(x = fct_relevel(Timepoint,c(\"Pre\",\"Post\")),\n               y = Proportion,\n               fill = fct_relevel(Timepoint,c(\"Pre\",\"Post\"))\n              )\n           ) +\n      geom_boxplot(outlier.shape=NA, width = 0.5) +\n    geom_point(aes(color = Patient), position = position_jitterdodge(jitter.width=0.1,dodge.width = 0.4)) +\n    facet_grid(CellAnnotation~IpiCohort,scales=\"free\") +\n    theme_bw() +\n    theme(axis.text.y = element_text(size=10),\n        strip.text = element_text(size=8,face=\"bold\"),\n        axis.title = element_text(size=10,face=\"bold\"),\n        legend.text = element_text(size=10),\n        legend.title = element_text(size=10,face=\"bold\"),\n        legend.key.size = unit(2,\"line\"),\n        panel.grid = element_blank(), \n        panel.grid.minor = element_blank(),\n        panel.border = element_rect(fill = NA, color = \"black\"),\n        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)\n        ) +\n      xlab(\"Timepoint\") +\n      ylab(\"Skin composition fraction\") +\n    labs(fill = \"Cohort\", color = \"Patient\") +\n    scale_color_manual(values = c(\"#59A14FFF\",  \n                                  \"#B07AA1FF\", \n                                  \"#76B7B2FF\", \n                                  \"#FBB258FF\", \n                                  \"#DC050CFF\", \n                                  \"#F6AAC9FF\", \n                                  \"#5CA2E5FF\", \n                                  \"#615EBFFF\", \n                                  \"#826250FF\")) +\n    scale_fill_manual(values=c(\"lightgreen\",\"darkgreen\"))\n\n`summarise()` has grouped output by 'CellAnnotation'. You can override using\nthe `.groups` argument.\n\n\nWarning in left_join(., sigProps, by = c(CellAnnotation = \"Annot\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 38 of `x` matches multiple rows in `y`.\nℹ Row 1 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#prepare-umap-with-clusters-of-interest-circled",
    "href": "Skin_scRNA_Part10.html#prepare-umap-with-clusters-of-interest-circled",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "11.3 Prepare UMAP with clusters of interest circled",
    "text": "11.3 Prepare UMAP with clusters of interest circled\n\numap_circled &lt;- umap %&gt;%\n    ggplot(aes(x = umapharmony_1, y = umapharmony_2, color = CellAnnotation)) +\n    geom_point(size = 0.25) +\n    theme_classic() +\n    geom_shape(data = umap %&gt;% dplyr::filter(sub.cluster==\"0\"), \n               stat = \"ellipse\", \n               expand = unit(0.25, 'cm'), \n               fill = NA, \n               color = \"black\", \n               linetype = 2) +\n    geom_shape(data = umap %&gt;% dplyr::filter(sub.cluster==\"12\"), \n               stat = \"ellipse\", \n               expand = unit(0.25, 'cm'), \n               fill = NA, \n               color = \"black\", \n               linetype = 2) +\n    geom_shape(data = umap %&gt;% dplyr::filter(sub.cluster==\"15\"), \n               stat = \"ellipse\", \n               expand = unit(0.25, 'cm'), \n               fill = NA, \n               color = \"black\", \n               linetype = 2) +\n    geom_shape(data = umap %&gt;% dplyr::filter(sub.cluster==\"5_2\"),\n               stat = \"ellipse\",\n               expand = unit(0.25, 'cm'),\n               fill = NA,\n               color = \"black\",\n               linetype = 2) +\n  guides(color = \"none\")\n\numap_circled",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#for-each-cluster-of-interest-plot-differentially-expressed-genes-as-a-heatmap-and-add-annotation-layer-illustrating-changing-cell-proportions",
    "href": "Skin_scRNA_Part10.html#for-each-cluster-of-interest-plot-differentially-expressed-genes-as-a-heatmap-and-add-annotation-layer-illustrating-changing-cell-proportions",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "11.4 For each cluster of interest, plot differentially expressed genes as a heatmap and add annotation layer illustrating changing cell proportions",
    "text": "11.4 For each cluster of interest, plot differentially expressed genes as a heatmap and add annotation layer illustrating changing cell proportions\n\n11.4.1 Create function for centering expression values around mean of Pre3rd samples\n\ncontrolCenter &lt;- function(data_matrix = NULL, pattern_for_controls = NULL, pattern_for_others = NULL) {\n  stopifnot(is.matrix(data_matrix))\n\n    ctrl_means &lt;- apply(data_matrix, 1, function(x) {mean(x[grep(pattern_for_controls,colnames(data_matrix))])})\n    data_matrix_centered &lt;- as.data.frame(matrix(data=NA,nrow=length(rownames(data_matrix)),ncol=length(colnames(data_matrix))))\n    rownames(data_matrix_centered) &lt;- rownames(data_matrix)\n    colnames(data_matrix_centered) &lt;- colnames(data_matrix)[c(grep(pattern_for_controls,colnames(data_matrix)),grep(pattern_for_others,colnames(data_matrix)))]\n\n    for (i in 1:length(ctrl_means)) {\n      data_matrix_centered[i,] &lt;- as.numeric(data_matrix[i,c(grep(pattern_for_controls,colnames(data_matrix)),grep(pattern_for_others,colnames(data_matrix)))]) - as.numeric(ctrl_means[i])\n    }\n  return &lt;- data_matrix_centered\n  \n}\n\n\n\n11.4.2 Create pseudobulks for plotting\nUse mean (rather than sum) to control for varying number of cells\n\n(mergedCondition.sce &lt;- prepSCE(merged.sce,\n        kid = \"sub.cluster\",\n        gid = \"Timepoint\",\n        sid = \"Sample\",\n        drop = TRUE))\n\nclass: SingleCellExperiment \ndim: 61217 33401 \nmetadata(1): experiment_info\nassays(2): counts logcounts\nrownames(61217): 5-8S-rRNA 5S-rRNA ... ZZEF1 ZZZ3\nrowData names(0):\ncolnames(33401): P101_Skin_Pre3rd_2.5mgIpi_RNA_GCACATAAGTGCCATT\n  P101_Skin_Pre3rd_2.5mgIpi_RNA_GGAACTTGTCGCGGTT ...\n  P111_Skin_Post3rd_5mgIpi_RNA_ACGATGTTCCTAGGGC\n  P111_Skin_Post3rd_5mgIpi_RNA_GAACATCAGCCACGTC\ncolData names(3): cluster_id sample_id group_id\nreducedDimNames(4): PCA UMAP.UNINTEGRATED INTEGRATED.HARMONY\n  UMAP.HARMONY\nmainExpName: RNA\naltExpNames(0):\n\npb &lt;- aggregateData(mergedCondition.sce,\n    assay = \"counts\",\n    fun = \"mean\",\n    by = c(\"cluster_id\", \"sample_id\"))\n\n\n\n11.4.3 Create cell proportion table per Sample and per sub-cluster\n\nprops &lt;- rownames_to_column(as.data.frame(merged.18279.skin.singlets@meta.data),var=\"Barcode\") %&gt;%\n    as_tibble() %&gt;%\n    dplyr::select(Barcode,CellAnnotation,Sample) %&gt;%\n    mutate(Sample = str_replace_all(Sample,\"_.{1,3}mgIpi_RNA\",\"\")) %&gt;%\n    group_by(CellAnnotation,Sample) %&gt;%\n    summarize(n = dplyr::n()) %&gt;%\n    ungroup() %&gt;%\n    complete(Sample,CellAnnotation) %&gt;%             # Makes sure 0s get represented rather than omitted\n    mutate(n = replace_na(n,0)) %&gt;%\n    mutate(Patient = str_split_i(Sample,pattern = \"_\",i = 1)) %&gt;%\n    mutate(Site = str_split_i(Sample,pattern = \"_\",i = 2)) %&gt;%\n    mutate(Timepoint = str_split_i(Sample,pattern = \"_\",i = 3)) %&gt;%\n    mutate(Timepoint = str_replace_all(Timepoint,\"3rd\",\"\")) %&gt;%\n    right_join(totalsPerSample,.,by=\"Sample\") %&gt;%\n    mutate(Sample = str_replace_all(Sample,\"_Skin\",\"\")) %&gt;%\n    mutate(Sample = str_replace_all(Sample,\"3rd\",\"\")) %&gt;%\n      group_by(Sample) %&gt;%\n      mutate(Proportion = n / TotalCells)\n\n`summarise()` has grouped output by 'CellAnnotation'. You can override using\nthe `.groups` argument.\n\nprops\n\n# A tibble: 646 × 8\n# Groups:   Sample [17]\n   Sample    TotalCells CellAnnotation      n Patient Site  Timepoint Proportion\n   &lt;chr&gt;          &lt;dbl&gt; &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;\n 1 P101_Post       1718 MonoMac_1         421 P101    Skin  Post         0.245  \n 2 P101_Post       1718 CD4_T_Naive/CM     76 P101    Skin  Post         0.0442 \n 3 P101_Post       1718 CD4_T_CTL          19 P101    Skin  Post         0.0111 \n 4 P101_Post       1718 CD8_T_EM_1         92 P101    Skin  Post         0.0536 \n 5 P101_Post       1718 CD8_T_Naive/CM…    20 P101    Skin  Post         0.0116 \n 6 P101_Post       1718 CD8_T_EM_2         16 P101    Skin  Post         0.00931\n 7 P101_Post       1718 MonoMac_2          82 P101    Skin  Post         0.0477 \n 8 P101_Post       1718 CD8_T_Naive/CM…    64 P101    Skin  Post         0.0373 \n 9 P101_Post       1718 CD8_T_Naive/CM…    92 P101    Skin  Post         0.0536 \n10 P101_Post       1718 NK/T_1             18 P101    Skin  Post         0.0105 \n# ℹ 636 more rows\n\n\n\n\n11.4.4 Cluster 0\n\n# Subset to genes of interest and reorder columns\ncluster &lt;- \"0\"\ngoi &lt;- c(\"IL6\",\"TNF\",\"CXCL10\",\"CXCL11\",\"CCL2\",\"CCL3\",\"CCL4\",\"CCL5\",\"CCL8\",\"IL15\",\"SELL\")\npb_cluster &lt;- assays(pb)[[cluster]][goi,]\npb_cluster_cnames &lt;- str_replace_all(str_replace_all(colnames(pb_cluster),\"3rd_.{1,3}mgIpi_RNA\",\"\"),\"_Skin\",\"\")\ncolnames(pb_cluster) &lt;- pb_cluster_cnames\npb_cluster_cnames_sorted &lt;- pb_cluster_cnames[c(which(grepl(\"Pre\",pb_cluster_cnames)),which(grepl(\"Post\",pb_cluster_cnames)))]\n\n# Subset proportions table\ncluster_props &lt;- props %&gt;%\n  dplyr::filter(CellAnnotation == cluster_annot[cluster]) %&gt;%\n  dplyr::select(Sample,Proportion) %&gt;%\n  ungroup() %&gt;%\n  mutate(Sample = fct_relevel(as.factor(Sample),pb_cluster_cnames_sorted)) %&gt;%\n  dplyr::arrange(Sample) %&gt;%\n  as.data.frame()\n\n# Center expression around mean of Pre samples\npb_centered &lt;- controlCenter(pb_cluster[,pb_cluster_cnames_sorted], pattern_for_controls = \"Pre\", pattern_for_others = \"Post\")\n\n# Plot heatmap\ntimepoints &lt;- as.factor(str_split_i(pb_cluster_cnames_sorted,\"_\",2))\nha1 &lt;- HeatmapAnnotation(Timepoint = timepoints,\n                         show_legend = FALSE,\n                         col = list(Timepoint = setNames(c(\"lightgreen\", \"darkgreen\"), c(\"Pre\", \"Post\"))), \n                         border = TRUE)\nha2 &lt;- HeatmapAnnotation(Proportion = anno_barplot(round(cluster_props$Proportion,3), \n                                                   gp = gpar(fill = c(\n                                                      rep(\"lightgreen\",length(which(str_detect(cluster_props$Sample,\"Pre\")))), \n                                                      rep(\"darkgreen\",length(which(str_detect(cluster_props$Sample,\"Post\"))))\n                                                      )\n                                                     ), \n                                                   add_numbers = TRUE,\n                                                   numbers_rot = 0\n                                                   )\n                         )\n\np0 &lt;- ComplexHeatmap::Heatmap(pb_centered,\n                        cluster_rows = FALSE,\n                        cluster_columns = FALSE,\n                        column_split = factor(timepoints,levels = c(\"Pre\",\"Post\")),\n                        column_labels = str_replace_all(colnames(pb_centered),\"_Pre|_Post\",\"\"),\n                        row_names_gp = gpar(fontface = \"italic\",fontsize = 8),\n                        column_names_gp = gpar(fontsize = 8),\n                        col = colorRamp2(c(0,5),hcl_palette = \"viridis\"),\n                        border = TRUE,\n                        column_title = paste0(\"Cluster \", cluster, \": \",cluster_annot[cluster]),\n                        column_title_gp = gpar(fontface = \"bold\"),\n                        name = \"Expression relative to Pre\",\n                        top_annotation = c(ha1,ha2),\n                        show_heatmap_legend = FALSE\n) %&gt;% \n  draw() %&gt;% \n  grid.grabExpr()\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n11.4.5 Cluster 12\n\n# Subset to genes of interest and reorder columns\ncluster &lt;- \"12\"\ngoi &lt;- c(\"CXCL10\",\"CXCL9\",\"CXCL11\",\"CCL8\",\"IL18\",\"IL6\",\"TNF\")\npb_cluster &lt;- assays(pb)[[cluster]][goi,]\npb_cluster_cnames &lt;- str_replace_all(str_replace_all(colnames(pb_cluster),\"3rd_.{1,3}mgIpi_RNA\",\"\"),\"_Skin\",\"\")\ncolnames(pb_cluster) &lt;- pb_cluster_cnames\npb_cluster_cnames_sorted &lt;- pb_cluster_cnames[c(which(grepl(\"Pre\",pb_cluster_cnames)),which(grepl(\"Post\",pb_cluster_cnames)))]\n\n# Subset proportions table\ncluster_props &lt;- props %&gt;%\n  dplyr::filter(CellAnnotation == cluster_annot[cluster]) %&gt;%\n  dplyr::select(Sample,Proportion) %&gt;%\n  ungroup() %&gt;%\n  mutate(Sample = fct_relevel(as.factor(Sample),pb_cluster_cnames_sorted)) %&gt;%\n  dplyr::arrange(Sample) %&gt;%\n  as.data.frame()\n\n# Center expression around mean of Pre samples\npb_centered &lt;- controlCenter(pb_cluster[,pb_cluster_cnames_sorted], pattern_for_controls = \"Pre\", pattern_for_others = \"Post\")\n\n# Plot heatmap\ntimepoints &lt;- as.factor(str_split_i(pb_cluster_cnames_sorted,\"_\",2))\nha1 &lt;- HeatmapAnnotation(Timepoint = timepoints,\n                         show_legend = FALSE,\n                         col = list(Timepoint = setNames(c(\"lightgreen\", \"darkgreen\"), c(\"Pre\", \"Post\"))), \n                         border = TRUE)\nha2 &lt;- HeatmapAnnotation(Proportion = anno_barplot(round(cluster_props$Proportion,3), \n                                                   gp = gpar(fill = c(\n                                                      rep(\"lightgreen\",length(which(str_detect(cluster_props$Sample,\"Pre\")))), \n                                                      rep(\"darkgreen\",length(which(str_detect(cluster_props$Sample,\"Post\"))))\n                                                      )\n                                                     ),\n                                                   add_numbers = TRUE,\n                                                   numbers_rot = 0\n                                                   )\n                         )\n\np12 &lt;- ComplexHeatmap::Heatmap(pb_centered,\n                        cluster_rows = FALSE,\n                        cluster_columns = FALSE,\n                        column_split = factor(timepoints,levels = c(\"Pre\",\"Post\")),\n                        column_labels = str_replace_all(colnames(pb_centered),\"_Pre|_Post\",\"\"),\n                        row_names_gp = gpar(fontface = \"italic\",fontsize = 8),\n                        column_names_gp = gpar(fontsize = 8),\n                        col = colorRamp2(c(0,5),hcl_palette = \"viridis\"),\n                        border = TRUE,\n                        column_title = paste0(\"Cluster \", cluster, \": \", cluster_annot[cluster]),\n                        column_title_gp = gpar(fontface = \"bold\"),\n                        name = \"Expression relative to Pre\",\n                        top_annotation = c(ha1,ha2),\n                        show_heatmap_legend = FALSE\n) %&gt;% \n  draw() %&gt;% \n  grid.grabExpr()\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n11.4.6 Cluster 15\n\n# Subset to genes of interest and reorder columns\ncluster &lt;- \"15\"\ngoi &lt;- c(\"CCL19\",\"CD40\",\"CD86\",\"CXCL9\")\npb_cluster &lt;- assays(pb)[[cluster]][goi,]\npb_cluster_cnames &lt;- str_replace_all(str_replace_all(colnames(pb_cluster),\"3rd_.{1,3}mgIpi_RNA\",\"\"),\"_Skin\",\"\")\ncolnames(pb_cluster) &lt;- pb_cluster_cnames\npb_cluster_cnames_sorted &lt;- pb_cluster_cnames[c(which(grepl(\"Pre\",pb_cluster_cnames)),which(grepl(\"Post\",pb_cluster_cnames)))]\n\n# Subset proportions table\ncluster_props &lt;- props %&gt;%\n  dplyr::filter(CellAnnotation == cluster_annot[cluster]) %&gt;%\n  dplyr::select(Sample,Proportion) %&gt;%\n  ungroup() %&gt;%\n  mutate(Sample = fct_relevel(as.factor(Sample),pb_cluster_cnames_sorted)) %&gt;%\n  dplyr::arrange(Sample) %&gt;%\n  as.data.frame()\n\n# Center expression around mean of Pre samples\npb_centered &lt;- controlCenter(pb_cluster[,pb_cluster_cnames_sorted], pattern_for_controls = \"Pre\", pattern_for_others = \"Post\")\n\n# Plot heatmap\ntimepoints &lt;- as.factor(str_split_i(pb_cluster_cnames_sorted,\"_\",2))\nha1 &lt;- HeatmapAnnotation(Timepoint = timepoints,\n                         show_legend = FALSE,\n                         col = list(Timepoint = setNames(c(\"lightgreen\", \"darkgreen\"), c(\"Pre\", \"Post\"))), \n                         border = TRUE)\nha2 &lt;- HeatmapAnnotation(Proportion = anno_barplot(round(cluster_props$Proportion,3), \n                                                   gp = gpar(fill = c(\n                                                      rep(\"lightgreen\",length(which(str_detect(cluster_props$Sample,\"Pre\")))), \n                                                      rep(\"darkgreen\",length(which(str_detect(cluster_props$Sample,\"Post\"))))\n                                                      )\n                                                     ),\n                                                   add_numbers = TRUE,\n                                                   numbers_rot = 0\n                                                   )\n                         )\n\np15 &lt;- ComplexHeatmap::Heatmap(pb_centered,\n                        cluster_rows = FALSE,\n                        cluster_columns = FALSE,\n                        column_split = factor(timepoints,levels = c(\"Pre\",\"Post\")),\n                        column_labels = str_replace_all(colnames(pb_centered),\"_Pre|_Post\",\"\"),\n                        row_names_gp = gpar(fontface = \"italic\",fontsize = 8),\n                        column_names_gp = gpar(fontsize = 8),\n                        col = colorRamp2(c(0,5),hcl_palette = \"viridis\"),\n                        border = TRUE,\n                        column_title = paste0(\"Cluster \", cluster, \": \",cluster_annot[cluster]),\n                        column_title_gp = gpar(fontface = \"bold\"),\n                        name = \"Expression relative to Pre\",\n                        top_annotation = c(ha1,ha2),\n                        show_heatmap_legend = FALSE\n) %&gt;% \n  draw() %&gt;% \n  grid.grabExpr()\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n11.4.7 Cluster 5_2\n\n# Subset to genes of interest and reorder columns\ncluster &lt;- \"5_2\"\ngoi &lt;- c(\"GNLY\",\"GZMB\",\"PRF1\")\npb_cluster &lt;- assays(pb)[[cluster]][goi,]\npb_cluster_cnames &lt;- str_replace_all(str_replace_all(colnames(pb_cluster),\"3rd_.{1,3}mgIpi_RNA\",\"\"),\"_Skin\",\"\")\ncolnames(pb_cluster) &lt;- pb_cluster_cnames\npb_cluster_cnames_sorted &lt;- pb_cluster_cnames[c(which(grepl(\"Pre\",pb_cluster_cnames)),which(grepl(\"Post\",pb_cluster_cnames)))]\n\n# Subset proportions table\ncluster_props &lt;- props %&gt;%\n  dplyr::filter(CellAnnotation == cluster_annot[cluster]) %&gt;%\n  dplyr::select(Sample,Proportion) %&gt;%\n  ungroup() %&gt;%\n  mutate(Sample = fct_relevel(as.factor(Sample),pb_cluster_cnames_sorted)) %&gt;%\n  dplyr::arrange(Sample) %&gt;%\n  as.data.frame()\n\n# Center expression around mean of Pre samples\npb_centered &lt;- controlCenter(pb_cluster[,pb_cluster_cnames_sorted], pattern_for_controls = \"Pre\", pattern_for_others = \"Post\")\n\n# Plot heatmap\ntimepoints &lt;- as.factor(str_split_i(pb_cluster_cnames_sorted,\"_\",2))\nha1 &lt;- HeatmapAnnotation(Timepoint = timepoints,\n                         show_legend = FALSE,\n                         col = list(Timepoint = setNames(c(\"lightgreen\", \"darkgreen\"), c(\"Pre\", \"Post\"))), \n                         border = TRUE)\nha2 &lt;- HeatmapAnnotation(Proportion = anno_barplot(round(cluster_props$Proportion,3), \n                                                   gp = gpar(fill = c(\n                                                      rep(\"lightgreen\",length(which(str_detect(cluster_props$Sample,\"Pre\")))), \n                                                      rep(\"darkgreen\",length(which(str_detect(cluster_props$Sample,\"Post\"))))\n                                                      )\n                                                     ),\n                                                   add_numbers = TRUE,\n                                                   numbers_rot = 0\n                                                   )\n                         )\n\np5_2 &lt;- ComplexHeatmap::Heatmap(pb_centered,\n                        cluster_rows = FALSE,\n                        cluster_columns = FALSE,\n                        column_split = factor(timepoints,levels = c(\"Pre\",\"Post\")),\n                        column_labels = str_replace_all(colnames(pb_centered),\"_Pre|_Post\",\"\"),\n                        row_names_gp = gpar(fontface = \"italic\",fontsize = 8),\n                        column_names_gp = gpar(fontsize = 8),\n                        col = colorRamp2(c(0,5),hcl_palette = \"viridis\"),\n                        border = TRUE,\n                        column_title = paste0(\"Cluster \", cluster, \": \",cluster_annot[cluster]),\n                        column_title_gp = gpar(fontface = \"bold\"),\n                        name = \"Expression relative to Pre\",\n                        top_annotation = c(ha1,ha2),\n                        show_heatmap_legend = FALSE\n) %&gt;% \n  draw() %&gt;% \n  grid.grabExpr()\n\nWarning: The input is a data frame-like object, convert it to a matrix.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#assemble-final-figure",
    "href": "Skin_scRNA_Part10.html#assemble-final-figure",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "11.5 Assemble final figure",
    "text": "11.5 Assemble final figure\n\nwrap_plots(A = p0, \n           B = p12, \n           C = p15, \n           D = p5_2,\n           U = umap_circled,\n            design = \"C##A\n                      DUUB\n                      #UU#\")",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part10.html#get-session-info",
    "href": "Skin_scRNA_Part10.html#get-session-info",
    "title": "10  Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression",
    "section": "11.6 Get session info",
    "text": "11.6 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    grid      stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] knitr_1.45                  speckle_1.0.0              \n [3] cowplot_1.1.3               ggforce_0.4.2              \n [5] lemon_0.4.9                 scuttle_1.12.0             \n [7] limma_3.58.1                muscat_1.14.0              \n [9] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0\n[11] Biobase_2.62.0              GenomicRanges_1.54.1       \n[13] GenomeInfoDb_1.38.8         IRanges_2.36.0             \n[15] S4Vectors_0.40.2            BiocGenerics_0.48.1        \n[17] MatrixGenerics_1.14.0       matrixStats_1.4.1          \n[19] circlize_0.4.16             ComplexHeatmap_2.18.0      \n[21] msigdbr_7.5.1               paletteer_1.6.0            \n[23] patchwork_1.3.0             lubridate_1.9.3            \n[25] forcats_1.0.0               stringr_1.5.1              \n[27] dplyr_1.1.4                 purrr_1.0.2                \n[29] readr_2.1.5                 tidyr_1.3.1                \n[31] tibble_3.2.1                ggplot2_3.5.1              \n[33] tidyverse_2.0.0             Seurat_5.1.0               \n[35] SeuratObject_5.0.2          sp_2.1-4                   \n[37] presto_1.0.0                data.table_1.16.2          \n[39] Rcpp_1.0.13-1              \n\nloaded via a namespace (and not attached):\n  [1] spatstat.sparse_3.1-0     bitops_1.0-9             \n  [3] httr_1.4.7                RColorBrewer_1.1-3       \n  [5] doParallel_1.0.17         numDeriv_2016.8-1.1      \n  [7] backports_1.5.0           tools_4.3.2              \n  [9] sctransform_0.4.1         utf8_1.2.4               \n [11] R6_2.5.1                  lazyeval_0.2.2           \n [13] uwot_0.2.2                mgcv_1.9-1               \n [15] GetoptLong_1.0.5          withr_3.0.2              \n [17] prettyunits_1.2.0         gridExtra_2.3            \n [19] SeuratWrappers_0.3.19     progressr_0.15.1         \n [21] cli_3.6.3                 Cairo_1.6-2              \n [23] spatstat.explore_3.2-6    fastDummies_1.7.3        \n [25] sandwich_3.1-1            labeling_0.4.3           \n [27] mvtnorm_1.3-2             spatstat.data_3.1-4      \n [29] blme_1.0-5                ggridges_0.5.6           \n [31] pbapply_1.7-2             R.utils_2.12.3           \n [33] scater_1.30.1             parallelly_1.39.0        \n [35] generics_0.1.3            shape_1.4.6.1            \n [37] gtools_3.9.5              ica_1.0-3                \n [39] spatstat.random_3.2-2     Matrix_1.6-4             \n [41] ggbeeswarm_0.7.2          fansi_1.0.6              \n [43] abind_1.4-8               R.methodsS3_1.8.2        \n [45] lifecycle_1.0.4           multcomp_1.4-26          \n [47] yaml_2.3.10               edgeR_4.0.16             \n [49] gplots_3.2.0              SparseArray_1.2.2        \n [51] Rtsne_0.17                promises_1.3.0           \n [53] crayon_1.5.3              miniUI_0.1.1.1           \n [55] lattice_0.22-6            beachmat_2.18.1          \n [57] magick_2.8.5              pillar_1.9.0             \n [59] rjson_0.2.23              boot_1.3-31              \n [61] estimability_1.5.1        future.apply_1.11.3      \n [63] codetools_0.2-20          leiden_0.4.3.1           \n [65] glue_1.8.0                remotes_2.5.0            \n [67] vctrs_0.6.5               png_0.1-8                \n [69] spam_2.11-0               Rdpack_2.6.2             \n [71] gtable_0.3.6              rematch2_2.1.2           \n [73] xfun_0.49                 rbibutils_2.3            \n [75] S4Arrays_1.2.0            mime_0.12                \n [77] coda_0.19-4.1             reformulas_0.4.0         \n [79] survival_3.7-0            iterators_1.0.14         \n [81] statmod_1.5.0             fitdistrplus_1.2-1       \n [83] TH.data_1.1-2             ROCR_1.0-11              \n [85] nlme_3.1-166              pbkrtest_0.5.3           \n [87] EnvStats_2.8.1            progress_1.2.3           \n [89] RcppAnnoy_0.0.22          TMB_1.9.15               \n [91] irlba_2.3.5.1             vipor_0.4.7              \n [93] KernSmooth_2.23-24        colorspace_2.1-1         \n [95] nnet_7.3-19               DESeq2_1.42.1            \n [97] tidyselect_1.2.1          emmeans_1.10.5           \n [99] compiler_4.3.2            BiocNeighbors_1.20.2     \n[101] DelayedArray_0.28.0       plotly_4.10.4            \n[103] caTools_1.18.3            scales_1.3.0             \n[105] remaCor_0.0.18            lmtest_0.9-40            \n[107] digest_0.6.37             goftest_1.2-3            \n[109] spatstat.utils_3.1-1      minqa_1.2.8              \n[111] variancePartition_1.30.2  rmarkdown_2.29           \n[113] aod_1.3.3                 RhpcBLASctl_0.23-42      \n[115] XVector_0.42.0            htmltools_0.5.8.1        \n[117] pkgconfig_2.0.3           lme4_1.1-35.5            \n[119] sparseMatrixStats_1.14.0  highr_0.11               \n[121] fastmap_1.2.0             rlang_1.1.4              \n[123] GlobalOptions_0.1.2       htmlwidgets_1.6.4        \n[125] shiny_1.9.1               DelayedMatrixStats_1.24.0\n[127] farver_2.1.2              zoo_1.8-12               \n[129] jsonlite_1.8.9            BiocParallel_1.36.0      \n[131] R.oo_1.27.0               BiocSingular_1.18.0      \n[133] RCurl_1.98-1.16           magrittr_2.0.3           \n[135] modeltools_0.2-23         GenomeInfoDbData_1.2.11  \n[137] dotCall64_1.2             munsell_0.5.1            \n[139] viridis_0.6.5             babelgene_22.9           \n[141] reticulate_1.35.0         stringi_1.8.4            \n[143] zlibbioc_1.48.2           MASS_7.3-60.0.1          \n[145] flexmix_2.3-19            plyr_1.8.9               \n[147] parallel_4.3.2            listenv_0.9.1            \n[149] ggrepel_0.9.6             deldir_2.0-4             \n[151] splines_4.3.2             tensor_1.5               \n[153] hms_1.1.3                 locfit_1.5-9.10          \n[155] igraph_2.1.1              spatstat.geom_3.2-8      \n[157] RcppHNSW_0.6.0            ScaledMatrix_1.10.0      \n[159] reshape2_1.4.4            evaluate_1.0.1           \n[161] BiocManager_1.30.25       tweenr_2.0.3             \n[163] nloptr_2.0.3              tzdb_0.4.0               \n[165] foreach_1.5.2             httpuv_1.6.15            \n[167] RANN_2.6.2                polyclip_1.10-7          \n[169] future_1.34.0             clue_0.3-66              \n[171] scattermore_1.2           rsvd_1.0.5               \n[173] broom_1.0.7               xtable_1.8-4             \n[175] RSpectra_0.16-2           later_1.3.2              \n[177] viridisLite_0.4.2         lmerTest_3.1-3           \n[179] glmmTMB_1.1.10            beeswarm_0.4.0           \n[181] cluster_2.1.6             timechange_0.3.0         \n[183] globals_0.16.3",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Skin: Deep phenotyping, cluster annotation, and exploration of Post vs Pre 3rd vaccination differences in cell proportions and expression</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html",
    "href": "Skin_scRNA_Part11.html",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "",
    "text": "11.1 Set up Seurat workspace\n# Load libraries\nlibrary(Seurat)\nlibrary(tidyverse)\nlibrary(msigdbr)\nlibrary(fgsea)\nlibrary(GSEAtraining)       # This is used because KEGG_MEDICUS isn't yet available in msigdbr",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#read-in-pseudobulk-de-test-results",
    "href": "Skin_scRNA_Part11.html#read-in-pseudobulk-de-test-results",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.2 Read in pseudobulk DE test results",
    "text": "11.2 Read in pseudobulk DE test results\n\nskin_de &lt;- read_tsv(\"Skin_scRNA_PostVsPre3rd_DiffExp_results.tsv\")\n\nRows: 132800 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (4): sub.cluster, gene, cluster_id, contrast\ndbl (7): baseMean, logFC, lfcSE, stat, p_val, p_adj.loc, p_adj.glb\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nskin_de\n\n# A tibble: 132,800 × 11\n   sub.cluster gene   cluster_id baseMean   logFC lfcSE   stat   p_val p_adj.loc\n   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;\n 1 0           7SK    0             173.  -2.08   0.469 -4.44  9.09e-6  0.000167\n 2 0           A2M    0              85.6 -3.10   1.07  -2.89  3.85e-3  0.0218  \n 3 0           AAAS   0              10.7 -0.488  0.398 -1.23  2.20e-1  0.400   \n 4 0           AAGAB  0              22.4  0.127  0.280  0.454 6.50e-1  0.793   \n 5 0           AAK1   0             111.  -0.138  0.165 -0.834 4.04e-1  0.590   \n 6 0           AAMDC  0              23.4  0.316  0.290  1.09  2.76e-1  0.464   \n 7 0           AAMP   0              52.4  0.0876 0.218  0.401 6.88e-1  0.817   \n 8 0           AAR2   0              10.2 -0.100  0.428 -0.234 8.15e-1  0.899   \n 9 0           AARS1  0              12.7 -0.248  0.313 -0.792 4.28e-1  0.612   \n10 0           AASDH… 0              15.3  0.520  0.307  1.70  8.97e-2  0.220   \n# ℹ 132,790 more rows\n# ℹ 2 more variables: p_adj.glb &lt;dbl&gt;, contrast &lt;chr&gt;",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#set-cluster-annotations",
    "href": "Skin_scRNA_Part11.html#set-cluster-annotations",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.3 Set cluster annotations",
    "text": "11.3 Set cluster annotations\n\ncluster_annot &lt;- c(\n        \"0\" = \"MonoMac_1\",\n        \"1_0\" = \"CD4_T_Naive/CM\",\n        \"1_1\" = \"CD4_T_CTL\",\n        \"2_0\" = \"CD8_T_EM_1\",\n        \"2_1\" = \"CD8_T_Naive/CM_1\",\n        \"2_2\" = \"CD8_T_EM_2\",\n        \"3\" = \"MonoMac_2\",\n        \"4_0\" = \"CD8_T_Naive/CM_2\",\n        \"4_1\" = \"CD8_T_Naive/CM_3\",\n        \"5_0\" = \"NK/T_1\",\n        \"5_1\" = \"NK/T_2\",\n        \"5_2\" = \"NK_cells\",\n        \"6_0\" = \"T_unknown_1\",\n        \"6_1\" = \"CD8_T_EM_3\",\n        \"7\" = \"cDC2\",\n        \"8\" = \"Keratinocytes\",\n        \"9_0\" = \"Treg_1\",\n        \"9_1\" = \"Treg_2\",\n        \"10\" = \"Fibroblasts\",\n        \"11_0\" = \"T_unknown_2\",\n        \"11_1\" = \"T_unknown_3\",\n        \"12\" = \"MonoMac_3\",\n        \"13_0\" = \"Proliferating_T_cells_1\",\n        \"13_1\" = \"Proliferating_T_cells_2\",\n        \"14\" = \"pDC\",\n        \"15\" = \"DC_LAMP3\",\n        \"16\" = \"Mast\",\n        \"17\" = \"Endothelial\",\n        \"18\" = \"cDC1\",\n        \"19_0\" = \"NK/T_3\",\n        \"20\" = \"Pericytes/smooth_muscle\",\n        \"21\" = \"Basal_1\",\n        \"22\" = \"MonoMac_4\",\n        \"23\" = \"B_cells\",\n        \"24\" = \"Basal_2\",\n        \"25\" = \"Macrophages\",\n        \"26\" = \"Proliferating_cDC2\"\n)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#set-cluster-orders-for-plotting",
    "href": "Skin_scRNA_Part11.html#set-cluster-orders-for-plotting",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.4 Set cluster orders for plotting",
    "text": "11.4 Set cluster orders for plotting\n\ncluster_order &lt;- c(\"0\",\"3\",\"12\",\"22\",\"25\",\"14\",\"18\",\"7\",\"26\",\"15\",\"23\",\"5_2\",\"5_0\",\"5_1\",\"19_0\",\"2_1\",\"4_0\",\"4_1\",\"2_0\",\"2_2\",\"6_1\",\"1_0\",\"1_1\",\"9_0\",\"9_1\",\"13_0\",\"13_1\",\"6_0\",\"11_0\",\"11_1\",\"16\",\"8\",\"10\",\"17\",\"20\",\"21\",\"24\")",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#split-results-by-cluster-then-extract-ranks-by-log2-fold-change-post3rd-vs-pre3rd",
    "href": "Skin_scRNA_Part11.html#split-results-by-cluster-then-extract-ranks-by-log2-fold-change-post3rd-vs-pre3rd",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.5 Split results by cluster, then extract ranks by log2 fold-change Post3rd vs Pre3rd",
    "text": "11.5 Split results by cluster, then extract ranks by log2 fold-change Post3rd vs Pre3rd\n\nskin_de_split &lt;- skin_de %&gt;%\n    group_by(sub.cluster) %&gt;%\n    group_split()\n\nskin_de_split_ranks &lt;- lapply(skin_de_split, \n                                FUN = function(x) { x %&gt;%\n                                    dplyr::select(gene,logFC) %&gt;%\n                                    dplyr::arrange(logFC) %&gt;%\n                                    deframe()\n                                    }\n                        )\nnames(skin_de_split_ranks) &lt;- paste0(\"Cluster\", \n                                sapply(skin_de_split, \n                                FUN = function(x) { x %&gt;% \n                                    pull(sub.cluster) %&gt;%\n                                    unique()\n                                    }\n                                )\n                            )",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#prepare-gene-sets-from-msigdb",
    "href": "Skin_scRNA_Part11.html#prepare-gene-sets-from-msigdb",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.6 Prepare gene sets from MSigDB",
    "text": "11.6 Prepare gene sets from MSigDB\n\nc2 &lt;- msigdbr::msigdbr(species=\"Homo sapiens\",\n        category = \"C2\")\n\nimmunesig &lt;- msigdbr::msigdbr(species=\"Homo sapiens\",\n        category = \"C7\", \n        subcategory = \"IMMUNESIGDB\")\n\nhallmark &lt;- msigdbr::msigdbr(species=\"Homo sapiens\",\n    category = \"H\")                         \n\n# Get updated KEGG MEDICUS collection from GSEAtraining package \nkm &lt;- get_msigdb(version = \"2024.1.Hs\", \n    collection = \"c2.cp.kegg_medicus\",\n    gene_id_type = \"symbols\")\n\n# Combine into named list\npathwaysToTest &lt;- bind_rows(c2, immunesig, hallmark)\n\npathwaysToTest_split &lt;- pathwaysToTest %&gt;%\n    dplyr::select(gs_name,human_gene_symbol) %&gt;%\n    group_by(gs_name) %&gt;%\n    group_split()\n\nnames(pathwaysToTest_split) &lt;- sapply(pathwaysToTest_split, \n                                        FUN = function(x) { x %&gt;% \n                                            pull(gs_name) %&gt;%\n                                            unique()\n                                            }\n                                        )\n\n\npathwaysToTest_split_list &lt;- sapply(pathwaysToTest_split, \n                                    simplify = FALSE, \n                                    USE.NAMES = TRUE, \n                                    FUN = function(x) { x %&gt;%\n                                        pull(human_gene_symbol) %&gt;%\n                                        unique()\n                                    }\n                                )\n# Add KEGG MEDICUS to the list\npathwaysToTest_split_list &lt;- c(pathwaysToTest_split_list, km)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#iterate-over-de-results-and-run-fgsea-on-each-clusters-ranked-gene-list",
    "href": "Skin_scRNA_Part11.html#iterate-over-de-results-and-run-fgsea-on-each-clusters-ranked-gene-list",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.7 Iterate over DE results and run fgsea on each cluster’s ranked gene list",
    "text": "11.7 Iterate over DE results and run fgsea on each cluster’s ranked gene list\n\nset.seed(123)\nfgseaRes &lt;- sapply(skin_de_split_ranks, \n    simplify = FALSE, \n    USE.NAMES = TRUE, \n    FUN = function(x) {\n        fgsea(pathways = pathwaysToTest_split_list, \n              stats = x,\n              minSize = 5, # Note this is the intersection of genes in the ranked list and genes in the pathway\n              maxSize = 1000,\n              nproc = 1\n              )\n        }\n    )\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |=====================================                                 |  54%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |==========================================================            |  84%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |==                                                                    |   4%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |=========                                                             |  14%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |==============================                                        |  44%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |=========                                                             |  14%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |==============================                                        |  44%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |=================================================================     |  94%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |==========================================================            |  84%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |=================================================================     |  94%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |==============================                                        |  44%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |==========================================================            |  84%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |==============================                                        |  44%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |=================================================================     |  94%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |==                                                                    |   4%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |=========                                                             |  14%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |==========================================================            |  84%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#collapse-all-results-into-one-tibble-and-filter-for-significance",
    "href": "Skin_scRNA_Part11.html#collapse-all-results-into-one-tibble-and-filter-for-significance",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.8 Collapse all results into one tibble and filter for significance",
    "text": "11.8 Collapse all results into one tibble and filter for significance\nSave the filtered output\n\nbind_rows(fgseaRes,.id = \"sub.cluster\") %&gt;%\n    as_tibble() %&gt;%\n    mutate(leadingEdgeGenes = map_chr(leadingEdge, toString)) %&gt;%\n    dplyr::select(-leadingEdge) %&gt;%\n    dplyr::filter(padj &lt; 0.05) %&gt;%\n    dplyr::arrange(sub.cluster,padj,NES) %&gt;%\n    write_tsv(\"Skin_scRNA_PostVsPre3rd_DiffExp_fgseaRes_sig.tsv\")",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#print-selection-of-top-most-significant-pathways",
    "href": "Skin_scRNA_Part11.html#print-selection-of-top-most-significant-pathways",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.9 Print selection of top-most significant pathways",
    "text": "11.9 Print selection of top-most significant pathways\n\nbind_rows(fgseaRes,.id = \"sub.cluster\") %&gt;%\n    as_tibble() %&gt;%\n    mutate(leadingEdgeGenes = map_chr(leadingEdge, toString)) %&gt;%\n    dplyr::select(-leadingEdge) %&gt;%\n    dplyr::filter(padj &lt; 0.05) %&gt;%\n    dplyr::arrange(sub.cluster,padj,-NES) %&gt;%\n    group_by(sub.cluster) %&gt;%\n    slice_head(n = 10) %&gt;%\n    pull(pathway) %&gt;%\n    unique()\n\n [1] \"GSE42724_NAIVE_BCELL_VS_PLASMABLAST_UP\"                                       \n [2] \"GSE13484_UNSTIM_VS_YF17D_VACCINE_STIM_PBMC_DN\"                                \n [3] \"GSE13485_DAY3_VS_DAY7_YF17D_VACCINE_PBMC_DN\"                                  \n [4] \"GSE18791_UNSTIM_VS_NEWCATSLE_VIRUS_DC_6H_DN\"                                  \n [5] \"GSE13485_CTRL_VS_DAY7_YF17D_VACCINE_PBMC_DN\"                                  \n [6] \"GSE18791_CTRL_VS_NEWCASTLE_VIRUS_DC_8H_DN\"                                    \n [7] \"GSE37533_PPARG1_FOXP3_VS_FOXP3_TRANSDUCED_CD4_TCELL_DN\"                       \n [8] \"GSE13485_DAY1_VS_DAY7_YF17D_VACCINE_PBMC_DN\"                                  \n [9] \"GSE42021_TREG_VS_TCONV_PLN_UP\"                                                \n[10] \"GSE2770_TGFB_AND_IL4_ACT_VS_ACT_CD4_TCELL_2H_DN\"                              \n[11] \"GSE37533_PPARG2_FOXP3_VS_FOXP3_TRANSDUCED_CD4_TCELL_DN\"                       \n[12] \"HALLMARK_INTERFERON_GAMMA_RESPONSE\"                                           \n[13] \"GSE21546_WT_VS_SAP1A_KO_DP_THYMOCYTES_UP\"                                     \n[14] \"GSE42021_CD24HI_VS_CD24INT_TREG_THYMUS_DN\"                                    \n[15] \"BLANCO_MELO_BRONCHIAL_EPITHELIAL_CELLS_INFLUENZA_A_DEL_NS1_INFECTION_UP\"      \n[16] \"GSE13485_CTRL_VS_DAY3_YF17D_VACCINE_PBMC_DN\"                                  \n[17] \"GSE21927_SPLEEN_C57BL6_VS_4T1_TUMOR_BALBC_MONOCYTES_DN\"                       \n[18] \"GSE13485_PRE_VS_POST_YF17D_VACCINATION_PBMC_DN\"                               \n[19] \"GSE42021_TREG_PLN_VS_CD24LO_TREG_THYMUS_DN\"                                   \n[20] \"GSE42021_TREG_PLN_VS_TREG_PRECURSORS_THYMUS_DN\"                               \n[21] \"HALLMARK_INTERFERON_ALPHA_RESPONSE\"                                           \n[22] \"REACTOME_EUKARYOTIC_TRANSLATION_ELONGATION\"                                   \n[23] \"KEGG_MEDICUS_REFERENCE_TRANSLATION_INITIATION\"                                \n[24] \"BILANGES_SERUM_AND_RAPAMYCIN_SENSITIVE_GENES\"                                 \n[25] \"REACTOME_EUKARYOTIC_TRANSLATION_INITIATION\"                                   \n[26] \"KEGG_RIBOSOME\"                                                                \n[27] \"REACTOME_INTERFERON_SIGNALING\"                                                \n[28] \"GSE42021_TREG_PLN_VS_CD24INT_TREG_THYMUS_DN\"                                  \n[29] \"GSE21546_ELK1_KO_VS_SAP1A_KO_AND_ELK1_KO_DP_THYMOCYTES_UP\"                    \n[30] \"GSE6269_FLU_VS_STREP_PNEUMO_INF_PBMC_UP\"                                      \n[31] \"BLANCO_MELO_HUMAN_PARAINFLUENZA_VIRUS_3_INFECTION_A594_CELLS_UP\"              \n[32] \"GSE1432_CTRL_VS_IFNG_24H_MICROGLIA_DN\"                                        \n[33] \"GSE19888_ADENOSINE_A3R_INH_VS_ACT_WITH_INHIBITOR_PRETREATMENT_IN_MAST_CELL_UP\"\n[34] \"GSE18791_CTRL_VS_NEWCASTLE_VIRUS_DC_4H_DN\"                                    \n[35] \"REACTOME_TRANSLATION\"                                                         \n[36] \"WP_CYTOPLASMIC_RIBOSOMAL_PROTEINS\"                                            \n[37] \"REACTOME_SELENOAMINO_ACID_METABOLISM\"                                         \n[38] \"REACTOME_SRP_DEPENDENT_COTRANSLATIONAL_PROTEIN_TARGETING_TO_MEMBRANE\"         \n[39] \"REACTOME_RESPONSE_OF_EIF2AK4_GCN2_TO_AMINO_ACID_DEFICIENCY\"                   \n[40] \"REACTOME_RRNA_PROCESSING\"                                                     \n[41] \"REACTOME_NONSENSE_MEDIATED_DECAY_NMD\"                                         \n[42] \"BLANCO_MELO_COVID19_SARS_COV_2_INFECTION_CALU3_CELLS_UP\"",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#print-selection-of-recurring-top-most-significant-pathways-in-multiple-clusters",
    "href": "Skin_scRNA_Part11.html#print-selection-of-recurring-top-most-significant-pathways-in-multiple-clusters",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.10 Print selection of recurring top-most significant pathways in multiple clusters",
    "text": "11.10 Print selection of recurring top-most significant pathways in multiple clusters\nRestrict to HALLMARK, KEGG, WP, or REACTOME pathways seen in the top 100 most significant results in at least 2 clusters\n\nrecurring_topSigPathways &lt;- bind_rows(fgseaRes,.id = \"sub.cluster\") %&gt;%\n    as_tibble() %&gt;%\n    mutate(leadingEdgeGenes = map_chr(leadingEdge, toString)) %&gt;%\n    dplyr::select(-leadingEdge) %&gt;%\n    dplyr::filter(padj &lt; 0.05 & NES &gt; 0) %&gt;%\n    dplyr::arrange(sub.cluster,padj) %&gt;%\n    group_by(sub.cluster) %&gt;%\n    slice_head(n = 100) %&gt;%\n    dplyr::select(sub.cluster,pathway,padj,NES) %&gt;%\n    group_by(pathway) %&gt;%\n    summarize(n = n()) %&gt;%\n    dplyr::filter(n&gt;=2) %&gt;%\n    dplyr::filter(str_detect(pathway,\"HALLMARK|WP|KEGG|REACTOME\")) %&gt;% \n    pull(pathway) %&gt;%\n    unique()\n\nrecurring_topSigPathways\n\n[1] \"HALLMARK_INTERFERON_ALPHA_RESPONSE\"          \n[2] \"HALLMARK_INTERFERON_GAMMA_RESPONSE\"          \n[3] \"REACTOME_CYTOKINE_SIGNALING_IN_IMMUNE_SYSTEM\"\n[4] \"REACTOME_INTERFERON_ALPHA_BETA_SIGNALING\"    \n[5] \"REACTOME_INTERFERON_SIGNALING\"               \n\nnames(recurring_topSigPathways) &lt;- rep(\"Other recurring significant\",length(recurring_topSigPathways))",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#filter-to-specific-pathways-related-to-innate-immunity-of-interest",
    "href": "Skin_scRNA_Part11.html#filter-to-specific-pathways-related-to-innate-immunity-of-interest",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.11 Filter to specific pathways related to innate immunity of interest",
    "text": "11.11 Filter to specific pathways related to innate immunity of interest\n\ntopsigPathways &lt;- c(\"Innate stimulation\" = \"KEGG_TOLL_LIKE_RECEPTOR_SIGNALING_PATHWAY\",\n                            \"Interferon signaling\" = \"REACTOME_INTERFERON_SIGNALING\",\n                            \"Interferon signaling\" = \"REACTOME_INTERFERON_ALPHA_BETA_SIGNALING\",\n                            \"Interferon signaling\" = \"HALLMARK_INTERFERON_ALPHA_RESPONSE\",\n                            \"Interferon signaling\" = \"HALLMARK_INTERFERON_GAMMA_RESPONSE\",\n                            \"Cytokine signaling\" = \"REACTOME_CYTOKINE_SIGNALING_IN_IMMUNE_SYSTEM\",\n                            \"Cytokine signaling\" = \"REACTOME_SIGNALING_BY_INTERLEUKINS\",\n                            \"Cytokine signaling\" = \"REACTOME_INTERLEUKIN_1_FAMILY_SIGNALING\",\n                            \"Cytokine signaling\" = \"REACTOME_INTERLEUKIN_2_FAMILY_SIGNALING\",\n                            \"Cytokine signaling\" = \"HALLMARK_IL2_STAT5_SIGNALING\",\n                            \"Cytokine signaling\" = \"HALLMARK_IL6_JAK_STAT3_SIGNALING\",\n                            \"Cytokine signaling\" = \"HALLMARK_TNFA_SIGNALING_VIA_NFKB\",\n                            \"Antigen processing\" = \"REACTOME_ANTIGEN_PROCESSING_CROSS_PRESENTATION\",\n                            \"Antigen processing\" = \"REACTOME_ANTIGEN_PROCESSING_UBIQUITINATION_PROTEASOME_DEGRADATION\"\n                )\n\n# Combine with top significant and remove redundant pathways\ntopsigPathways &lt;- c(topsigPathways,recurring_topSigPathways[!recurring_topSigPathways %in% topsigPathways])\n    \ngs_pathways &lt;- pathwaysToTest_split_list[topsigPathways]",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#plot-dot-plot-of-nes-and-p-value-for-pathways-of-interest",
    "href": "Skin_scRNA_Part11.html#plot-dot-plot-of-nes-and-p-value-for-pathways-of-interest",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.12 Plot dot plot of NES and p-value for pathways of interest",
    "text": "11.12 Plot dot plot of NES and p-value for pathways of interest\n\nbind_rows(fgseaRes,.id = \"sub.cluster\") %&gt;%\n    as_tibble() %&gt;%\n    mutate(leadingEdgeGenes = map_chr(leadingEdge, toString)) %&gt;%\n    dplyr::select(-leadingEdge) %&gt;%\n    dplyr::filter(pathway %in% topsigPathways) %&gt;%\n    left_join(enframe(topsigPathways,name = \"PathwayGroup\",value = \"pathway\"),by=\"pathway\") %&gt;%\n    left_join(enframe(cluster_annot,name = \"sub.cluster\", value = \"Cluster\") %&gt;% \n                mutate(sub.cluster = paste0(\"Cluster\",sub.cluster)), \n              by = \"sub.cluster\") %&gt;%\n    mutate(logP = ifelse(padj &lt; 0.05, -log10(padj), 0)) %&gt;%\n    ggplot(aes(x = fct_relevel(Cluster,cluster_annot[cluster_order][cluster_annot[cluster_order] %in% Cluster]), y = pathway)) +\n    geom_point(aes(color = NES, size = logP, alpha = I(ifelse(logP &lt; -log10(0.05), 0, 1)))) +\n    scale_size_continuous(\"-log10 adj p\", range = c(1, 10), breaks = c(1.3, 5, 10, 20, 30)) +\n    scale_color_gradient2(low = \"blue\", mid = \"white\", high = \"red\", limits=c(-3,3), midpoint = 0, oob = scales::squish) +\n    theme_bw() +\n    facet_grid(fct_relevel(PathwayGroup,\n                            c(\"Innate stimulation\",\n                              \"Interferon signaling\",\n                              \"Cytokine signaling\",\n                              \"Antigen processing\",\n                              \"Other recurring significant\")\n                           )~.,\n               scales=\"free\",\n               switch=\"y\",\n               space=\"free\") +\n    scale_y_discrete(position = \"right\") +\n    ylab(\"\") +\n    xlab(\"\") +\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          strip.text.y.left = element_text(angle = 0))\n\nWarning: 1 unknown level in `f`: Other recurring significant\n1 unknown level in `f`: Other recurring significant\n1 unknown level in `f`: Other recurring significant",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  },
  {
    "objectID": "Skin_scRNA_Part11.html#get-session-info",
    "href": "Skin_scRNA_Part11.html#get-session-info",
    "title": "11  Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea",
    "section": "11.13 Get session info",
    "text": "11.13 Get session info\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Rocky Linux 8.10 (Green Obsidian)\n\nMatrix products: default\nBLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.15.so;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/New_York\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] GSEAtraining_0.99.1 fgsea_1.28.0        msigdbr_7.5.1      \n [4] lubridate_1.9.3     forcats_1.0.0       stringr_1.5.1      \n [7] dplyr_1.1.4         purrr_1.0.2         readr_2.1.5        \n[10] tidyr_1.3.1         tibble_3.2.1        ggplot2_3.5.1      \n[13] tidyverse_2.0.0     Seurat_5.1.0        SeuratObject_5.0.2 \n[16] sp_2.1-4           \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3      jsonlite_1.8.9          magrittr_2.0.3         \n  [4] spatstat.utils_3.1-1    farver_2.1.2            rmarkdown_2.29         \n  [7] zlibbioc_1.48.2         vctrs_0.6.5             ROCR_1.0-11            \n [10] memoise_2.0.1           spatstat.explore_3.2-6  RCurl_1.98-1.16        \n [13] htmltools_0.5.8.1       sctransform_0.4.1       parallelly_1.39.0      \n [16] KernSmooth_2.23-24      htmlwidgets_1.6.4       ica_1.0-3              \n [19] plyr_1.8.9              cachem_1.1.0            plotly_4.10.4          \n [22] zoo_1.8-12              igraph_2.1.1            mime_0.12              \n [25] lifecycle_1.0.4         pkgconfig_2.0.3         Matrix_1.6-4           \n [28] R6_2.5.1                fastmap_1.2.0           GenomeInfoDbData_1.2.11\n [31] fitdistrplus_1.2-1      future_1.34.0           shiny_1.9.1            \n [34] digest_0.6.37           colorspace_2.1-1        S4Vectors_0.40.2       \n [37] AnnotationDbi_1.64.1    patchwork_1.3.0         tensor_1.5             \n [40] RSpectra_0.16-2         irlba_2.3.5.1           RSQLite_2.3.8          \n [43] labeling_0.4.3          progressr_0.15.1        fansi_1.0.6            \n [46] spatstat.sparse_3.1-0   timechange_0.3.0        httr_1.4.7             \n [49] polyclip_1.10-7         abind_1.4-8             compiler_4.3.2         \n [52] bit64_4.5.2             withr_3.0.2             BiocParallel_1.36.0    \n [55] DBI_1.2.3               fastDummies_1.7.3       MASS_7.3-60.0.1        \n [58] tools_4.3.2             lmtest_0.9-40           httpuv_1.6.15          \n [61] future.apply_1.11.3     goftest_1.2-3           glue_1.8.0             \n [64] nlme_3.1-166            promises_1.3.0          grid_4.3.2             \n [67] Rtsne_0.17              cluster_2.1.6           reshape2_1.4.4         \n [70] generics_0.1.3          gtable_0.3.6            spatstat.data_3.1-4    \n [73] tzdb_0.4.0              data.table_1.16.2       hms_1.1.3              \n [76] XVector_0.42.0          utf8_1.2.4              BiocGenerics_0.48.1    \n [79] spatstat.geom_3.2-8     RcppAnnoy_0.0.22        ggrepel_0.9.6          \n [82] RANN_2.6.2              pillar_1.9.0            vroom_1.6.5            \n [85] spam_2.11-0             babelgene_22.9          RcppHNSW_0.6.0         \n [88] later_1.3.2             splines_4.3.2           lattice_0.22-6         \n [91] bit_4.5.0               survival_3.7-0          deldir_2.0-4           \n [94] tidyselect_1.2.1        Biostrings_2.70.3       miniUI_0.1.1.1         \n [97] pbapply_1.7-2           knitr_1.45              gridExtra_2.3          \n[100] IRanges_2.36.0          scattermore_1.2         stats4_4.3.2           \n[103] xfun_0.49               Biobase_2.62.0          matrixStats_1.4.1      \n[106] DT_0.33                 stringi_1.8.4           lazyeval_0.2.2         \n[109] yaml_2.3.10             evaluate_1.0.1          codetools_0.2-20       \n[112] cli_3.6.3               uwot_0.2.2              xtable_1.8-4           \n[115] reticulate_1.35.0       munsell_0.5.1           GenomeInfoDb_1.38.8    \n[118] Rcpp_1.0.13-1           globals_0.16.3          spatstat.random_3.2-2  \n[121] png_0.1-8               parallel_4.3.2          blob_1.2.4             \n[124] dotCall64_1.2           bitops_1.0-9            listenv_0.9.1          \n[127] viridisLite_0.4.2       scales_1.3.0            ggridges_0.5.6         \n[130] crayon_1.5.3            leiden_0.4.3.1          rlang_1.1.4            \n[133] KEGGREST_1.42.0         cowplot_1.1.3           fastmatch_1.1-4",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Skin: Calculating Post vs Pre 3rd vaccination differences in pathway enrichments with fgsea</span>"
    ]
  }
]